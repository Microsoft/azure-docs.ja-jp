---
title: 顧客離れを分析する
titleSuffix: ML Studio (classic) - Azure
description: Azure Machine Learning Studio (クラシック) を使用した顧客離れの分析とスコア付けのための統合モデルを作成するケース スタディ。
services: machine-learning
ms.service: machine-learning
ms.subservice: studio
ms.topic: conceptual
author: likebupt
ms.author: keli19
ms.custom: seodec18
ms.date: 12/18/2017
ms.openlocfilehash: 79a7b157d5daf8940aba454808c65ed433cfe29c
ms.sourcegitcommit: bdf31d87bddd04382effbc36e0c465235d7a2947
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/12/2020
ms.locfileid: "77169009"
---
# <a name="analyze-customer-churn-using-azure-machine-learning-studio-classic"></a>Azure Machine Learning Studio を使用して顧客離れを分析する (クラシック)
## <a name="overview"></a>概要
この記事では、Azure Machine Learning Studio (クラシック) を使用して構築された顧客離れ分析プロジェクトのリファレンス実装を紹介します。 また、産業界の顧客離れの問題を総合的に解決するための関連の汎用モデルについて説明します。 さらに、Machine Learning を使用して構築されたモデルの正確度を測定し、モデルの開発を進めるために方向性を評価します。  

### <a name="acknowledgements"></a>謝辞
この実験は、Serge Berger (Microsoft 主任データ サイエンティスト)、Roger Barga (Microsoft Azure Machine Learning Studio (クラシック) の前プロダクト マネージャー) によって開発およびテストされました。 Azure ドキュメント チームは、このホワイト ペーパーに情報と知識をご提供いただいたこの 2 人に感謝いたします。

> [!NOTE]
> この実験のデータは公開されていません。 顧客離れ分析の機械学習モデルを構築する方法の例については、「[Azure AI Gallery](https://gallery.azure.ai/)」(Azure AI ギャラリー) の「[Retail churn model template](https://gallery.azure.ai/Collection/Retail-Customer-Churn-Prediction-Template-1)」(小売業の顧客離れモデルのテンプレート) を参照してください
> 
> 



## <a name="the-problem-of-customer-churn"></a>顧客離れの問題
コンシューマー市場とあらゆるエンタープライズ セクターの企業は、顧客離れの問題に対処する必要があります。 この問題がきわめて重くのしかかり、ポリシーの決定に影響を及ぼすこともあります。 従来は、これを防ぐために、離反の可能性が高い顧客を予測し、コンセルジュ サービスやマーケティング キャンペーン、優待によってそのニーズを満たすという方法がとられてきました。 こうしたアプローチは、業界によって異なることがあります。 さらには、(電気通信など) 同じ業界内のコンシューマー クラスターによっても異なることがあります。

それでも共通するのは、企業は、顧客維持のための特別な労力をできるだけ小さくする必要があるという点です。 そこで、すべての顧客の離反の可能性を点数化し、その上位の顧客に対応するという方法が採用されることになります。 上位の顧客は最も収益性の高い顧客の可能性があります。 さらに高度なシナリオでは、優待の候補者を選ぶ際に利潤関数が使用されます。 ただし、こうした考慮事項は、顧客離れに対処するための全体的な戦略の一部に過ぎません。 各企業は、リスク (および関連するリスク許容度)、介入のレベルとコスト、妥当な顧客セグメンテーションも考慮する必要があります。  

## <a name="industry-outlook-and-approaches"></a>業界の展望とアプローチ
離反への高度な対処は、業界の成熟の表れです。 その典型例として、電気通信業界が挙げられます。この業界では、利用者は頻繁にプロバイダーを乗り換えることが知られています。 この自発的な離反は、最も大きな懸念事項となっています。 さらに、プロバイダーは "*離反の要因*" に関する知識を大量に蓄積してきました。離反の要因とは、顧客が乗り換えを決める要因のことです。

たとえば、携帯電話ビジネスにおいては、ハンドセットやデバイスの選択が離反の要因としてよく知られており、 新規契約者にはハンドセットの料金を補助し、既存の顧客にはアップグレードの際に全額を請求するという方針が一般的になっています。 歴史的に見ると、この方針が原因で、顧客が新たなディスカウントを求めてプロバイダーを乗り換え、 それを受けてプロバイダーが戦略を見直すという流れになっています。

ハンドセット製品における流動性の高さは、現在のハンドセット モデルに基づく離反モデルが短期間で役に立たなくなる要因となっています。 さらに、携帯電話は単なる通信機器ではなく、ファッションを表すものでもあります (iPhone など)。 このような社会的な予測因子は、通常の電気通信データ セットに含まれません。

モデリングから最終的にわかるのは、既知の離反要因を取り除くだけでは適切な方針を定めることはできないということです。 実際に、カテゴリの変数を定量化する従来のモデル (たとえば、ディメンション ツリー) など、継続的なモデリング戦略は **必須**です。

企業は、顧客に関するビッグ データ セットを利用してビッグ データ分析 (特にビッグ データに基づく離反検出) を行い、問題に対する効果的なアプローチとして利用しています。 ETL のセクションの推奨事項の変化の問題について、ビッグ データの方法の詳細を検索できます。  

## <a name="methodology-to-model-customer-churn"></a>顧客離れのモデリング手法
図 1 ～ 3 は、顧客離れの問題の一般的な解決プロセスを示しています。  

1. リスク モデルでは、可能性とリスクに対するアクションの影響を検討できます。
2. 介入モデルでは、離反の可能性と顧客生涯価値 (CLV) の大きさに対する介入レベルの影響を検討できます。
3. この分析は、最適なプランを配信する顧客セグメントを対象とする事前対応型のマーケティング キャンペーンにエスカレートを質的、分析に適しています。  

![リスク許容度と決定モデルによってアクションにつながる分析情報が得られる様子を示す図](./media/azure-ml-customer-churn-scenario/churn-1.png)

この将来を考慮したアプローチは顧客離れに対処する最適な方法ではあるものの、複雑であり、マルチモデルのアーキタイプを作成し、モデル間の依存関係をトレースする必要があります。 モデル間の相互作用は、次の図のようにまとめられます。  

![顧客離れモデルの相互作用図](./media/azure-ml-customer-churn-scenario/churn-2.png)

"*図 4:統合されたマルチモデルのアーキタイプ*  

顧客維持のための包括的なアプローチを提供するなら、モデル間の相互作用が鍵となります。 各モデルの効果は時間の経過と共に必然的に低下するため、アーキテクチャは暗黙的なループになります (CRISP-DM データ マイニング標準によるアーキタイプと同様 [***3***])。  

リスク - 決定 - マーケティングというセグメンテーション/分解の全体的なサイクルは、多くのビジネス上の問題に適用できる一般化された構造です。 離反分析はこの問題グループを的確に表したものにすぎません。単純な予測ソリューションが役に立たない複雑なビジネス上の問題の特徴が余すところなく表れています。 このアプローチでは、離反に対する最新のアプローチの社会的な側面はそれほど強調されていませんが、他のモデルにも見られるように、社会的な側面がモデリング アーキタイプの中に内包されています。  

ビッグ データ分析も興味深いテーマです。 今日の電気通信事業者と小売業者は、顧客に関する情報を徹底的に収集しています。モノのインターネットやユビキタス デバイスなどが流行しつつあり、企業は複数のレイヤーでスマート ソリューションを採用できるようになっているため、マルチモデルの連結が一般的になることは想像に難くありません。  

 

## <a name="implementing-the-modeling-archetype-in-machine-learning-studio-classic"></a>Machine Learning Studio (クラシック) でのモデリング アーキタイプの実装
説明した問題を踏まえると、モデリングとスコア付けの統合アプローチを実装する最適な方法は何でしょうか。 このセクションでは、Azure Machine Learning Studio (クラシック) を使用してこれを実現する方法を紹介します。  

マルチモデルのアプローチは、離反のグローバル アーキタイプを設計するうえで欠かすことができないものです。 このアプローチのスコア付け (予測) の部分さえもマルチモデルである必要があります。  

次の図は、こちらで作成したプロトタイプです。離反を予測するための Machine Learning Studio (クラシック) の 4 種類のスコア付けアルゴリズムを採用しています。 マルチモデルのアプローチを採用したのは、正確度を高めるためのアンサンブル分類子を作成するためだけではなく、過学習を防ぎ、予測特徴選択を強化するためでもあります。  

![多くの相互接続されたモジュールが含まれる複雑な Studio (クラシック) ワークスペースを示すスクリーンショット](./media/azure-ml-customer-churn-scenario/churn-3.png)

*図 5:離反モデリング アプローチのプロトタイプ*  

次のセクションでは、Machine Learning Studio (クラシック) を使用して実装したプロトタイプのスコア付けモデルについて詳しく説明します。  

### <a name="data-selection-and-preparation"></a>データの選択と準備
モデルを構築し、顧客のスコアを計算するために使用したデータは、CRM バーティカル ソリューションから取得しました。顧客のプライバシーを保護するために、データは難読化されています。 データ自体には米国における 8,000 件のサブスクリプションに関する情報が含まれ、プロビジョニング データ (サブスクリプション メタデータ)、アクティビティ データ (システムの使用量)、カスタマー サポート データの 3 つのソースが組み合わされています。 データには、顧客に関するビジネス関連情報は一切含まれていません。たとえば、ロイヤルティ メタデータやクレジット スコアは含まれていません。  

説明を簡略化するために、データの準備は他の場所で既に行われているものとし、ETL とデータ クレンジング プロセスについては取り上げません。

モデリング機能の選択は、暫定的な有意性を予測子をランダムなフォレストのモジュールを使用するプロセスに含まれる一連のスコアに基づきます。 Machine Learning Studio (クラシック) での実装では、典型的な特徴に対して平均、中央値、範囲を計算しました。 たとえば、ユーザー アクティビティの最小値と最大値など、定性的データの集計を追加しました。

また、ここ 6 か月間の時間的情報も収集しました。 1 年間のデータを分析した結果、統計的に有意なトレンドが存在したとしても、離反に対する影響は、6 か月経過した後では大幅に小さくなることがわかりました。  

最も重要なのは、ETL、特徴選択、モデリングを含めたプロセス全体が、Microsoft Azure のデータ ソースを使用して Machine Learning Studio (クラシック) で実装されたという点です。   

次の図に、使用したデータを示します。  

![生の値で使用されるデータのサンプルを示すスクリーンショット](./media/azure-ml-customer-churn-scenario/churn-4.png)

*図 6:データ ソースの一部 (難読化済み)*  

![データ ソースから抽出された統計的特徴を示すスクリーンショット](./media/azure-ml-customer-churn-scenario/churn-5.png)

*図 7:データ ソースから抽出された特徴*
 

> これはプライベート データであるため、モデルとデータを共有することはできません。
> ただし、パブリックに使用可能なデータを使用する同様のモデルについては、「[Azure AI Gallery](https://gallery.azure.ai/)」(Azure AI ギャラリー) の「[Telco Customer Churn](https://gallery.azure.ai/Experiment/31c19425ee874f628c847f7e2d93e383)」(Telco の顧客離れ) にあるサンプル実験を参照してください。
> 
> Cortana Intelligence Suite を使用して顧客離れ分析モデルを実装する方法の詳細については、上級プログラム マネージャーの Wee Hyong Tok による [こちらのビデオ](https://info.microsoft.com/Webinar-Harness-Predictive-Customer-Churn-Model.html) をご覧になることをお勧めします。 
> 
> 

### <a name="algorithms-used-in-the-prototype"></a>プロトタイプで使用されたアルゴリズム
次の 4 つの機械学習アルゴリズムを使ってプロトタイプを作成しました (カスタマイズはしていません)。  

1. ロジスティック回帰 (LR)
2. ブースト デシジョン ツリー (BT)
3. 平均化パーセプトロン (AP)
4. サポート ベクター マシン (SVM)  

次の図に、実験のデザイン サーフェイスの一部を示します。これは、モデルが作成されたシーケンスを示しています。  

![Studio 実験キャンバスの小さなセクションのスクリーンショット](./media/azure-ml-customer-churn-scenario/churn-6.png)  

*図 8:Machine Learning Studio (クラシック) でモデルを作成する*  

### <a name="scoring-methods"></a>スコア付けの手法
ラベル付けされたトレーニング データセットを使用して、4 つのモデルのスコアを計算しました。  

SAS Enterprise Miner 12 のデスクトップのエディションを使用して構築された同等のモデルには、スコアのデータセットを提出しました。 SAS モデルと 4 つのすべての Machine Learning Studio (クラシック) モデルの精度を測定しました。  

## <a name="results"></a>[結果]
このセクションでは、スコア付けデータセットに基づいて、モデルの正確度に関してわかったことを紹介します。  

### <a name="accuracy-and-precision-of-scoring"></a>スコア付けの正確度と精度
一般に、Azure Machine Learning Studio (クラシック) での実装は、正確度の点で SAS よりも約 10-15% 劣っていました (AUC)。  

ただし、離反で最も重要なメトリックは、誤分類率です。つまり、分類子によって予測された上位の離反者のうち、実際には**離反しておらず**、特別な扱いを受けている人々です。 次の図では、すべてのモデルでこの誤分類を比較しています。  

![4 つのアルゴリズムのパフォーマンスを比較する曲線グラフの下の領域](./media/azure-ml-customer-churn-scenario/churn-7.png)

*図 9:Passau プロトタイプの曲線下面積*

### <a name="using-auc-to-compare-results"></a>AUC を使用した結果の比較
曲線下面積 (AUC) は、正と負の母集団のスコア分布の *可分性* の大域尺度を表すメトリックです。 従来の Receiver Operator Characteristic (ROC) グラフと似ているものの、AUC メトリックではしきい値を選択する必要がないという重要な違いがあります。 AUC では、可能性のある **すべての** 選択肢を対象にした結果がまとめられます。 それとは対照的に、従来の ROC グラフでは縦軸に陽性率、横軸に偽陽性率が示され、分類のしきい値は変動します。   

AUC は、異なるアルゴリズム (または異なるシステム) の価値の尺度として使用されます。AUC 値を使ってモデルを比較できるためです。 これは、気象学や生物科学、その他多数の産業でよく使われる手法です。 このため、AUC は分類子のパフォーマンスを評価するための一般的なツールとなっています。  

### <a name="comparing-misclassification-rates"></a>誤分類率の比較
およそ 8,000 件のサブスクリプションが含まれる CRM データを使用して、問題のデータセットの誤分類率を比較しました。  

* SAS の誤分類率は 10 ～ 15% でした。
* Machine Learning Studio (クラシック) の誤分類率は、上位 200 から 300 名の離反者については 15 から 20% でした。  

電気通信業界では、離反のリスクが最も高い顧客のみにコンセルジュ サービスや優待を提供して対処することが重要です。 その点で、Machine Learning Studio (クラシック) を使用した実装は、SAS モデルに匹敵する結果を出しています。  

同様に、正確度は精度よりもさらに重要です。離反の可能性のある顧客を正しく分類することが最大の目的であるためです。  

Wikipedia から引用した次の図には、わかりやすいグラフィックを利用して関係が示されています。  

![2 つのターゲット。 一方のターゲットは、当たった点の間は離れているが中心に近い、"低正確度: 良い真度、悪い精度"。 他方のターゲットは、当たった点の間は近いが中心から離れている、"低正確度: 悪い真度、良い精度"](./media/azure-ml-customer-churn-scenario/churn-8.png)

*図 10:正確度と精度のトレードオフ*

### <a name="accuracy-and-precision-results-for-boosted-decision-tree-model"></a>ブースト ツリー モデルの正確度と精度の結果
次の図には、Machine Learning プロトタイプを使用した、ブースト デシジョン ツリー モデルのスコア付けの結果がそのまま示されています。4 つのモデルの中で、このモデルの正確度が最も高くなっています。  

![4 つのアルゴリズムの正確度、精度、再現率、F スコア、AUC、平均ログ損失、およびトレーニング ログ損失を示すテーブル スニペット](./media/azure-ml-customer-churn-scenario/churn-9.png)

*図 11:ブースト デシジョン ツリー モデルの特性*

## <a name="performance-comparison"></a>パフォーマンスの比較
Machine Learning Studio (クラシック) モデルと、SAS Enterprise Miner 12.1 のデスクトップ エディションを使用して作成した同等のモデルを使用して、データのスコア付けの速度を比較しました。  

次の表に、各アルゴリズムのパフォーマンスをまとめます。  

*表 1.各アルゴリズムの一般的なパフォーマンス (正確度)*

| LR | BT | AP | SVM |
| --- | --- | --- | --- |
| 平均的なモデル |最高のモデル |平均未満 |平均的なモデル |

Machine Learning Studio (クラシック) でホストされたモデルは、実行速度の点で SAS を 15 から 25% 上回っていたものの、正確度にほとんど違いはありませんでした。  

## <a name="discussion-and-recommendations"></a>考察と推奨事項
電気通信業界では、離反の分析用に、いくつかのプラクティスが登場しています。  

* 4 つの基本的なカテゴリに対応したメトリックを探してください。
  * **エンティティ (サブスクリプションなど)** 。 離反の主体であるサブスクリプションまたは顧客に関する基本的な情報を準備します。
  * **アクティビティ**。 たとえば、ログインの数など、エンティティに関連するすべての可能な使用状況情報を取得します。
  * **カスタマー サポート**。 サブスクリプションに問題やカスタマー サポートとのやり取りがあったかどうかを示す情報をカスタマー サポート ログから収集します。
  * **競合に関するデータとビジネス データ**。 顧客に関して入手可能な情報をすべて入手します (入手できない場合や、トラッキングできない場合もあります)。
* 重要度を特徴選択に利用します。 これは、ブースト デシジョン ツリー モデルが常に有効なアプローチとなることを意味します。  

この 4 つのカテゴリを利用すると、カテゴリごとの合理的なファクターによるインデックスに基づいた、単純かつ "*決定論的*" なアプローチにより、離反のリスクがある顧客を十分特定できるという楽観的な誤解が生じます。 これはもっともらしく思えるものの、残念なことに間違った理解です。 というのも、離反というものは一時的な現象であり、離反に影響するファクターは一般に不変ではないためです。 今顧客が離反を検討している理由は、明日には変わる可能性があります。そして 6 か月もすれば確実に変わっています。 だからこそ "*確率論的*" モデルが不可欠なのです。  

この重要な考えは実務では見逃されがちで、一般には BI 指向の分析アプローチが好まれています。その方が販売しやすく、単純な自動化が可能であるというのが、その主な理由です。  

しかしながら、Machine Learning Studio (クラシック) を使用したセルフサービス分析なら、部門または部署別に分けられた情報の 4 つのカテゴリが離反に関する機械学習の貴重なソースとなるという見込みがあります。  

Azure Machine Learning Studio (クラシック) にはほかにも便利な機能があり、元から利用できる事前定義済みモジュールのリポジトリにカスタム モジュールを追加できます。 この機能を利用すれば、ライブラリを選択し、垂直市場向けのテンプレートを作成できます。 これは、市場で Azure Machine Learning Studio (クラシック) を差別化している重要な機能です。  

このトピックについては、いずれ、ビッグ データ分析との絡みで説明できればと考えています。
  

## <a name="conclusion"></a>まとめ
このペーパーでは、汎用フレームワークを使用して、顧客離れという一般的な問題に対処するための効果的なアプローチを取り上げました。 スコア付けモデルのプロトタイプについて検討し、それを Azure Machine Learning Studio (クラシック) を使って実装しました。 最後に、同等の SAS のアルゴリズムと比較しつつ、プロトタイプ ソリューションの正確度とパフォーマンスを評価しました。  

 

## <a name="references"></a>References
[1] 予測分析: 予想を超える、W. McKnight、Information Management、2011 年 7 月/8 月、p18 から 20。  

[2] Wikipedia の記事: [正確性と精度](https://en.wikipedia.org/wiki/Accuracy_and_precision)

[3] [CRISP-DM 1.0:ステップ バイ ステップのデータ マイニングのガイド](https://www.the-modeling-agency.com/crisp-dm.pdf)   

[4] [ビッグ データ マーケティング:お客様に効率の向上と価値の促進を保証する](https://www.amazon.com/Big-Data-Marketing-Customers-Effectively/dp/1118733894/ref=sr_1_12?ie=UTF8&qid=1387541531&sr=8-12&keywords=customer+churn)

[5] [Azure AI ギャラリー](https://gallery.azure.ai/)の「[Telco の顧客離れ](https://gallery.azure.ai/Experiment/Telco-Customer-Churn-5)」 
 

## <a name="appendix"></a>付録
![離反プロトタイプに関するプレゼンテーションのスナップショット](./media/azure-ml-customer-churn-scenario/churn-10.png)

*図 12:離反プロトタイプに関するプレゼンテーションのスナップショット*
