---
title: IoT ソリューション アクセラレータのリファレンス アーキテクチャ - Azure | Microsoft Docs
description: Azure IoT ソリューション アクセラレータのリファレンス アーキテクチャについて説明します。 既存のソリューション アクセラレータは、このリファレンス アーキテクチャを活用しています。 独自にカスタム IoT ソリューションを構築するときにもリファレンス アーキテクチャを使用できます。
author: dominicbetts
ms.author: dobett
ms.date: 12/04/2018
ms.topic: conceptual
ms.custom: mvc
ms.service: iot-accelerators
services: iot-accelerators
manager: philmea
ms.openlocfilehash: 5fb615ff042cc5cdd3b6b8e42e4d91b161ebf445
ms.sourcegitcommit: 4eeeb520acf8b2419bcc73d8fcc81a075b81663a
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/19/2018
ms.locfileid: "53602377"
---
# <a name="introduction-to-the-azure-iot-reference-architecture"></a>Azure IoT リファレンス アーキテクチャの概要

この記事では、[Azure IoT のリファレンス アーキテクチャ](https://aka.ms/iotrefarchitecture)を紹介し、その推奨事項に従っている [Azure IoT ソリューション アクセラレータ](about-iot-accelerators.md)の例を示します。

オープン ソースの[リモート監視](iot-accelerators-remote-monitoring-sample-walkthrough.md)ソリューション アクセラレータと[接続済みファクトリ](iot-accelerators-connected-factory-sample-walkthrough.md) ソリューション アクセラレータは、リファレンス アーキテクチャの推奨事項の多くに従っています。 ソリューション アクセラレータは、独自の IoT ソリューションの開始点として、または学習ツールとして利用できます。

## <a name="overview"></a>概要

リファレンス アーキテクチャは、テクノロジの原則、Azure IoT サービスの構成、デバイスなど、IoT ソリューションの要素について説明するものです。 アーキテクチャは、実装テクノロジに関する推奨事項にもなっています。

最上位レベルでは、IoT ソリューションは以下のものから構成されていると考えることができます。

* 測定値やイベントなどのテレメトリを生成して送信するモノ。 リモート監視ソリューション アクセラレータでは、トラックやエレベーターなどのデバイスが、テレメトリを送信するモノです。
* モノから送信されたテレメトリから生成される分析情報。 リモート監視ソリューション アクセラレータでは、ルールによって分析情報が生成されます。 たとえば、あるルールでは、エンジンの温度がしきい値に達するタイミングを識別できます。
* 分析情報に基づくアクション。それが、ビジネスやプロセスの改善に役立ちます。 リモート監視ソリューション アクセラレータでは、メールのアクションによって、オペレーターにエンジンの潜在的な問題について通知できます。

[Azure IoT リファレンス アーキテクチャ](https://aka.ms/iotrefarchitecture)は、テクノロジの進化と共に更新されて変化するドキュメントです。

## <a name="core-subsystems"></a>コア サブシステム

リファレンス アーキテクチャでは、次の図に示すコア サブシステムを確認します。

![コア サブシステム](media/iot-accelerators-architecture-overview/CoreSubsystems.png)

以降のセクションでは、リモート監視ソリューション アクセラレータのコンポーネントがコア サブシステムにどのようにマップされているかを説明します。

### <a name="iot-devices"></a>IoT デバイス

IoT ソリューションでは、ほぼあらゆる種類のデバイスとクラウド ゲートウェイ間に、セキュリティで保護された効率的で堅牢な通信を実現する必要があります。 デバイスは、単純な温度センサーから、数百のコンポーネントやセンサーを含む複雑な工場の生産ラインに及ぶビジネス資産です。

フィールド ゲートウェイ、すなわちエッジ デバイスは、特殊なデバイス アプライアンス、または以下のものとして機能することができる汎用のソフトウェアです。

* プロトコル変換を処理するための、通信を可能にする機能。
* ローカルのデバイス制御システムやデバイス テレメトリ処理ハブ。 エッジ デバイスは、クラウドと通信することなく、テレメトリをローカルで処理してデバイスを制御できます。 エッジ デバイスは、デバイスのテレメトリをフィルター処理または集約して、クラウドに転送されるテレメトリの量を減らすこともできます。

リモート監視ソリューションでは、デバイスは IoT hub に接続し、処理のためにテレメトリを送信します。 リモート監視ソリューションでは、オペレーターがジョブまたはデバイスの自動管理を使用してデバイスを管理することもできます。 デバイスは Azure IoT device SDK を使用して実装できます。

リモート監視ソリューションでは、IoT Edge デバイスの配置と管理が可能です。 エッジでの処理は、クラウドに送信されるテレメトリの量を減らし、デバイス イベントに対する応答を高速化するのに役立ちます。

### <a name="cloud-gateway"></a>クラウド ゲートウェイ

クラウド ゲートウェイは、デバイスおよびエッジ デバイス間の通信を可能にするものです。 これらのデバイスは、多くのリモート サイトにある場合もあります。

ゲートウェイは、接続の管理、通信パスの保護、認証、承認を含め、デバイスの通信を管理します。 ゲートウェイは、接続とスループットのクォータの適用と、課金、診断、およびその他の監視タスクのために使用されるテレメトリの収集も行います。

リモート監視ソリューションでは、IoT ハブをデプロイして、デバイスのテレメトリ送信先となる、セキュリティで保護されたエンドポイントを提供しています。 IoT ハブには以下の特徴もあります。

* ソリューションへの接続が許可されるデバイスを管理するデバイス ID ストアが含まれます。
* ソリューションがデバイスにコマンドを送信できるようにします。 たとえば、バルブを開いて圧力を解放します。
* デバイスの一括管理を可能にします。 たとえば、一連のデバイスのファームウェアをアップグレードします。

### <a name="stream-processing"></a>ストリーム処理

ソリューションでテレメトリを取り込むときには、テレメトリ処理の流れがどのように変わる可能性があるかを理解しておくことが重要です。 シナリオによっては、データ レコードが異なるステージを通って流れる場合があります。

* メモリ内キャッシュなどのストレージ、一時的キュー、永続的アーカイブ。

* 一連の条件を通して入力テレメトリを実行する分析。異なる出力データ レコードが生成される場合があります。 たとえば、Avro でエンコードされた入力テレメトリは、JSON でエンコードされた出力テレメトリを返すことがあります。

* 元の入力テレメトリと分析の出力レコードは、一般に、保存されて表示のために使用可能にされます。 入力テレメトリや出力レコードが、メール、インシデント チケット、デバイス コマンドなどのアクションをトリガーすることもあります。

ルーティングにより、テレメトリを 1 つ以上のストレージ エンドポイント、分析プロセス、およびアクションにディスパッチできます。 ソリューションにおいて、異なる順序でステージを結合し、同時実行の並列タスクでそれらを処理することもあります。

リモート監視ソリューションでは、ストリーム処理のために [Azure Stream Analytics](/azure/stream-analytics/) を使用しています。 ソリューション内のルール エンジンは、Stream Analytics クエリを使用してアラームとアクションを生成します。 たとえば、ソリューションでクエリを使用し、トラックの貨物室で、5 分間での平均温度が36 度を下回ったときを識別できます。

### <a name="storage"></a>Storage

IoT ソリューションでは、大量のデータが生成される場合があります。これは多くの場合、時系列データです。 このデータは、視覚化とレポート作成のために使用できる場所に格納する必要があります。 ソリューションで、分析や追加の処理のために、後からデータにアクセスする必要がある場合もあります。 データはウォーム データ ストアとコールド データ ストアに分割するのが一般的です。 ウォーム データ ストアでは、待ち時間が短いアクセスのために最新のデータを保持します。 コールド データ ストアには、通常、履歴データが格納されます。

リモート監視ソリューションでは、[Azure Time Series Insights](/azure/time-series-insights/) をウォーム データ ストアとして使用し、Cosmos DB をコールド データ ストアとして使用しています。

### <a name="ui-and-reporting-tools"></a>UI とレポート作成ツール

ソリューションの UI では、以下を提供できます。

* デバイス データと分析結果の視覚化と、それらへのアクセス。
* レジストリを通したデバイスの検出。
* コマンドとデバイスの制御。
* デバイス プロビジョニングのワークフロー。
* 通知とアラート。
* 多数のデバイスからのデータを表示する、ライブの対話型ダッシュ ボードとの統合。  
* 地理的な場所と地理情報に対応するサービス。

リモート監視ソリューションには、この機能を提供する Web UI が含まれています。 この Web UI には以下が含まれています。

* デバイスの場所を表示する対話型マップ。
* テレメトリのクエリと分析のための、Time Series Insights エクスプ ローラーへのアクセス機能。

### <a name="business-integration"></a>ビジネス統合

ビジネス統合レイヤーでは、IoT ソリューションと、CRM、ERP、基幹業務アプリケーションなどのビジネス システムとの統合を処理します。 例としては、サービス課金、カスタマー サポート、交換部品の供給などがあります。

リモート監視ソリューションでは、条件が満たされたときにメールを送信するルールを使用しています。 たとえばソリューションで、トラック内の温度が 36 度を下回ったときにオペレーターに通知できます。

## <a name="next-steps"></a>次の手順

この記事では、Azure IoT リファレンス アーキテクチャについて学習し、リモート監視ソリューション アクセラレータがその推奨事項にどのように従っているかの例をいくつか確認しました。 次の手順として、[Microsoft Azure IoT リファレンス アーキテクチャ](https://aka.ms/iotrefarchitecture)についてのドキュメントを読んでください。