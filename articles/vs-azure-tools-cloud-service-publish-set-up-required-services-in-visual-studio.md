---
title: "Visual Studio からの Azure アプリケーションの発行またはデプロイの準備 | Microsoft Docs"
description: "クラウド サービスとストレージ アカウント サービスを設定し、Azure アプリケーションを構成する手順を説明します。"
services: visual-studio-online
documentationcenter: na
author: TomArcher
manager: douge
editor: 
ms.assetid: 92ee2f9e-ec49-4c7a-900d-620abe5e9d8a
ms.service: multiple
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: multiple
ms.date: 11/11/2016
ms.author: tarcher
translationtype: Human Translation
ms.sourcegitcommit: 01623fa76175091439d5a571fb8b8f96aee01c4c
ms.openlocfilehash: 5d747a7c34b340c6f98dabb2c3ff4d3340e74e4a


---
# <a name="prepare-to-publish-or-deploy-an-azure-application-from-visual-studio"></a>Visual Studio からの Azure アプリケーションの発行またはデプロイの準備
## <a name="overview"></a>概要
クラウド サービス プロジェクトを発行可能にするには、次のサービスを設定する必要があります。

* Azure 環境でロールを実行する **クラウド サービス**
* BLOB サービス、Queue サービス、および Table サービスへのアクセスを提供する **ストレージ アカウント**

これらのサービスを設定し、アプリケーションを構成するには、次の手順を使用します。

## <a name="create-a-cloud-service"></a>クラウド サービスを作成する
Azure にクラウド サービスを発行するには、まず、Azure 環境でロールを実行するクラウド サービスを作成する必要があります。 このトピックの「 [Azure クラシック ポータルを使用してクラウド サービスを作成するには](http://go.microsoft.com/fwlink/?LinkID=213885)」で後述するように、 **Azure クラシック ポータル**でクラウド サービスを作成できます。 クラウド サービスは、発行ウィザードを使用して Visual Studio を作成することもできます。

### <a name="to-create-a-cloud-service-by-using-visual-studio"></a>Visual Studio を使用してクラウド サービスを作成するには
1. Azure プロジェクトのショートカット メニューを開き、 **[発行]**をクリックします。

    ![VST_PublishMenu](./media/vs-azure-tools-cloud-service-publish-set-up-required-services-in-visual-studio/vst-publish-menu.png)
2. サインインしていない場合は、Azure サブスクリプションに関連付けられている Microsoft アカウントまたは組織アカウントのユーザー名とパスワードを使用してサインインします。
3. **[次へ]** をクリックし、**[設定]** ページに進みます。

    ![Publishing Wizard Common Settings](./media/vs-azure-tools-cloud-service-publish-set-up-required-services-in-visual-studio/publish-settings-page.png)
4. **[Cloud Services]** 一覧で、**[新規作成]** をクリックします。 **[Azure サービスの作成]** ダイアログが表示されます。
5. クラウド サービスの名前を入力します。 この名前はサービスの URL の一部として使用されるため、グローバルに一意であることが必要です。 この名前では、大文字小文字が区別されません。

### <a name="to-create-a-cloud-service-by-using-the-azure-classic-portal"></a>Azure クラシック ポータル
1. Microsoft Web サイトの [Azure クラシック ポータル](http://go.microsoft.com/fwlink/?LinkId=253103) にサインインします。
2. (省略可能) 既に作成したクラウド サービスの一覧を表示するには、ページの左側にある [Cloud Services] リンクを選択します。
3. 左下隅にある **[+]** アイコンを選択し、表示されるメニューで **[クラウド サービス]** を選択します。 **[簡易作成]** と **[カスタム作成]** という&2; つのオプションがある別の画面が表示されます。 **[簡易作成]**を選択した場合、URL と物理的にホストするリージョンを指定するだけで、クラウド サービスを作成できます。 **[カスタム作成]**を選択した場合、パッケージ (.cspkg ファイル)、構成 (.cscfg) ファイル、および証明書を指定することで、クラウド サービスをすぐに発行できます。 Azure プロジェクトの **[発行]** コマンドを使用してクラウド サービスを発行する場合、カスタム作成は必須ではありません。 **[発行]** コマンドは、Azure プロジェクトのショートカット メニューで使用できます。
4. 後で Visual Studio を使用してクラウド サービスを発行する場合は、 **[簡易作成]** を選択します。
5. クラウド サービスの名前を指定します。 名前の隣に完全な URL が表示されます。
6. 一覧で、ユーザーが主に配置されているリージョンを選択します。
7. ウィンドウの下部にある **[クラウド サービスの作成]** リンクを選択します。

## <a name="create-a-storage-account"></a>ストレージ アカウントの作成
ストレージ アカウントを使用すると、BLOB サービス、Queue サービス、および Table サービスにアクセスできます。 ストレージ アカウントは、Visual Studio または [Azure クラシック ポータル](http://go.microsoft.com/fwlink/?LinkId=253103)を使用して作成できます。

### <a name="to-create-a-storage-account-by-using-visual-studio"></a>Visual Studio を使用して、ストレージ アカウントを作成するには
1. **ソリューション エクスプローラー**で **[ストレージ]** ノードのショートカット メニューを開き、**[ストレージ アカウントの作成]** を選択します。

    ![Create a new Azure storage account](./media/vs-azure-tools-cloud-service-publish-set-up-required-services-in-visual-studio/IC744166.png)
2. **[ストレージ アカウントの作成]** ダイアログ ボックスで、新しいストレージ アカウントの次の情報を選択または入力します。

   * ストレージ アカウントを追加する Azure サブスクリプション。
   * 新しいストレージ アカウントに使用する名前。
   * リージョンまたはアフィニティ グループ (米国西部や東アジアなど)。
   * geo 冗長など、ストレージ アカウントで使用するレプリケーションの種類。
3. 終了したら **[作成]** を選択します。**サーバー エクスプローラー**の **[ストレージ]** 一覧に新しいストレージ アカウントが表示されます。

### <a name="to-create-a-storage-account-by-using-the-azure-classic-portal"></a>Azure クラシック ポータルを使用して、ストレージ アカウントを作成するには
1. Microsoft Web サイトの [Azure クラシック ポータル](http://go.microsoft.com/fwlink/?LinkId=253103) にサインインします。
2. (省略可能) ストレージ アカウントを表示するには、ページの左側のパネルで **[Storage]** リンクを選択します。
3. ページの左下隅にある **+** アイコンをクリックします。
4. 表示されるメニューで、**[ストレージ]**、**[簡易作成]** の順にクリックします。
5. ストレージ アカウントに一意の URL となる名前を付けます。
6. クラウド サービスに名前を付けます。 名前の隣に完全な URL が表示されます。
7. リージョンの一覧で、ユーザーが主に配置されているリージョンを選択します。
8. geo レプリケーションを有効にするかどうかを指定します。 geo レプリケーションを有効にした場合は、データは複数の物理的な場所に保存され、損失の可能性が低減します。 この機能ではストレージは高価になりますが、機能を後で追加するのではなく、ストレージ アカウントを作成するときに geo ロケーションを有効にすると、コストを削減することができます。 詳細については、 [geo レプリケーション](http://go.microsoft.com/fwlink/?LinkId=253108)に関するページを参照してください。
9. ウィンドウの下部にある **[ストレージ アカウントの作成]** リンクをクリックします。

ストレージ アカウントを作成したら、各 Azure Storage サービスのリソースにアクセスするために使用できる URL が表示されます。また、アカウントのプライマリ アクセス キーとセカンダリ アクセス キーも表示されます。 これらのキーは、ストレージ サービスに対する要求を認証するために使用します。

> [!NOTE]
> セカンダリ アクセス キーは、プライマリ アクセス キーと同じようにストレージ アカウントにアクセスでき、プライマリ アクセス キーが侵害された場合の予備として生成されます。 また、定期的にアクセスのキーを再生成することをお勧めします。 プライマリ キーの再生成時にセカンダリ キーを使用するように接続文字列の設定を変更した後で、セカンダリ キーの再生成時に再生成したプライマリ キーを使用するように接続文字列の設定を変更できます。
>
>

## <a name="configure-your-app-to-use-services-provided-by-the-storage-account"></a>ストレージ アカウントによって提供されるサービスを使用するようアプリケーションを構成する
作成した Azure Storage サービスを使用するには、Storage サービスにアクセスするロールを構成する必要があります。 これを行うために、Azure プロジェクトの複数のサービス構成を使用できます。 既定では、Azure プロジェクトに&2; つのサービス構成が作成されます。 複数のサービス構成を使用すると、コード内では同じ接続文字列を使用しつつ、各サービス構成で定めた接続文字列に別の値を適用することができます。 たとえば、Azure ストレージ エミュレーターを使用してアプリケーションをローカルで実行およびデバッグするサービス構成と、Azure にアプリケーションを発行する別のサービス構成を使用できます。 サービス構成ファイルの詳細については、「 [複数のサービス構成を使用した Azure プロジェクトの構成](vs-azure-tools-multiple-services-project-configurations.md)」を参照してください。

### <a name="to-configure-your-application-to-use-services-that-the-storage-account-provides"></a>ストレージ アカウントが提供するサービスを使用するようアプリケーションを構成するには
1. Visual Studio で Azure ソリューションを開きます。 ソリューション エクスプローラーで、ストレージ サービスにアクセスする Azure プロジェクトの各ロールのショートカット メニューを開き、 **[プロパティ]**をクリックします。 ロールの名前のページが、Visual Studio エディターに表示されます。 ページには、 **[構成]** タブのフィールドが表示されます。
2. ロールのプロパティ ページで **[設定]**を選択します。
3. **[サービスの構成]** ボックスの一覧で、編集するサービス構成の名前を選択します。 このロールのすべてのサービス構成を変更する場合は、 **[すべての構成]**を選択できます。  サービス構成の更新の方法については、「 **Visual Studio で Azure クラウド サービスのロールを構成する** 」トピックの「 [ストレージ アカウント用の接続文字列の管理](vs-azure-tools-configure-roles-for-cloud-service.md)」セクションを参照してください。
4. 接続文字列の設定を変更するには、設定の隣にある **[...]** ボタンをクリックします。 **[ストレージ接続文字列の作成]** ダイアログ ボックスが表示されます。
5. **[接続方法]** で **[サブスクリプション]** オプションをクリックします。
6. **[サブスクリプション]** 一覧で、目的のサブスクリプションを選択します。 目的のサブスクリプションが一覧に含まれていない場合は、 **[発行設定のダウンロード]** リンクを選択します。
7. **[アカウント名]** 一覧で、ストレージ アカウント名を選択します。 Azure Tools は .publishsettings ファイルを使用して、自動的にストレージ アカウントの資格情報を取得します。 ストレージ アカウントの資格情報を手動で指定するには、 **[手動で入力された資格情報]** オプションを選択し、この手順を続行します。 ストレージ アカウント名とプライマリ キーは、 [Azure クラシック ポータル](http://go.microsoft.com/fwlink/p/?LinkID=213885)から取得できます。 ストレージ アカウントの設定を手動で指定しない場合は、 **[OK]** をクリックし、ダイアログ ボックスを閉じます。
8. **[ストレージ アカウントの資格情報の入力]** リンクをクリックします。
9. ストレージ アカウントの名前を **[アカウント名]** に入力します。

   > [!NOTE]
   > [Azure クラシック ポータル](http://go.microsoft.com/fwlink/?LinkID=213885)にログインし、 **[ストレージ]** ボタンをクリックします。 ポータルでは、ストレージ アカウントの一覧が表示されます。 アカウントを選択すると、アカウント用のページが開きます。 このページからストレージ アカウントの名前をコピーできます。 以前のバージョンのクラシック ポータルを使用している場合は、 **[ストレージ アカウント]** ビューにストレージ アカウントの名前が表示されます。 この名前をコピーするには、このビューの **[プロパティ]** ウィンドウで強調表示し、Ctrl キーを押しながら C キーを押します。 Visual Studio に名前を貼り付けるには、 **[アカウント名]** ボックスを選択し、Ctrl キーを押しながら V キーを押します。
   >
   >
10. **[アカウント キー]** ボックスで、プライマリ キーを入力するか、 [Azure クラシック ポータル](http://go.microsoft.com/fwlink/?LinkID=213885)からコピーして貼り付けます。
     このキーをコピーするには、次の手順に従います。

    1. 該当するストレージ アカウントのページの下部で、 **[キーの管理]** をクリックします。
    2. **[キーのアクセスを管理]** ページで、プライマリ アクセス キーのテキストを選択し、Ctrl キーを押しながら C キーを押します。
    3. Azure Tools で、 **[アカウント キー]** ボックスにキーを貼り付けます。
    4. サービスがストレージ アカウントにアクセスする方法を決定するには、次のオプションのいずれかを選択する必要があります。

       * **[HTTP を使用する]**。 これは、標準的なオプションです。 たとえば、「 `http://<account name>.blob.core.windows.net`」のように入力します。
       * **[HTTPS を使用する]**。これは、セキュリティで保護された接続に使用します。 たとえば、「 `https://<accountname>.blob.core.windows.net`」のように入力します。
       * **[カスタム エンドポイントを指定する]**。これは、3 つのサービスそれぞれに対してエンドポイントを指定するときに使用します。 このオプションを選択すると、特定のサービスのフィールドにエンドポイントを入力できます。

         > [!NOTE]
         > カスタム エンドポイントを作成する場合は、より複雑な接続文字列を作成できます。 この文字列形式を使用する場合は、ストレージ アカウント用に BLOB サービスに登録したカスタム ドメイン名を含むストレージ サービス　エンドポイントを指定できます。 また、Shared Access Signature を介して単一コンテナーの BLOB リソースにのみアクセスを許可できます。 カスタム エンドポイントの作成方法の詳細については、「[Azure Storage の接続文字列を構成する](storage/storage-configure-connection-string.md)」を参照してください。
         >
         >
11. これらの接続文字列の変更を保存するには、**[OK]** をクリックし、ツール バーの **[保存]** ボタンをクリックします。 これらの変更を保存すると、 [GetConfigurationSettingValue](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleenvironment.getconfigurationsettingvalue.aspx)を使用して、コード内のこの接続文字列の値を取得できるようになります。 Azure にアプリケーションを発行するときに、接続文字列用の Azure ストレージ アカウントを含むサービス構成を選択します。 アプリケーションを発行した後、アプリケーションが Azure Storage サービスに対して期待どおりに動作することを確認します。

## <a name="next-steps"></a>次のステップ
Visural Studio からの Azure へのアプリ発行の詳細については、「 [Azure Tools を使用したクラウド サービスの発行](vs-azure-tools-publishing-a-cloud-service.md)」を参照してください。



<!--HONumber=Dec16_HO2-->


