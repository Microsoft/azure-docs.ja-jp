---
title: B2B エンタープライズ統合用の AS2 メッセージ - Azure Logic Apps | Microsoft Docs
description: Azure Logic Apps と Enterprise Integration Pack で B2B エンタープライズ統合用の AS2 メッセージを交換する
services: logic-apps
ms.service: logic-apps
ms.suite: integration
author: divyaswarnkar
ms.author: divswa
ms.reviewer: jonfan, estfan, LADocs
ms.topic: article
ms.assetid: c9b7e1a9-4791-474c-855f-988bd7bf4b7f
ms.date: 06/08/2017
ms.openlocfilehash: 3413b235d9202530eb1a3129637e3746bbe6585b
ms.sourcegitcommit: 5839af386c5a2ad46aaaeb90a13065ef94e61e74
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/19/2019
ms.locfileid: "57872571"
---
# <a name="exchange-as2-messages-for-b2b-enterprise-integration-in-azure-logic-apps-with-enterprise-integration-pack"></a>Azure Logic Apps と Enterprise Integration Pack で B2B エンタープライズ統合用の AS2 メッセージを交換する

Azure Logic Apps の AS2 メッセージを交換する前に、AS2 契約を作成し、その契約を統合アカウントに格納する必要があります。 AS2 契約を作成する手順を次に示します。

## <a name="before-you-start"></a>開始する前に

必要な項目を次に示します。

* 既に定義され、Azure サブスクリプションに関連付けられている[統合アカウント](../logic-apps/logic-apps-enterprise-integration-accounts.md)
* 統合アカウントで既に定義され、**ビジネス ID** の AS2 修飾子を使用して構成されている 2 つ以上の[パートナー](logic-apps-enterprise-integration-partners.md)

> [!NOTE]
> 契約を作成する場合は、契約のファイルの内容が契約の種類と一致している必要があります。    

[統合アカウントを作成](../logic-apps/logic-apps-enterprise-integration-accounts.md)し、[パートナーを追加](logic-apps-enterprise-integration-partners.md)した後に、AS2 契約を作成するには、次の手順に従います。

## <a name="create-an-as2-agreement"></a>AS2 契約の作成

1.  [Azure Portal](https://portal.azure.com "Azure Portal") にサインインします。  

2. Azure のメイン メニューで、**[すべてのサービス]** を選びます。 検索ボックスに「統合」と入力し、"**統合アカウント**" を選びます。

   ![統合アカウントの検索](./media/logic-apps-enterprise-integration-as2/overview-1.png)

   > [!TIP]
   > **[すべてのサービス]** が表示されない場合は、メニューを最初に展開する必要があります。 折りたたまれたメニューの上部にある **[テキスト ラベルの表示]** を選びます。

3. **[統合アカウント]** で、契約を作成する統合アカウントを選びます。

   ![契約を作成する統合アカウントの選択](./media/logic-apps-enterprise-integration-overview/overview-3.png)

4. **[契約]** タイルを選択します。 [契約] タイルが表示されない場合は、まずタイルを追加します。

    ![[契約] タイルの選択](./media/logic-apps-enterprise-integration-as2/agreement-1.png)

5. **[契約]** で **[追加]** を選びます。

    ![[追加] の選択](./media/logic-apps-enterprise-integration-as2/agreement-2.png)

6. **[追加]** で、契約の**名前**を入力します。 **[契約タイプ]** で、**[AS2]** を選択します。 契約の**ホスト パートナー**、**ホスト ID**、**ゲスト パートナー**、および**ゲスト ID** を選択します。

    ![契約の詳細の指定](./media/logic-apps-enterprise-integration-as2/agreement-3.png)  

    | プロパティ | 説明 |
    | --- | --- |
    | Name |契約の名前。 |
    | 契約の種類 | AS2 である必要があります |
    | ホスト パートナー |契約には、ホストとゲストの両方のパートナーが必要です。 ホスト パートナーは、契約を構成している組織を表します。 |
    | ホスト ID |ホスト パートナーの ID。 |
    | Guest Partner (ゲスト パートナー) |契約には、ホストとゲストの両方のパートナーが必要です。 ゲスト パートナーは、ホスト パートナーと取引している組織を表します。 |
    | ゲスト ID |ゲスト パートナーの ID。 |
    | 受信設定 |これらのプロパティは、契約によって受信されたすべてのメッセージに適用されます。 |
    | Send Settings (送信の設定) |これらのプロパティは、契約によって送信されたすべてのメッセージに適用されます。 |

## <a name="configure-how-your-agreement-handles-received-messages"></a>契約で受信したメッセージを処理する方法の構成

契約のプロパティを設定したので、この契約でパートナーから受信した受信メッセージを識別して処理する方法を構成できます。

1.  **[追加]** で、**[受信設定]** をクリックします。
メッセージを交換するパートナーとの契約に基づいて、これらのプロパティを構成します。 プロパティの説明については、このセクションの表を参照してください。

    ![[受信設定] の構成](./media/logic-apps-enterprise-integration-as2/agreement-4.png)

2. 必要に応じて、**[メッセージ プロパティをオーバーライドします]** チェック ボックスをオンにすることで、受信メッセージのプロパティをオーバーライドできます。

3. すべての受信メッセージに署名することを要求するには、**[メッセージに署名してください]** チェック ボックスをオンにします。 [[証明書]](../logic-apps/logic-apps-enterprise-integration-certificates.md) ボックスの一覧から、メッセージの署名の検証に使用する既存の**ゲスト パートナーの公開証明書**を選択します。 証明書がない場合は作成します。

4.  すべての受信メッセージを暗号化することを要求するには、**[メッセージは暗号化する必要があります]** チェック ボックスをオンにします。 **[証明書]** ボックスの一覧から、受信メッセージの暗号化解除に使用する既存の[ホスト パートナーのプライベート証明書](../logic-apps/logic-apps-enterprise-integration-certificates.md)を選択します。 証明書がない場合は作成します。

5. メッセージを圧縮することを要求するには、**[メッセージは圧縮する必要があります]** チェック ボックスをオンにします。

6. 受信メッセージに対して同期 Message Disposition Notification (MDN) を送信するには、**[MDN を送信する]** チェック ボックスをオンにします。

7. 受信メッセージに対して署名付き MDN を送信するには、**[署名付き MDN を送信する]** チェック ボックスをオンにします。

8. 受信メッセージに対して非同期 MDN を送信するには、**[非同期 MDN を送信する]** チェック ボックスをオンにします。

9. 完了したら、**[OK]** を選択して、必ず設定を保存します。

これで選択した設定に準拠する受信メッセージを処理する準備ができました。

| プロパティ | 説明 |
| --- | --- |
| メッセージ プロパティをオーバーライドします |受信メッセージのプロパティをオーバーライドできることを示します。 |
| メッセージに署名してください |メッセージがデジタル署名されることを要求します。 署名を検証するためのゲスト パートナーの公開証明書を構成します。  |
| メッセージは暗号化する必要があります |メッセージを暗号化することを要求します。 暗号化されていないメッセージは拒否されます。 メッセージを復号化するためのホスト パートナーのプライベート証明書を構成します。  |
| メッセージは圧縮する必要があります |メッセージを圧縮することを要求します。 圧縮されていないメッセージは拒否されます。 |
| MDN テキスト |既定の Message Disposition Notification (MDN) をメッセージの送信者に送信します。 |
| MDN を送信する |MDN を送信することを要求します。 |
| 署名付き MDN を送信する |MDN に署名することを要求します。 |
| MIC アルゴリズム |メッセージの署名に使用するアルゴリズムを選択します。 |
| 非同期 MDN を送信する | メッセージを非同期で送信することを要求します。 |
| URL | MDN の送信先となる URL を指定します。 |

## <a name="configure-how-your-agreement-sends-messages"></a>契約でメッセージを送信する方法の構成

この契約でパートナーに送信する送信メッセージを識別して処理する方法を構成できます。

1.  **[追加]** で、**[送信設定]** をクリックします。
メッセージを交換するパートナーとの契約に基づいて、これらのプロパティを構成します。 プロパティの説明については、このセクションの表を参照してください。

    ![[送信設定] プロパティの設定](./media/logic-apps-enterprise-integration-as2/agreement-51.png)

2. パートナーに署名付きメッセージを送信するには、**[メッセージの署名を有効にしてください]** チェック ボックスをオンにします。 **[MIC アルゴリズム]** ボックスの一覧から、メッセージの署名に使用する*ホスト パートナーのプライベート証明書の MIC アルゴリズム*を選択します。 **[証明書]** ボックスの一覧から、既存の[ホスト パートナーのプライベート証明書](../logic-apps/logic-apps-enterprise-integration-certificates.md)を選択します。

3. パートナーに暗号化されたメッセージを送信するには、**[メッセージの暗号化を有効にしてください]** チェック ボックスをオンにします。 **[暗号化アルゴリズム]** ボックスの一覧から、メッセージの暗号化に使用する*ゲスト パートナーの公開証明書のアルゴリズム*を選択します。
**[証明書]** ボックスの一覧から、既存の[ゲスト パートナーの公開証明書](../logic-apps/logic-apps-enterprise-integration-certificates.md)を選択します。

4. メッセージを圧縮するには、**[メッセージの圧縮を有効にしてください]** チェック ボックスをオンにします。

5. HTTP Content-Type ヘッダーを 1 行に展開するには、**[HTTP のヘッダーを展開する]** チェック ボックスをオンにします。

6. 送信メッセージに対する同期 MDN を受信するには、**[MDN を要求する]** チェック ボックスをオンにします。

7. 送信メッセージに対する署名付き MDN を受信するには、**[署名付き MDN を要求する]** チェック ボックスをオンにします。

8. 送信メッセージに対する非同期 MDN を受信するには、**[非同期 MDN を要求する]** チェック ボックスをオンにします。 このオプションを選択した場合は、MDN の送信先となる URL を入力します。

9. NRR (Non-repudiation of receipt) を有効にするには、**[NRR を有効にする]** を選択します。  

10. AS2 メッセージまたは MDN の送信ヘッダーで MIC または署名に使用するアルゴリズム形式を指定するには、**[SHA2 アルゴリズム形式]** を選択します。  

11. 完了したら、**[OK]** を選択して、必ず設定を保存します。

これで選択した設定に準拠する送信メッセージを処理する準備ができました。

| プロパティ | 説明 |
| --- | --- |
| メッセージの署名を有効にしてください |この契約から送信されるすべてのメッセージに署名することを要求します。 |
| MIC アルゴリズム |メッセージの署名に使用するアルゴリズム。 メッセージに署名するための、ホスト パートナーのプライベート証明書の MIC アルゴリズムを構成します。 |
| 証明書 |メッセージの署名に使用する証明書を選択します。 メッセージに署名するためのホスト パートナーのプライベート証明書を構成します。 |
| メッセージの暗号化を有効にしてください |この契約から送信されるすべてのメッセージを暗号化することを要求します。 メッセージを暗号化するための、ゲスト パートナーの公開証明書のアルゴリズムを構成します。 |
| 暗号化アルゴリズム |メッセージの暗号化に使用する暗号化アルゴリズム。 メッセージを暗号化するためのゲスト パートナーの公開証明書を構成します。 |
| 証明書 |メッセージを暗号化するために使用する証明書。 メッセージを暗号化するためのゲスト パートナーのプライベート証明書を構成します。 |
| メッセージの圧縮を有効にしてください |この契約から送信されるすべてのメッセージを圧縮することを要求します。 |
| HTTP のヘッダーを展開する |HTTP Content-Type ヘッダーを 1 行に配置します。 |
| MDN を要求する |この契約から送信されるすべてのメッセージに対する MDN を要求します。 |
| 署名付き MDN を要求する |この契約に対して送信されるすべての MDN に署名することを要求します。 |
| 非同期 MDN を要求する |この契約に対して非同期 MDN を送信することを要求します。 |
| URL |MDN の送信先となる URL を指定します。 |
| NRR を有効にする |データが指定の宛先で受信されたことの証拠を提供する通信属性である NRR (Non-repudiation of receipt) を要求します。 |
| SHA2 アルゴリズム形式 |AS2 メッセージまたは MDN の送信ヘッダーで MIC または署名に使用するアルゴリズム形式を選択します。 |

## <a name="find-your-created-agreement"></a>作成された契約の検索

1. 契約のプロパティをすべて設定した後、**[追加]** ページで **[OK]** を選んで契約の作成を終了し、統合アカウントに戻ります。

    これで、新しく追加した契約が **[契約]** リストに表示されます。

2. また、統合アカウントの概要で、契約を表示することもできます。 統合アカウント メニューで、**[概要]**、**[契約]** タイルの順に選びます。 

   ![すべての契約が表示される [契約] タイルの選択](./media/logic-apps-enterprise-integration-as2/agreement-6.png)

## <a name="view-the-swagger"></a>Swagger の表示
[Swagger の詳細](/connectors/as2/)を参照してください。 

## <a name="next-steps"></a>次の手順
* [Enterprise Integration Pack についての詳細情報](logic-apps-enterprise-integration-overview.md "Enterprise Integration Pack についての詳細情報")  
