---
title: 3ds Max で PBR マテリアルを設定する
description: 3ds Max で物理ベース レンダリング マテリアルを設定し、FBX 形式でエクスポートする方法について説明します。
author: muxanickms
ms.author: misams
ms.date: 06/16/2020
ms.topic: tutorial
ms.openlocfilehash: ac0f4ee8f06982126d2ae30bed01716b287e8993
ms.sourcegitcommit: 3d79f737ff34708b48dd2ae45100e2516af9ed78
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/23/2020
ms.locfileid: "87078042"
---
# <a name="tutorial-set-up-physically-based-rendering-materials-in-3ds-max"></a>チュートリアル:3ds Max で物理ベース レンダリング マテリアルを設定する

## <a name="overview"></a>概要
このチュートリアルで学習する内容は次のとおりです。

>[!div class="checklist"]
>
> * 高度なライティングが施されたマテリアル (素材) をシーン内のオブジェクトに割り当てる。
> * オブジェクトと素材のインスタンス化を処理する。
> * シーンを FBX 形式でエクスポートし、重要なオプションを選択する。

3ds Max で[物理ベース レンダリング (PBR) マテリアル](../../overview/features/pbr-materials.md)を作成するのは簡単な作業です。 Maya のような他のコンテンツ作成アプリでの PBR 設定と多くの点で似ています。 このチュートリアルは、Azure Remote Rendering プロジェクトの基本的な PBR シェーダー設定と FBX エクスポートに関するガイドです。

このチュートリアルのサンプル シーンには、いくつかのポリゴン ボックス オブジェクトが含まれています。 これらには、木材、金属、塗装金属、プラスチック、ゴムなど、さまざまなマテリアルが割り当てられています。 大まかに言うと、各素材には次のテクスチャのすべてまたはほとんどが含まれています。

* **Albedo (アルベド)** : マテリアルのカラー マップです。**Diffuse (拡散)** および **BaseColor (ベースカラー)** とも呼ばれます。
* **Metalness (メタルネス)** : 素材が金属であるかどうか、およびどのパーツが金属であるかを決定します。 
* **Roughness (粗さ)** : 表面の粗さまたは滑らかさを決定します。
また、反射のシャープネスまたはぼかしと、表面のハイライトにも影響します。
* **Normal (法線)** : ポリゴンを追加しなくても、表面にディテールを追加できます。 ディテールの例としては、金属表面のくぼみやへこみ、木目などがあります。
* **Ambient Occlusion (アンビエント オクルージョン)** : モデルにソフト シェーディングとコンタクト シャドウを追加するために使用します。 これは、モデルのどの領域が完全なライティング (白) または完全なシェード (黒) を受け取るかを示すグレースケール マップです。

## <a name="prepare-the-scene"></a>シーンを準備する
3ds Max で PBR マテリアルを設定するプロセスは次のとおりです。

最初に、ボックス オブジェクトをいくつか作成します。これらはそれぞれ異なる種類のマテリアルを表します。

>[!TIP]
>Remote Rendering 用のアセットの作成を始める前に、測定にメートルが使用されていることに注目してください。  
>
>そのため、シーンのシステム単位をメーターに設定することをお勧めします。 また、シーンをエクスポートするときに、FBX エクスポートの設定で **[Units]\(単位\)** をメーターに設定することもお勧めします。

次のスクリーンショットは、3ds Max でシステム単位をメートルに設定する手順を示しています。 

1. メイン メニューで、 **[カスタマイズ]**  >  **[Units Setup]\(単位の設定\)**  >  **[System Units Setup]\(システム単位の設定\)** に移動します。 **[System Unit Scale]\(システム単位のスケール\)** で、 **[メートル]** を選択します。![システム単位の設定方法を示すスクリーンショット。](media/3dsmax/system-units.jpg)

1. これで、モデルの作成を始めることができます。 サンプルのシーンでは、それぞれが異なる種類のマテリアルを表すいくつかのボックス オブジェクトを作成します。 たとえば、金属、ゴム、プラスチックなどです。 

   >[!TIP]
   >アセットを作成するときは、適切な名前を付けることをお勧めします。 こうすることで、シーンに多数のオブジェクトが含まれる場合でも後で見つけやすくなります。

1. 次のスクリーンショットで示すように、オブジェクトの名前を変更します。 

   ![オブジェクトの名前の変更方法を示すスクリーンショット。](media/3dsmax/rename-objects.jpg)

## <a name="assign-materials"></a>素材を割り当てる

これでシーン内にいくつかのオブジェクト (この場合はいくつかのキューブ) ができたので、PBR の設定を始めることができます。

1. 次のスクリーンショットで示すように、メイン ツール バーの **[Material Editor]\(マテリアル エディター\)** アイコンを選択します。 キーボードの **M** キーを押してエディターを開くこともできます。 マテリアル エディターには 2 つのモードがあり、 **[Modes]\(モード\)** リストで選択できます。 **[Compact Material Editor]\(コンパクトマテリアル エディター\)** モードと **[Slate Material Editor]\(スレートマテリアル エディター\)** モードです。 このシーンは比較的単純なので、コンパクト モードを使用します。

1. マテリアル エディターには、いくつかの球が表示されます。 これらの球はマテリアルです。 これらのマテリアルの 1 つを、シーン内の各オブジェクト (各ボックス) に割り当てます。 マテリアルを割り当てるには、まずメイン ビューポート内でオブジェクトの 1 つを選択します。 次に、マテリアル エディターで最初の球を選択します。 オブジェクトに割り当てると、次の画像に示すように、選択したマテリアルが強調表示されます。

1. 画像に示すように、 **[Assign Material to Selection]\(マテリアルを選択へ割り当て\)** を選択します。 これで、そのマテリアルが選択したオブジェクトに割り当てられました。

   ![マテリアルの割り当て方法を示すスクリーンショット。](media/3dsmax/assign-material.jpg)

    マテリアル エディターでは、ニーズに応じて、さまざまなマテリアルの種類を選択できます。 通常、素材の種類は、既定で **[Standard]\(標準\)** に設定されています。 このマテリアルは、PBR のセットアップには適さない基本的なマテリアルです。 そのため、マテリアルの種類を PBR マテリアルに変更する必要があります。 Azure Remote Rendering プロジェクトに適した 3ds Max マテリアルは物理マテリアルです。

1. マテリアル エディターで、 **[Standard]\(標準\)** タブを選択します。 **[Material/Map Browser]\(マテリアル/マップ ブラウザー\)** で、 **[Physical Material]\(物理マテリアル\)** を選択します。 これにより、割り当てられた **Standard (標準)** マテリアルが PBR Physical Material (物理マテリアル) に変換されます。

   ![マテリアルの変更方法を示すスクリーンショット。](media/3dsmax/physical-material.jpg)

    次のスクリーンショットで示すように、マテリアル エディターに物理マテリアルのプロパティが表示されます。 これで、アセットへのテクスチャの割り当てを始めることができます。

   ![テクスチャの一覧を示すスクリーンショット。](media/3dsmax/textures-list.jpg)

ご覧のように、さまざまなマップとテクスチャをマテリアルに追加することができます。 このチュートリアルのマテリアルでは、テクスチャ スロットを 5 つだけ使用します。

>[!TIP]
>前のスクリーンショットで示されているように、マテリアルに適切な名前を付けることをお勧めします。

テクスチャの生成方法は、好みや使用方法によって異なる場合があります。 たとえば、任意のアセットに適用できるタイル テクスチャを使用したいことがあります。 または、プロジェクトやアセットの特定の部分に、独自のカスタム テクスチャ セットを使用することが必要な場合もあります。 オンラインで取得できる汎用タイル テクスチャを使用することもできます。 また、Photoshop、Quixel Suite、Substance Suite などのアプリで独自に作成することもできます。

テクスチャの割り当てを始める前に、アセットのテクスチャ座標 (UVW) について検討する必要があります。 モデルにテクスチャを適用するときは、モデルを確実にアンラップすることをお勧めします。 (適切に UV をアンラップしないと、テクスチャが正しく表示されません)。このモデルでは、アンビエント オクルージョン (AO) マップを使用するため、これは特に重要です。 Maya の Stingray Shader とは異なり、3ds Max の物理マテリアルには専用の AO テクスチャ スロットはありません。 そのため、AO マップを別のスロットに適用します。 それを他のテクスチャ (タイリング テクスチャなど) とは別に使用できるようにするには、それ独自の UVW マップ チャネルを割り当てます。 

まず、次のスクリーンショットで示すように、モデルに UVW アンラップ修飾子を割り当てます。 

- 選択したオブジェクト プロパティ エディターで、修飾子の一覧を選択します。 表示されるドロップダウン リストで、下にスクロールし、 **[Unwrap UVW]\(UVW アンラップ\)** を選択します。 これにより、UVW アンラップ修飾子がアセットに適用されます。
![UVW アンラップの選択方法を示すスクリーンショット。](media/3dsmax/unwrap-modifier.jpg)

  マップ チャネルは 1 に設定されています。 通常、主なアンラップはマップ チャネル 1 で行います。 この例では、オブジェクトはアンラップされており、テクスチャ座標 (UV) は重複していません。
![アンラップされたテクスチャ座標 (UVW) を示すスクリーンショット。](media/3dsmax/unwrapped-uvw.jpg)

次のステップでは、2 番目の UV マップ チャネルを作成します。

1. 開いている場合は、UV エディターを閉じます。 **[Edit UVs]\(UV を編集\)** メニューの **[チャネル]** セクションで、チャネルの番号を **2** に変更します。 マップ チャネル 2 は、AO マップ用として想定されるチャネルです。 

1. **[Channel Change Warning]\(チャネル変更警告\)** ダイアログ ボックスでは、チャネル 1 の既存の UV を新しいチャネル 2 に**移動**するか、既存の UV を**破棄**して新しい UV アンラップを自動的に作成することができます。 マップ チャネル 1 の UV とは異なる AO マップ用の新しい UV アンラップを作成する場合にのみ、 **[Abandon]\(破棄\)** を選択します。 (たとえば、チャネル 1 でタイル テクスチャを使用する場合)。このチュートリアルでは、新しい UV チャネルを編集する必要はないため、UV をチャネル 1 からチャネル 2 に移動します。

   >[!NOTE]
   >マップ チャネル 1 からマップ チャネル 2 に UV アンラップをコピー (移動) した場合でも、元のマップ チャネルに影響を与えることなく、新しいチャネルの UV に対して必要な編集を行うことができます。

   ![[Channel Change Warning]\(チャネル変更警告\) を示すスクリーンショット。](media/3dsmax/channel-change.jpg)

新しいマップ チャネルを作成したので、マテリアル エディターの物理マテリアルに戻り、テクスチャの追加を始めることができます。 まず、AO マップを追加します。これは、それを正しく動作させるための別のステップがあるからです。 AO マップをマテリアルにプラグイン接続した後、マップ チャネル 2 を使用するように構成する必要があります。

前述したように、3ds Max の物理マテリアルには、AO マップ専用のスロットはありません。 代わりに、AO マップを **[Diffuse Roughness]\(拡散反射光の粗さ\)** スロットに適用します。

1. 物理マテリアルの **[Generic Maps]\(一般マップ\)** の一覧で、 **[Diffuse Roughness]\(拡散反射光の粗さ\)** の **[No Map]\(マップなし\)** スロットを選択して、AO マップを読み込みます。

1. AO テクスチャ プロパティでは、マップ チャネルは既定で **1** に設定されます。 この値を **2** に変更します。 これで、AO マップを追加するために必要な手順は完了です。

   >[!IMPORTANT]
   >これは重要なステップです。チャネル 2 の UV がチャネル 1 のものと異なる場合は、間違ったチャネルが選択されると AO が正しくマッピングされないため、特に重要です。

   ![AO マップを割り当てる方法を示すスクリーンショット。](media/3dsmax/assign-ao-map.jpg)

次に、法線マップを PBR マテリアルに割り当てます。 この操作は、Maya のプロセスとは多少異なります。 法線マップがバンプ マップ スロットに直接適用されることはありません。 (3ds Max の物理マテリアルには法線マップ スロットはありません)。代わりに、法線マップを法線マップ修飾子に追加すると、それ自体が法線のスロットにプラグイン接続されます。

1. (マテリアル エディターの) 物理マテリアルプロパティの **[Special Maps]\(特殊なマップ\)** セクションで、 **[Bump Map]\(バンプ マップ\)** の隣の **[No Map]\(マップなし\)** スロットを選択します。 

1. **[Material/Map Browser]\(マテリアル/マップ ブラウザー\)** で、 **[Normal Bump]\(法線バンプ\)** を見つけて選択します。 これにより、**法線バンプ**修飾子がマテリアルに追加されます。

1. **法線バンプ**修飾子で、 **[Normal]\(法線\)** の横にある **[No Map]\(マップなし\)** を選択します。 法線マップを見つけて読み込みます。

1. 方法が **[Tangent]\(タンジェント\)** に設定されていることを確認します。 (既定でそうなっているはずです)。必要に応じて **[Flip Green (Y)]\(緑をフリップ (Y)\)** を切り替えます。

   ![法線バンプを選択する方法を示すスクリーンショット。](media/3dsmax/normal-bump.jpg)
   ![標準マップの読み込みを示すスクリーンショット。](media/3dsmax/load-normal-map.jpg)

法線マップが正しく割り当てられたら、残りのテクスチャを割り当てて、物理マテリアルのセットアップを完了できます。 このプロセスは簡単です。 考慮する必要のある特別な設定はありません。 次のスクリーンショットでは、マテリアルに割り当てられるテクスチャの完全なセットを示します。 

![マテリアルに割り当てられるテクスチャの完全なセットを示すスクリーンショット。](media/3dsmax/all-textures.jpg)

これで PBR マテリアルの作成とセットアップが済んだので、シーン内のオブジェクトのインスタンス化について検討します。 ナット、ボルト、ねじ、ワッシャーなど、シーン内の類似オブジェクトをインスタンスします。 同じであるオブジェクトは、ファイル サイズの観点から大幅な節約をもたらします。 マスター オブジェクトのインスタンスは、独自のスケール、回転、変換を持つことができるので、必要に応じてシーンに配置できます。 3ds Max でのインスタンス化のプロセスは簡単です。

1. メイン ビューポートで、エクスポートするオブジェクトを 1 つ以上選択します。

1. 変換 (移動) ツールを使用して、**Shift** キーを押しながらアセットを上にドラッグします。 

1. **[Clone Options]\(複製オプション\)** ダイアログ ボックスで、 **[オブジェクト]** を **[インスタンス]** に設定して、 **[OK]** を選択します。

   ![[Clone Options]\(複製オプション\) ダイアログ ボックスのスクリーンショット。](media/3dsmax/instance-object.jpg)

このアクションにより、オブジェクトのインスタンスが作成されます。これは、その親やその親の他のインスタンスとは関係なく、移動、回転、または拡大縮小することができます。

>[!IMPORTANT]
>サブ オブジェクト モードにおいてインスタンスに対して行ったすべての変更は、オブジェクトのすべてのインスタンスに送信されます。 したがって、インスタンス化されたオブジェクトのコンポーネント (頂点やポリゴンの面など) で作業している場合は、すべてのインスタンスに反映させる変更を行うようにしてください。 インスタンス化されたオブジェクトはいつでも一意のオブジェクトにできることに注意してください。 

>[!TIP]
>シーンでインスタンス化するときは、平行してインスタンスを作成することをお勧めします。 後からコピーをインスタンス化されたオブジェクトに置き換えることは困難です。 

エクスポート プロセスに進む前に最後に考慮する必要があるのは、共有するシーンまたはアセットをパッケージ化する方法です。 アセットをクライアントまたはチーム メンバーに渡す場合は、最小限の手間でアセットを開いて確認できるようにすることが理想的です。 したがって、アセットのテクスチャ パスをシーン ファイルに対する相対位置として保持することが重要です。 アセットのテクスチャ パスがローカル ドライブまたは絶対パスまたは場所を指していて、これを別のコンピューターで開いた場合、.max ファイルがテクスチャと同じフォルダーに含まれていても、アセットはシーンに読み込まれません。 この問題は、3ds Max でテクスチャ パスを相対パスにすることで解決されます。その方法は非常に簡単です。

1. メイン ツール バーで、 **[ファイル]**  >  **[参照]**  >  **[Asset Tracking Toggle]\(アセット追跡切り替え\)** に移動します。 

1. [Asset Tracking]\(アセット追跡\) ウィンドウでは、 **[Maps/Shaders]\(マップ/シェーダー\)** 列に、PBR マテリアルに適用されたすべてまたはほとんどのテクスチャが一覧表示されます。

1. その横の **[Full Path]\(完全なパス\)** 列に、テクスチャの場所のパス (最も一般的にはローカル コンピューター上の場所のパス) が表示されます。

1. 最後に、 **[状態]** という名前の列があります。 この列では、特定のテクスチャがシーンに配置されて適用されているかどうかが示されます。 テクスチャに次のいずれかの条件でフラグが設定されます: **[OK]** 、 **[Found]\(検出\)** 、または **[File Missing]\(ファイル不明\)** 。 最初の 2 つは、ファイルが見つかり、読み込まれたことを示しています。 最後は、トラッカーでファイルを見つけられなかったことを意味します。
 
   ![[Asset Tracking]\(アセット追跡\) ウィンドウを示すスクリーンショット。](media/3dsmax/texture-paths.jpg)

[Asset Tracking]\(アセット追跡\) ウィンドウを初めて開いたときは、一覧にすべてのテクスチャが表示されないことがあります。 心配する必要はありません。 通常、パス検出プロセスを 1、2 回実行すると、シーンのすべてのテクスチャが検出されます。 パス検索プロセスは次のとおりです。 

1. [Asset Tracking]\(アセット追跡\) ウィンドウで、 **[Maps/Shaders]\(マップ/シェーダー\)** リストの先頭のテクスチャを **Shift** キーを押しながら選択し、引き続き **Shift** キーを押したままリストの最後のテクスチャを選択します。 これにより、リスト内のすべてのテクスチャが選択されます。 選択したテクスチャは青で強調表示されます。 (前のスクリーンショットを参照)。

1. 選択内容を右クリックし、 **[Set Path]\(パスの設定\)** を選択します。

1. **[Specify Asset Path]\(アセット パスの指定\)** ボックスで、テクスチャへのローカル パスを選択し、それを `.\` に置き換えます。  **[OK]** を選択します。 

    次のスクリーンショットに示すように、[Asset Tracking]\(アセット追跡\) ウィンドウが更新されます。 シーン内のテクスチャの数とシーンの大きさによっては、この更新に時間がかかることがあります。
![更新された [Asset Tracking]\(アセット追跡\) ウィンドウを示すスクリーンショット。](media/3dsmax/resolve-textures.jpg)

**[Full Path]\(完全なパス\)** 列が空白になっていることに注意してください。 これは、シーンで特定の (絶対) 場所にある関連テクスチャを検索されなくなることを意味します。 .max ファイルまたは関連する FBX ファイルがテクスチャと同じフォルダーにある限り、常に検出されます。 

>[!NOTE]
>すべてのテクスチャとパスを検索して解決するために、このプロセスを数回繰り返すことが必要な場合があります。 心配する必要はありません。 関連するすべてのアセットが考慮されるまで、プロセスを繰り返すだけです。 場合によっては、一部のファイルが見つからないことがあります。 その場合は、リスト内のすべてのアセットを選択し、 **[Remove Missing Paths]\(見つからないパスを削除\)** を選択するだけです。 (前の画像を参照してください)。

## <a name="fbx-export"></a>FBX エクスポート

テクスチャ パスを相対的に作成したので、FBX エクスポートに進むことができます。 このプロセスも簡単で、いくつかの方法で実行できます。 

>[!TIP]
>シーン全体をエクスポートする場合を除き、必要なアセットのみのエクスポートを選択することをお勧めします。 リソースの多いシーンでは、エクスポートに時間がかかることがあります。
>
>Turbosmooth や Open SubDiv などの修飾子を使用している場合は、エクスポート中に問題が発生する可能性があるため、エクスポートの前にそれらを折りたたんでおくことをお勧めします。 折りたたむ前に、必ずシーンを保存してください。 

1. シーンで、エクスポートするアセットを選択します。 メイン ツール バーで、 **[ファイル]**  >  **[エクスポート]**  >  **[Export Selected]\(選択したものをエクスポート\)** に移動します。

1. **[Select File to Export]\(エクスポートするファイルの選択\)** ダイアログ ボックスで、出力ファイル名を入力または選択します。 **[Save as type]\(ファイルの種類\)** ボックスの一覧で、 **[Autodesk (*.fbx)]** を選択します。 これにより、FBX エクスポート ウィンドウが開きます。

  >[!IMPORTANT] 
  >シーンにインスタンスを作成してある場合は、FBX のエクスポート設定で **[Preserve Instances]\(インスタンスの保持\)** を選択することが重要です。 

  ![FBX にエクスポートする方法を示すスクリーンショット。](media/3dsmax/fbx-export.jpg)

  ファイルをエクスポートする方法はいくつかあることを忘れないでください。 FBX とそのテクスチャ ファイルをフォルダーまたはディレクトリで共有することが目的の場合は、次のスクリーンショットに示されている設定が適切に機能します。 

   テクスチャとその FBX の大きなフォルダーまたはディレクトリを共有したくない場合は、FBX にテクスチャを埋め込むことを選択できます。 テクスチャを埋め込むと、テクスチャを含むアセット全体が、1 つの FBX に追加されます。 そのようにすると、エクスポートは単一のアセットに結合されますが、結果として FBX ファイルがかなり大きくなります。

   >[!IMPORTANT]
   >結果の FBX ファイルが 2.4 GB を超える場合は、FBX のエクスポートの設定で最小バージョンとして 2016 以降を指定する必要があります。 (前のスクリーンショットを参照)。新しいバージョンでは 64 ビットがサポートされているため、より大きなファイルに対応します。

1. テクスチャが含まれるシーンをエクスポートする場合は、*FBX エクスポート ウィンドウで、 **[Embed Media]\(メディアを埋め込む\)** を選択します。 

1. 残りの設定を選択して、 **[OK]** を選択します。

    ![FBX のエクスポート設定を示すスクリーンショット。](media/3dsmax/fbx-settings.jpg)


   物理マテリアルを使用しているときに FBX にエクスポートすると、FBX エクスポート ウィンドウで **[OK]** を選択した後で、次の警告が表示されることがあります。 

   ![マテリアル エクスポート失敗の警告を示すスクリーンショット。](media/3dsmax/export-warnings.jpg)

   この警告は、エクスポートされたマテリアルが他のソフトウェア パッケージと互換性がない可能性があることを示します。 物理マテリアルは Azure Remote Rendering と互換性があるため、この警告について心配する必要はありません。 

1. **[OK]** を選択してプロセスを完了し、ウィンドウを閉じます。

## <a name="conclusion"></a>まとめ

一般に、この種の素材は、実際の光の物理特性をベースにしているため、より本物らしく見えます。 シーンが現実の世界に存在するかのように見せる追加の没入効果が得られます。

## <a name="next-steps"></a>次のステップ

ここまで、シーン内のオブジェクトに高度なライティングが施された素材を設定する方法を説明しました。 また、Azure Remote Rendering でサポートされている FBX 形式でオブジェクトをエクスポートする方法についても説明しました。 次の手順では、FBX ファイルを変換し、Azure Remote Rendering で視覚化します。

>[!div class="nextstepaction"]
>[クイック スタート: モデルをレンダリング用に変換する](../../quickstarts\convert-model.md)
