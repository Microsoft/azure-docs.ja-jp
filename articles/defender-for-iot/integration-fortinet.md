---
title: Fortinet の統合について
description: Defender for IoT と Fortinet は、IoT および ICS ネットワークに対する攻撃を検出して停止するためにテクノロジ パートナーシップを確立しました。
ms.date: 1/17/2021
ms.topic: article
ms.openlocfilehash: e2119a9e01a4e58cd9d2ca1b9b3384ec9629784c
ms.sourcegitcommit: f611b3f57027a21f7b229edf8a5b4f4c75f76331
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/22/2021
ms.locfileid: "104784018"
---
# <a name="defender-for-iot-and-fortinet-iiot-and-ics-threat-detection--prevention"></a>Defender for IoT と Fortinet の IIoT および ICS の脅威の検出と防止

Defender for IoT では、エージェント、ルールまたは署名、特殊なスキル、環境に関する事前の知識などに依存することなく、ICS デバイス、脆弱性、脅威に関する即時の分析情報を 1 時間以内に提供する、特許取得済みの ICS 対応の自己学習エンジンによって IIoT、ICS、SCADA のリスクを軽減します。

Defender for IoT と Fortinet は、IoT および ICS ネットワークに対する攻撃を検出して停止するためにテクノロジ パートナーシップを確立しました。

Fortinet と Defender for IoT は、連携して次のものを防止します。

- プログラマブル ロジック コントローラーへの承認されていない変更。

- ICS および IoT デバイスを自身のネイティブ プロトコル経由で操作するマルウェア。
- 偵察ツールによるデータの収集。
- 構成ミスや悪意のある攻撃者が原因で発生するプロトコル違反。

## <a name="defender-for-iot-and-fortigate-joint-solution"></a>Defender for IoT と FortiGate の共同ソリューション

Defender for IoT は、IoT および ICS ネットワーク内の異常な動作を検出し、その情報を FortiGate と FortiSIEM に次のように提供します。

- **可視性:** Defender for IoT によって提供される情報により、FortiSIEM 管理者は、以前には表示されなかった IoT および ICS ネットワークへの可視性を手に入れることができます。

- **悪意のある攻撃のブロック:** FortiGate 管理者は、Defender for IoT によって検出された情報を使用して、異常な動作の原因が大混乱したアクターまたは正しく構成されていないデバイスであるかどうかには関係なく、それによって運用、利益、またはユーザーに損害が発生する前に、それらの動作を停止するためのルールを作成できます。

## <a name="the-defender-for-iot-platform"></a>Defender for IoT プラットフォーム

Defender for IoT プラットフォームでは、対象となる攻撃やマルウェアを継続的に監視しながら、管理されていない IoT および ICS デバイスをすべて自動検出してそのフィンガープリントを作成します。 リスクおよび脆弱性管理機能には、自動化された脅威モデリングのほか、リスクによって優先順位付けされた軽減策に関する推奨事項を含む、エンドポイントとネットワークの両方の脆弱性に関する包括的なレポートが含まれます。  

Defender for IoT プラットフォームは、エージェントレスかつ非侵入型で、さらにデプロイも容易であり、ネットワークに接続されてから 1 時間以内にすぐに使用可能な分析情報を提供します。

## <a name="fortinet-fortisiem"></a>Fortinet FortiSIEM

効果的なセキュリティには、すべてのデバイスとすべてのインフラストラクチャの可視性がリアルタイムに、ただしコンテキストも伴った形で必要です。 どのようなデバイスが脅威を表し、複数のセキュリティ ツールによって生成されるノイズではなく、ビジネスが直面している脅威を管理するためのそれらの機能はどのようなものでしょうか。

エンドポイント、IoT、インフラストラクチャ、セキュリティ ツール、アプリケーション、VM、クラウドは、管理者がセキュリティで保護し、常に監視する必要がある対象の一部です。

FortiSIEM、Fortinet のマルチベンダー セキュリティ インシデント、イベント管理ソリューションによって、可視性、相関関係、自動応答、修復のすべてが 1 つのスケーラブルなソリューションでまとめて提供されます。

[ビジネス サービス] ビューを使用すると、ネットワークやセキュリティ運用を管理する複雑さが軽減され、リソースが解放され、さらに侵害検出機能が強化されます。 FortiSIEM は、侵害をその発生前に停止するために、相互相関を提供すると共に、機械学習や UEBA を適用して応答性を向上させています。

## <a name="fortinet-fortigate-next-generation-firewalls"></a>Fortinet FortiGate の次世代ファイアウォール

FortiGate の次世代ファイアウォール (NGFW) では、AI を活用した FortiGuard ラボの専用セキュリティ プロセッサおよび脅威インテリジェンス セキュリティ サービスを利用して、最高レベルの保護、クリア テキストの高パフォーマンスの検査、さらには暗号化されたトラフィックを提供します。

次世代ファイアウォールでは、アプリケーション、ユーザー、ネットワークへの完全な可視性によりコストと複雑さが削減されるため、最高レベルのセキュリティが提供されます。 Fortinet Security Fabric の不可欠な部分として、次世代ファイアウォールは、Fortinet の包括的なセキュリティ ポートフォリオおよびマルチベンダー環境のパートナー セキュリティ ソリューション内で通信して、脅威インテリジェンスを共有し、セキュリティ体制を強化することができます。

## <a name="use-cases"></a>ユース ケース

### <a name="prevent-unauthorized-changes-to-programmable-logic-controllers"></a>プログラマブル ロジック コントローラーへの承認されていない変更を防止する

組織は、プログラマブル ロジック コントローラー (PLC) を使用して、工場内のロボット アーム、風力発電所内の回転タービン、原子力発電所内の遠心分離機などの物理プロセスを管理します。

PLC のラダー ロジックまたはファームウェアへの更新は、正当なアクティビティである場合も、悪意のあるコードを挿入することによるデバイス侵害の試みである場合もあります。  Defender for IoT では、PLC への承認されていない変更を検出し、その変更に関する情報を FortiSIEM と FortiGate の両方に提供できます。 FortSIEM 管理者は、その情報を利用して、ソリューションを最適に軽減する方法を決定できます。 1 つの軽減オプションとして、影響を受けるデバイスへの以降の通信を停止する FortiGate 内のルールを作成する方法があります。

### <a name="stop-ransomware-before-it-damages-iot-and-ics-networks"></a>IoT および ICS ネットワークが被害を受ける前にランサムウェアを停止する

Defender for IoT では、LockerGoga、WannaCry、NotPetya などのランサムウェアによって発生する動作がないかどうか IoT および ICS ネットワークを継続的に監視します。 FortiSIEM および FortiGate と統合されている場合、Defender for IoT では、マルウェアが存在する場所を ForiSIEM オペレーターが確認できるように、これらの種類のランサムウェアの存在に関する情報を提供することができ、FortiGate 管理者はそのランサムウェアの拡散やそれ以上の大混乱の発生を防止できます。

## <a name="set-sending-defender-for-iot-alerts-to-fortisiem"></a>Defender for IoT アラートの FortiSIEM への送信を設定する

Defender for IoT アラートにより、次のような広範なセキュリティ イベントに関する情報が提供されます。

- 学習されたベースライン ネットワーク アクティビティからの逸脱
- マルウェアの検出
- 疑わしい運用上の変更に基づいた検出
- ネットワークの異常
- プロトコル仕様からのプロトコルの逸脱

:::image type="content" source="media/integration-fortinet/address-scan.png" alt-text="[検出されたアドレス スキャン] ウィンドウのスクリーンショット。":::

アラートを FortiSIEM サーバーに送信し、その [分析] ウィンドウにアラート情報が表示されるように Defender for IoT を構成できます。

:::image type="content" source="media/integration-fortinet/analytics.png" alt-text="[分析] ウィンドウのスクリーンショット。":::

各 Defender for IoT アラートは、FortiSIEM 側での他のどのような構成も必要とせずに解析され、FortiSIEM にセキュリティ イベントとして表示されます。 既定では、次のイベントの詳細が表示されます。

:::image type="content" source="media/integration-fortinet/event-detail.png" alt-text="[イベントの詳細] ウィンドウでイベントの詳細を表示する。":::

## <a name="define-alert-forwarding-rules"></a>アラートの転送ルールを定義する

アラート情報を FortiSIEM に送信するには、Defender for IoT の転送ルールを使用します。

次のものに基づいてアラート ルールをカスタマイズするオプションを使用できます。

- 特定のプロトコルの検出。

- エラーの重大度。

- イベントを検出する Defender for IoT エンジン。

転送ルールを作成するには

1. センサーまたはオンプレミス管理コンソールの左側のペインから、 **[転送]** を選択します。

    [:::image type="content" source="media/integration-fortinet/forwarding-view.png" alt-text="[転送] ウィンドウで転送ルールを表示する。":::](media/integration-fortinet/forwarding-view.png#lightbox)

2. **[転送ルールの作成]** を選択します。 **[転送ルールの作成]** ウィンドウで、ルールのパラメーターを定義します。

    :::image type="content" source="media/integration-fortinet/new-rule.png" alt-text="新しい転送ルールの作成ウィンドウ。":::

    | パラメーター | 説明 |
    |--|--|
    | **名前** | 転送ルールの名前。 |
    | **重大度の選択** | 転送する最小セキュリティ レベルのインシデント。 たとえば、 **[マイナー]** が選択されている場合は、マイナー アラートとこの重大度レベルを超えるすべてのアラートが転送されます。 |
    | **プロトコル** | 既定では、すべてのプロトコルが選択されます。<br><br>特定のプロトコルを選択するには、 **[Specific]\(特定\)** を選択し、このルールを適用するプロトコルを選択します。 |
    | **エンジン** | 既定では、すべてのセキュリティ エンジンが含まれます。<br><br>このルールを適用する特定のセキュリティ エンジンを選択するには、 **[Specific]\(特定\)** を選択して、エンジンを選択します。 |
    | **システム通知** | センサーのオンラインまたはオフラインの状態を転送します。 このオプションは、オンプレミス管理コンソールにログインしている場合にのみ使用できます。 |

3. Defender for IoT にアラート情報を FortiSIEM に送信するよう指示するには、 **[アクション]** を選択してから **[FortiSIEM への送信]** を選択します。

    :::image type="content" source="media/integration-fortinet/forward-rule.png" alt-text="転送ルールを作成し、Fortinet への送信を選択する。":::

4. FortiSIEM サーバーの詳細を入力します。

    :::image type="content" source="media/integration-fortinet/details.png" alt-text="FortiSIEm の詳細を転送ルールに追加する":::

    | パラメーター | 説明 |
    | --------- | ----------- |
    | **Host** | FortiSIEM サーバーのアドレス。 |
    | **[ポート]** | FortiSIEM サーバーのポート。 |
    | **タイム ゾーン** | アラート検出のタイム スタンプ。 |

5. **[Submit]\(送信\)** をクリックします。

## <a name="set-blocking-suspected-traffic-using-fortigate-firewall"></a>Fortigate ファイアウォールを使用して疑わしいトラフィックのブロックを設定する

Defender for IoT アラートに基づいて、FortiGate ファイアウォールでブロック ポリシーを自動的に設定できます。

:::image type="content" source="media/integration-fortinet/firewall.png" alt-text="[FortiGate ファイアウォール] ウィンドウのビュー。":::

たとえば、次のアラートで悪意のあるソースをブロックできます。

:::image type="content" source="media/integration-fortinet/suspicion.png" alt-text="NotPetya マルウェアの疑いを示すウィンドウ":::

この悪意のあるソースをブロックする FortiGate ファイアウォール規則を設定するには、次の手順を実行します。

1. FortiGate で、Defender for IoT の転送ルールに必要な API キーを作成します。 詳細については、「[FortiGate で API キーを作成する](#create-an-api-key-in-fortigate)」を参照してください。

1. Defender for IoT の **[転送]** で、マルウェア関連のアラートをブロックする転送ルールを設定します。 詳細については、「[FortiGate ファイアウォールを使用して疑わしいトラフィックをブロックする](#block-suspected-traffic-using-the-fortigate-firewall)」を参照してください。

1. Defender for IoT では、 **[アラート]** によって悪意のあるソースがブロックされます。 詳細については、「[疑わしいソースをブロックする](#block-the-suspicious-source)」を参照してください。

    悪意のあるソース アドレスは、FortiGage の **[管理者]** ウィンドウに表示されます。

   :::image type="content" source="media/integration-fortinet/administrator.png" alt-text="FortiGate の [管理者] ウィンドウのビュー。":::

   ブロック ポリシーが自動的に作成され、FortiGate の **[IPv4 ポリシー]** ウィンドウに表示されています。

   :::image type="content" source="media/integration-fortinet/policy.png" alt-text="FortiGate の [IPv4 ポリシー] ウィンドウのビュー。":::

   :::image type="content" source="media/integration-fortinet/edit.png" alt-text="FortiGate の [IPv4 ポリシーの編集] のビュー。":::

## <a name="create-an-api-key-in-fortigate"></a>FortiGate で API キーを作成する

1. FortiGate で、 **[システム]**  >  **[管理者プロファイル]** の順に選択します。

1. 次のアクセス許可を持つプロファイルを作成します。

    :::image type="content" source="media/integration-fortinet/admin-profile.png" alt-text="自動的に生成されたコンピューターの説明":::

1. **[システム]**  >  **[管理者]** の順に選択し、新しい **REST API 管理者** を作成します。

    :::image type="content" source="media/integration-fortinet/cellphone.png" alt-text="自動的に生成された携帯電話の説明":::

    | パラメーター | 説明 |
    | --------- | ----------- |
    | **ユーザー名** | 転送ルール名。 |
    | **コメント** | 転送する最小セキュリティ レベルのインシデント。 たとえば、[マイナー] が選択されている場合は、マイナー アラートとこの重大度レベルを超えるすべてのアラートが転送されます。 |
    | **管理者プロファイル** | ドロップダウン リストから、前の手順で定義したプロファイル名を選択します。 |
    | **PKI グループ** | 無効。 |
    | **CORS での配信元の許可** | [Enable]\(有効にする\)。 |
    | **ログインを信頼されたホストに制限する** | FortiGate に接続するセンサーと CM の IP アドレス追加します。 |

1. API キーを保存します。

    :::image type="content" source="media/integration-fortinet/api-key.png" alt-text="携帯電話の説明によって新しい API キーが自動的に生成される":::

## <a name="block-suspected-traffic-using-the-fortigate-firewall"></a>FortiGate ファイアウォールを使用して疑わしいトラフィックをブロックする

1. 左側のウィンドウで、 **[転送]** を選択します。

    [:::image type="content" source="media/integration-fortinet/forwarding-view.png" alt-text="センサーでの [転送] ウィンドウのオプション。":::](media/integration-fortinet/forwarding-view.png#lightbox)

1. **[転送ルールの作成]** を選択し、ルールのパラメーターを定義します。

    :::image type="content" source="media/integration-fortinet/new-rule.png" alt-text="[転送ルールの作成] ウィンドウのスクリーンショット":::

    | パラメーター | 説明 |
    | --------- | ----------- |
    | **名前** | 転送ルールの名前。 |
    | **重大度の選択** | 転送する最小セキュリティ レベルのインシデント。 たとえば、 **[マイナー]** が選択されている場合は、マイナー アラートとこの重大度レベルを超えるすべてのアラートが転送されます。 |
    | **プロトコル** | 既定では、すべてのプロトコルが選択されます。<br><br>特定のプロトコルを選択するには、 **[Specific]\(特定\)** を選択し、このルールを適用するプロトコルを選択します。 |
    | **エンジン** | 既定では、すべてのセキュリティ エンジンが含まれます。<br><br>このルールを適用する特定のセキュリティ エンジンを選択するには、 **[Specific]\(特定\)** を選択して、エンジンを選択します。 |
    | **システム通知** | センサーの "*オンラインとオフライン*" の状態を転送します。 このオプションは、オンプレミス管理コンソールにログインしている場合にのみ使用できます。 |

1. Defender for IoT にファイアウォール規則を FortiGate に送信するよう指示するには、 **[アクション]** を選択してから **[FortiGate への送信]** を選択します。

    :::image type="content" source="media/integration-fortinet/fortigate.png" alt-text="転送ルールを作成し、FortiGate への送信を選択する":::

1. FortiGate の転送ルールを構成するには、次のようにします。

    :::image type="content" source="media/integration-fortinet/configure.png" alt-text="[転送ルールの作成] ウィンドウを構成する":::

1. **[アクション]** ペインで、次のパラメーターを設定します。

    | パラメーター | 説明 |
    |--|--|
    | Host | FortiGate サーバーの IP アドレスの種類。 |
    | ポート | FortiGate サーバーのポートの種類。 |
    | Username | FortiGate サーバーのユーザー名の種類。 |
    | API キー | FortiGate で作成した API キーを入力します。 |
    | 受信インターフェイス| ブロックを実行する方法を定義します。<br /><br />**[IP アドレスごと]** :常に IP アドレスに基づいて Panorama 上にブロック ポリシーを作成します。<br /><br />**[FQDN または IP アドレスごと]** :FQDN が存在する場合は FQDN に基づいて、それ以外の場合は IP アドレスに基づいて Panorama 上にブロック ポリシーを作成します。| 
    | 送信インターフェイス |ポリシー通知電子メールのメール アドレスを設定します。 <br /><br /> **注**:XSense でメール サーバーを構成していることを確認してください。 メール アドレスが入力されていない場合は、XSense によって通知電子メールが送信されません。| 
    |構成| FortiGate ファイアウォールによる疑わしいソースのブロックを許可するには、次のオプションを設定します。 <br /><br />**[無効な関数コードをブロックする]** :プロトコル違反 - ICS プロトコル仕様に違反している無効なフィールド値 (潜在的な悪用)<br /><br />**承認されていない PLC プログラミング/ファームウェアの更新をブロックする**: 承認されていない PLC の変更<br /><br />**[承認されていない PLC 停止をブロックする]** :PLC の停止 (ダウンタイム)<br /><br />**[マルウェア関連のアラートをブロックする]** :産業用マルウェアの試みのブロック (TRITON、NotPetya など)。 **[自動ブロック]** のオプションを選択できます。 その場合、ブロックは直ちに自動的に実行されます。<br /><br />*承認されていないスキャンをブロックする*: 承認されていないスキャン (潜在的な偵察)

1. **[Submit]\(送信\)** をクリックします。

## <a name="block-the-suspicious-source"></a>疑わしいソースをブロックする

1. **[アラート]** ペインで、Fortinet の統合に関連したアラートを選択します。

    :::image type="content" source="media/integration-fortinet/unauthorized.png" alt-text="[承認されていない PLC プログラミング] ウィンドウ":::

1. 疑わしいソースを自動的にブロックするには、 **[ソースのブロック]** を選択します。

    :::image type="content" source="media/integration-fortinet/confirm.png" alt-text="確認ウィンドウ。":::

1. **[確認してください]** ダイアログ ボックスで、 **[OK]** を選択します。

## <a name="next-steps"></a>次の手順

[アラート情報を転送する](how-to-forward-alert-information-to-partners.md)方法を学習します。
