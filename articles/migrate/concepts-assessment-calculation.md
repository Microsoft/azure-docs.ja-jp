---
title: Azure Migrate のアセスメントの計算 | Microsoft Docs
description: Azure Migrate サービスにおけるアセスメントの計算の概要を説明します。
author: rayne-wiselman
ms.service: azure-migrate
ms.topic: conceptual
ms.date: 07/15/2019
ms.author: raynew
ms.openlocfilehash: 87aa48c992b7887ce86c43cac29910dcc57b3e91
ms.sourcegitcommit: b2db98f55785ff920140f117bfc01f1177c7f7e2
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/16/2019
ms.locfileid: "68234286"
---
# <a name="assessment-calculations"></a>評価の計算

[Azure Migrate](migrate-services-overview.md) は、オンプレミスのアプリとワークロード、およびプライベート/パブリック クラウド インスタンスの検出、評価、および Azure への移行を追跡するための中央ハブとなります。 このハブには、評価と移行のための Azure Migrate ツールのほか、サードパーティの独立系ソフトウェア ベンダー (ISV) のオファリングが用意されています。

Server Assessment は、Azure への移行についてオンプレミス サーバーを評価する Azure Migrate のツールです。 この記事では、アセスメントの計算方法について説明します。

## <a name="whats-in-an-assessment"></a>評価の内容

**プロパティ** | **詳細**
--- | ---
**ターゲットの場所** | Azure 上の移行先となる場所。<br/> Server Assessment で現在サポートされているターゲット リージョンは次のとおりです。オーストラリア東部、オーストラリア南東部、ブラジル南部、カナダ中部、カナダ東部、インド中部、米国中部、中国東部、中国北部、東アジア、米国東部、米国東部 2、ドイツ中部、ドイツ北東部、東日本、西日本、韓国中部、韓国南部、米国中北部、北ヨーロッパ、米国中南部、東南アジア、インド南部、英国南部、英国西部、US Gov アリゾナ、US Gov テキサス、US Gov バージニア、米国中西部、西ヨーロッパ、インド西部、米国西部、米国西部 2。
**ストレージの種類** | このプロパティを使用して、Azure での移行先のディスクの種類を指定できます。 <br/><br/> オンプレミスに合わせたサイズ設定の場合は、ターゲットのストレージの種類として、Premium マネージド ディスク、Standard SSD マネージド ディスク、Standard HDD マネージド ディスクのいずれかを指定できます。 パフォーマンス ベースのサイズ設定の場合は、ターゲットのディスクの種類として、Automatic、Premium マネージド ディスク、Standard HDD マネージド ディスク、Standard SSD マネージド ディスクのいずれかを指定できます。<br/><br/> ストレージの種類を Automatic として指定すると、ディスクのパフォーマンス データ (IOPS とスループット) に基づいてディスクに関する推奨事項が実行されます。 ストレージの種類に Premium/Standard を指定すると、選択したストレージの種類におけるディスク SKU が評価で推奨されます。 99.9% の単一インスタンス VM SLA を達成したい場合は、ストレージの種類に Premium マネージド ディスクを指定できます。 これにより、評価に含まれるすべてのディスクが Premium マネージド ディスクとして推奨されるようになります。 Azure Migrate の移行評価では、マネージド ディスクのみがサポートされます。
**予約済みインスタンス (RI)** | このプロパティでは、Azure に[予約済みインスタンス](https://azure.microsoft.com/pricing/reserved-vm-instances/)があるかどうかを指定し、評価のコスト見積もりで RI 割引が考慮されるようにするのに役立ちます。 予約インスタンスは、現在、Azure Migrate では従量課金制についてのみサポートされています。
**サイズ変更の設定基準** | VM を Azure に適したサイズにするために使用される基準。 "*パフォーマンスベース*" でサイズ設定するか、またはパフォーマンス履歴を考慮せずに "*オンプレミスに合わせて*" VM のサイズを設定できます。
**パフォーマンス履歴** | マシンのパフォーマンス データを評価するために考慮する期間。 このプロパティは、サイズ設定の基準が "*パフォーマンス ベース*" の場合にのみ適用されます。
**百分位数の使用率** | 適切なサイズ設定のために考慮するパフォーマンス サンプル セットのパーセンタイル値。 このプロパティは、サイズ設定が "*パフォーマンスベース*" の場合にのみ適用されます。
**VM シリーズ** |     適切なサイズ変更を検討する VM シリーズを指定できます。 たとえば、Azure で A シリーズ VM に移行する予定がない運用環境がある場合は、リストまたはシリーズから A シリーズを除外することができるため、選択したシリーズでのみ、適切なサイズ変更が実行されます。
**快適性係数** | Azure Migrate Server Assessment では、評価時にバッファー (快適性係数) が考慮されます。 VM のマシン使用率データ (CPU、メモリ、ディスク、ネットワーク) に加えて、このバッファーが適用されます。 快適性係数は、季節ごとの使用量、短期間のパフォーマンス履歴、将来に使用量が増える可能性などの問題に相当します。<br/><br/> たとえば、使用率 20% の 10 コア VM の結果は、通常 2 コア VM になります。 一方、快適性係数を 2.0x とした場合は、結果が 4 コア VM になります。
**プラン** | 登録されている [Azure プラン](https://azure.microsoft.com/support/legal/offer-details/)。 Azure Migrate はそれに応じてコストを見積もります。
**通貨** | 請求通貨です。
**割引率 (%)** | Azure オファーに適用される任意のサブスクリプション固有の割引です。<br/> 既定の設定は 0% です。
**VM のアップタイム** | VM が Azure 上で 24 時間 365 日稼働する予定ではない場合は、Azure 上で稼働する期間 (1 か月あたりの日数と 1 日あたりの時間数) を指定できます。それに応じてコストの見積もりが行われます。<br/> 既定値は、1 か月あたり 31 日、1 日あたり 24 時間です。
**Azure ハイブリッド特典** | ソフトウェア アシュアランスがあり、かつ [Azure ハイブリッド特典](https://azure.microsoft.com/pricing/hybrid-use-benefit/)を受ける資格があるかどうかを指定します。 [はい] に設定すると、Windows VM に Windows Azure 以外の価格は考慮されません。 既定値は Yes です。

## <a name="how-are-assessments-calculated"></a>評価の計算方法

Azure Migrate Server Assessment では、オンプレミス サーバーについて収集されたメタデータを使って評価が計算されます。 評価計算は 3 段階で行われます。つまり、サーバーごとに、最初に Azure 適合性分析、次にサイズ設定、最後に月間コスト見積もりが行われます。 前の段階で合格したサーバーだけが次の段階に進みます。 たとえば、Azure 適合性分析に合格しなかったサーバーは、Azure に不適合とマークされ、サイズ設定とコスト計算は行われません。

## <a name="azure-suitability-analysis"></a>Azure 適合性分析

すべてのマシンが Azure での実行に適しているとはかぎりません。 Azure Migrate Server Assessment は、オンプレミス マシンの Azure への移行適合性を評価し、評価したマシンを次の適合性カテゴリのいずれかに分類します。
- **[Ready for Azure]\(Azure に対応\)** - マシンをそのまま変更せずに Azure に移行できます。 Azure で起動し、Azure のフル サポートを受けます。
- **[Conditionally ready for Azure]\(条件付きで Azure に対応\)** - マシンは Azure で起動できますが、Azure のフル サポートを受けられない可能性があります。 たとえば、Windows Server OS の以前のバージョンのマシンは Azure ではサポートされません。 このようなマシンを Azure に移行する前には注意が必要です。アセスメントで示された修復ガイダンスに従い、対応に関する問題を修正してから移行します。
- **[Azure に未対応]** - マシンは Azure で起動しません。 たとえば、オンプレミス マシンに接続されているディスクのサイズが 64 TB を超える場合は、Azure でホストできません。 アセスメントで示された修復ガイダンスに従い、対応に関する問題を修正してから Azure に移行します。 [Azure に未対応] と分類されたマシンのサイズ調整とコスト見積もりは行われません。
- **[Readiness 不明]** - オンプレミス環境から収集したメタデータが不十分なために、Azure Migrate がマシンの対応性を確認できませんでした。

Azure Migrate Server Assessment は、マシンのプロパティとゲスト オペレーティング システムを調べて、オンプレミス マシンの Azure 対応性を確認します。

### <a name="machine-properties"></a>マシンのプロパティ

Server Assessment は、オンプレミス VM の次のプロパティを調べて、Azure で実行できるかどうかを確認します。

**プロパティ** | **詳細** | **Azure 対応性の状態**
--- | --- | ---
**ブートの種類** | Azure は、ブートの種類が UEFI ではなく BIOS として VM をサポートします。 | ブートの種類が UEFI の場合は条件付きで対応します。
**コア** | マシンのコア数は、Azure VM でサポートされている最大コア数 (128) 以下である必要があります。<br/><br/> パフォーマンス履歴が使用可能な場合、Azure Migrate では、使用されているコアの数が比較で考慮されます。 アセスメント設定で快適性係数が指定されている場合、使用されているコアの数に快適性係数が乗算されます。<br/><br/> パフォーマンス履歴がない場合は、快適性係数を適用せずに、割り当てられているコアの数が使用されます。 | 制限以下の場合は対応します。
**メモリ** | マシンのメモリ サイズは、Azure VM で許容される最大メモリ (Azure M シリーズ Standard_M128m&nbsp;<sup>2</sup> で 3892 GB) 以下である必要があります。 [詳細情報](https://docs.microsoft.com/azure/virtual-machines/windows/sizes)。<br/><br/> パフォーマンス履歴が使用可能な場合、Azure Migrate では、使用されているメモリが比較で考慮されます。 快適性係数が指定されている場合、使用されているメモリに快適性係数が乗算されます。<br/><br/> 履歴がない場合は、快適性係数を適用せずに、割り当てられているメモリが使用されます。<br/><br/> | 制限内であれば対応します。
**ストレージ ディスク** | ディスクの割り当てサイズは、32 TB 以下である必要があります。<br/><br/> マシンに接続されているディスクの数は、OS ディスクを含めて 65 個以下である必要があります。 | 制限内であれば対応します。
**ネットワーク** | マシンに接続されている NIC の数は、32 個以下である必要があります。 | 制限内であれば対応します。

### <a name="guest-operating-system"></a>ゲスト オペレーティング システム
Azure Migrate Server Assessment は、VM のプロパティとともに、マシンのゲスト オペレーティング システムを調べて Azure で実行できるかどうかを確認します。

> [!NOTE]
> VMware VM の場合、Azure Migrate Server Assessment は、vCenter Server で VM に指定されているオペレーティング システムを使ってゲスト OS 分析を行います。 VMware で実行されている Linux VM については、現在のところゲスト OS の正確なカーネル バージョンが識別されません。

Azure Migrate Server Assessment でオペレーティング システムに基づいて VM の Azure 対応性が確認されるときには、次のロジックが使用されます。

**オペレーティング システム** | **詳細** | **Azure 対応性の状態**
--- | --- | ---
Windows Server 2016 および全 SP | Azure は完全サポートを提供します。 | Azure に対応
Windows Server 2012 R2 および全 SP | Azure は完全サポートを提供します。 | Azure に対応
Windows Server 2012 および全 SP | Azure は完全サポートを提供します。 | Azure に対応
Windows Server 2008 R2 および全 SP | Azure は完全サポートを提供します。| Azure に対応
Windows Server 2008 (32 ビットおよび 64 ビット) | Azure は完全サポートを提供します。 | Azure に対応
Windows Server 2003、2003 R2 | これらのオペレーティング システムはサポート終了日が過ぎているため、Azure でのサポートには[カスタム サポート契約 (CSA)](https://aka.ms/WSosstatement) が必要です。 | Azure 条件付きで対応。Azure に移行する前に OS のアップグレードを検討してください。
Windows 2000、98、95、NT、3.1、MS-DOS | これらのオペレーティング システムはサポート終了日が過ぎています。マシンは Azure で起動できますが、Azure による OS のサポートは提供されません。 | Azure に条件付きで対応。Azure に移行する前に OS のアップグレードをお勧めします。
Windows Client 7、8、10 | Azure は、[Visual Studio サブスクリプション](https://docs.microsoft.com/azure/virtual-machines/windows/client-images)にのみサポートを提供します。 | Azure に条件付きで対応
Windows 10 Pro デスクトップ | Azure は、[マルチ テナント ホスティング権限](https://docs.microsoft.com/azure/virtual-machines/windows/windows-desktop-multitenant-hosting-deployment)にサポートを提供します。 | Azure に条件付きで対応
Windows Vista、XP Professional | これらのオペレーティング システムはサポート終了日が過ぎています。マシンは Azure で起動できますが、Azure による OS のサポートは提供されません。 | Azure に条件付きで対応。Azure に移行する前に OS のアップグレードをお勧めします。
Linux | Azure はこれらの [Linux オペレーティング システム](../virtual-machines/linux/endorsed-distros.md)をサポートしています。 他の Linux オペレーティング システムは Azure で起動できますが、Azure へ移行する前に、サポートされるバージョンへの OS のアップグレードをお勧めします。 | Azure に対応 (バージョンがサポートされている場合)。<br/><br/>条件付きで対応 (バージョンがサポートされていない場合)。
他のオペレーティング システム<br/><br/> 例: Oracle Solaris、Apple Mac OS、FreeBSD など | Azure では、これらのオペレーティング システムはサポートされません。 マシンは Azure で起動できますが、Azure による OS サポートは提供されません。 | Azure に条件付きで対応。Azure に移行する前にサポート対象の OS のインストールをお勧めします。  
vCenter Server で **[Other]\(その他\)** と指定された OS | この場合、Azure Migrate は OS を識別できません。 | 対応不明。 VM で実行している OS が Azure でサポートされることを確認します。
32 ビット オペレーティング システム | マシンは Azure で起動できますが、Azure がフル サポートを提供しない可能性があります。 | 条件付きで Azure に対応。Azure に移行する前に、マシンの OS を 32 ビット OS から 64 ビット OS にアップグレードすることをご検討ください。

## <a name="sizing"></a>サイズ変更

マシンが Azure に対応することが確認されると、Server Assessment はサイズ設定を実行して、オンプレミス VM に対応する適切な Azure VM とディスク SKU を特定します。 推奨サイズは、指定した評価プロパティによって異なります。

- 評価で "*パフォーマンス ベースのサイズ設定*" が使用された場合、Azure Migrate はマシンのパフォーマンス履歴を考慮して Azure での VM サイズとディスクの種類を特定します。 この方法は、オンプレミス VM を割り当て過ぎて使用率が低下した場合に、Azure で VM のサイズを適切に設定してコストを削減したい場合に特に役立ちます。 この方法では、移行中にサイズを最適化することができます。
- VM のサイズ設定でパフォーマンス データを考慮せずにオンプレミス マシンをそのまま Azure に移行する場合は、サイズ変更の設定基準に "*オンプレミス*" を指定すると、Server Assessment が使用状況データを考慮せずにオンプレミス構成に基づいて VM をサイズ設定します。 この場合は、評価プロパティで指定したストレージの種類 (Standard HDD ディスク、Standard SSD ディスク、または Premium ディスク) に基づいて、ディスクのサイズ設定が行われます。

### <a name="performance-based-sizing"></a>パフォーマンス ベースのサイズ設定

パフォーマンス ベースのサイズ設定では、Azure Migrate Server Assessment は、最初に VM に接続されているディスク、次にネットワーク アダプターの順に処理を行い、その後オンプレミス VM のコンピューティング要件に基づいて Azure VM SKU をマップします。 Azure Migrate アプライアンスは、オンプレミス環境をプロファイルして、CPU、メモリ、ディスク、およびネットワーク アダプターのパフォーマンス データを収集します。

**パフォーマンス データの収集**

- VMware VM の場合は、Azure Migrate アプライアンスが 20 秒ごとにリアルタイムのサンプル ポイントを収集します。Hyper-V VM の場合は、30 秒ごとにリアルタイムのサンプル ポイントが収集されます。
- 次にアプライアンスは、収集したサンプル ポイントを 10 分ごとにロール アップし、過去 10 分間の最大値を Azure Migrate Server Assessment に送信します。
- Azure Migrate Server Assessment は、過去 1 か月間の 10 分のサンプル ポイントをすべて保管し、 *[パフォーマンス履歴]* と *[百分位の使用率]* に指定された評価プロパティに応じて、正しいサイズ設定に使用する適切なデータ ポイントを特定します。 たとえば、パフォーマンス履歴を 1 日に、百分位の使用率を 95 番目に設定した場合は、過去 1 日間の 10 分のサンプル ポイントが昇順で並べ替えられ、正しいサイズ設定のために 95 番目の百分位値が選択されます。
- 上記の値に快適性係数が乗算されて、アプライアンスが収集する各メトリック (CPU 使用率、メモリ使用率、ディスク IOPS (読み取りと書き込み)、ディスク スループット (読み取りと書き込み)、ネットワーク スループット (インとアウト)) の有効なパフォーマンス使用率データが得られます。
- 有効な使用率値が特定されると、次のようにしてコンピューティング、ストレージ、およびネットワークのサイズ設定が行われます。

**ストレージのサイズ設定**:Azure Migrate は、マシンに接続されているすべてのディスクを Azure のディスクにマップしようとします。

> [!NOTE]
> Azure Migrate:Server Assessment では、マネージド ディスクのみが評価対象としてサポートされます。

  - ディスクの読み取りと書き込みの IOPS を加算することで必要な合計 IOPS が得られ、同様に読み取りと書き込みのスループット値を加算することで各ディスクの合計スループットが得られます。
  - ストレージの種類に [Automatic] を指定した場合は、有効な IOPS とスループットの値を基に、Azure Migrate Server Assessment が、Azure で Standard HDD、Standard SSD、Premium ディスクのどれにディスクをマップすべきかを特定します。 ストレージの種類を Standard HDD/SSD/Premium に設定した場合は、選択したストレージの種類 (Standard HDD/SSD/Premium ディスク) におけるディスク SKU の検出が試行されます。
  - Server Assessment で必要な IOPS とスループットのディスクが見つからなかった場合は、そのマシンが Azure に不適合とマークされます。
  - 適合する一連のディスクが見つかった場合は、評価の設定で指定されている場所に対応したディスクが選択されます。
  - 対象となるディスクが複数ある場合は、最も低コストのディスクが選択されます。
  - どのディスクのパフォーマンス データも得られない場合は、ディスクの構成データ (ディスク サイズ) を使用して Azure で Standard SSD ディスクが検索されます。

**ネットワークのサイズ設定**:Azure Migrate Server Assessment は、オンプレミス マシンに接続されたネットワーク アダプターの数およびそれらのネットワーク アダプターが必要とするパフォーマンスに対応できる Azure VM を見つけようとします。
    - オンプレミス VM の有効なネットワーク パフォーマンスを取得するために、Server Assessment は、すべてのネットワーク アダプターについてマシンから送信される 1 秒あたりのデータ容量 (MBps) (ネットワーク出力) を集計し、快適性係数を適用します。 この数値は、必要なネットワーク パフォーマンスをサポートできる Azure VM を見つけるために使用されます。
    - ネットワーク パフォーマンスと共に、Azure VM が必要なネットワーク アダプター数をサポートできるかどうかも考慮されます。
    - ネットワーク パフォーマンス データが使用できない場合は、VM のサイズ設定でネットワーク アダプター数だけが考慮されます。

**コンピューティングのサイズ設定**:ストレージとネットワークの要件が計算されたら、Azure Migrate Server Assessment は CPU とメモリの要件を考慮して Azure での適切な VM サイズを求めます。
    - Azure Migrate は、有効な使用コア数とメモリを確認して、Azure での適切な VM サイズを割り出します。
    - 適切なサイズが見つからない場合、そのマシンは Azure に不適合とマークされます。
    - 適切なサイズが見つかった場合は、ストレージとネットワークの計算が適用されます。 その後、場所と価格レベルの設定が適用され、VM サイズの最終的な推奨事項が作成されます。
    - 条件を満たす Azure VM サイズが複数ある場合、最も低コストのディスクをお勧めします。

### <a name="as-on-premises-sizing"></a>オンプレミスのサイズ設定

"*オンプレミスに合わせたサイズ設定*" を使用する場合、Server Assessment は VM とディスク のパフォーマンス履歴を考慮せず、オンプレミスで割り当てられているサイズに基づいて Azure で VM SKU を割り当てます。 同様にディスクのサイズ設定でも、評価プロパティで指定したストレージの種類 (Standard HDD/SSD/Premium) が確認され、それに応じてディスクの種類が推奨されます。 既定のストレージの種類は Premium ディスクです。

## <a name="confidence-ratings"></a>信頼度レーティング
Azure Migrate のパフォーマンス ベースの評価には、それぞれ 1 つ星 (最低) から 5 つ星 (最高) までの範囲の信頼度レーティングが関連付けられます。
- 信頼度レーティングは、評価の計算に必要なデータ ポイントの可用性に基づいて、評価に割り当てられます。
- 評価の信頼度レーティングは、Azure Migrate による推奨サイズの信頼性を判断する目安となります。
- 信頼度レーティングは、オンプレミスの評価には適用されません。
- パフォーマンス ベースのサイズ設定では、Azure Migrate Server Assessment が以下を必要とします。
    - CPU と VM メモリの使用率データ。
    - さらに、VM に接続されている各ディスクについて、ディスクの IOPS とスループットのデータが必要です。
    - パフォーマンス ベースのサイズ設定を行うには、VM に接続されている各ネットワーク アダプターについても、信頼度レーティングにネットワーク入出力が必要となります。
    - 上記の使用率の数値のいずれかが vCenter Server で得られない場合は、推奨サイズの信頼性が損なわれる可能性があります。

次のように、使用可能なデータ ポイントの割合に応じて、評価の信頼度レーティングが決まります。

   **データ ポイントの可用性** | **信頼度レーティング**
   --- | ---
   0% - 20% | 1 つ星
   21% - 40% | 2 つ星
   41% - 60% | 3 つ星
   61% - 80% | 4 つ星
   81% - 100% | 5 つ星

### <a name="low-confidence-ratings"></a>信頼度レーティングが低い

次のようないくつかの理由で、評価の信頼度レーティングが低くなることがあります。

- 評価を作成する期間について環境をプロファイルしなかった。 たとえば、パフォーマンス期間を 1 日に設定して評価を作成する場合は、すべてのデータ ポイントを収集するために、検出を開始してから少なくとも 1 日待つ必要があります。
- 評価の計算対象である期間中に、いくつかの VM がシャットダウンされた。 いずれかの VM で電源がオフになっていた期間がある場合、Azure Migrate Server Assessment はその期間のパフォーマンス データを収集できません。
- 評価の計算対象である期間中に、いくつかの VM が作成された。 たとえば、前月のパフォーマンス履歴で評価を作成する場合に、ほんの 1 週間前にその環境で VM が作成されていると、その新しい VM のパフォーマンス履歴は全期間にわたって存在しないことになります。

> [!NOTE]
> 評価の信頼度レーティングが 5 つ星を下回る場合は、アプライアンスが環境をプロファイルできるように少なくとも 1 日待ってから、評価を再計算することをお勧めします。 これを行わない場合は、パフォーマンス ベースのサイズ設定が信頼できなくなることがあるため、評価で使用するサイズ設定をオンプレミスに切り替えることをお勧めします。

## <a name="monthly-cost-estimation"></a>月間コスト見積もり

推奨サイズの設定が完了すると、Azure Migrate は移行後のコンピューティング コストとストレージ コストを計算します。

- **コンピューティング コスト**:Azure Migrate は、Billing API を使用して、推奨される Azure VM サイズで VM の月間コストを計算します。
    - この計算では、オペレーティング システム、ソフトウェア アシュアランス、予約インスタンス、VM のアップタイム、場所、および通貨の設定が考慮されます。
    - すべてのマシンのコストが集計され、月間コンピューティング コストの合計が計算されます。
- **ストレージ コスト**:マシンの月間ストレージ コストは、マシンに接続されているすべてのディスクの月間コストを集計して計算されます。
    - Azure Migrate Server Assessment は、すべてのマシンのストレージ コストを集計して、月間ストレージ コストの合計を計算します。
    - 現在、この計算では、アセスメント設定で指定されたプランは考慮されません。

コストは、アセスメント設定で指定された通貨で表示されます。


## <a name="next-steps"></a>次の手順

[VMware VM](tutorial-assess-vmware.md) または [Hyper-V VM](tutorial-assess-hyper-v.md) の評価を作成します。
