---
title: Azure Migrate のアセスメントの計算 | Microsoft Docs
description: Azure Migrate サービスにおけるアセスメントの計算の概要を説明します。
author: rayne-wiselman
ms.service: azure-migrate
ms.topic: conceptual
ms.date: 08/06/2019
ms.author: raynew
ms.openlocfilehash: 4511c42514a5399d41029b61297bd4c1b0b63d9a
ms.sourcegitcommit: 3073581d81253558f89ef560ffdf71db7e0b592b
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/06/2019
ms.locfileid: "68827554"
---
# <a name="assessment-calculations-in-azure-migrate"></a>Azure Migrate のアセスメントの計算

[Azure Migrate](migrate-services-overview.md) では、オンプレミスのアプリとワークロードの検出、評価、および移行を追跡するための中央ハブが提供されます。 また、Azure までプライベート クラウドとパブリック クラウドのインスタンスを追跡します。 このハブには、評価および移行のための Azure Migrate ツールのほか、サードパーティの独立系ソフトウェア ベンダー (ISV) のオファリングが用意されています。

Server Assessment は、Azure への移行についてオンプレミス サーバーを評価する Azure Migrate のツールです。 この記事では、アセスメントの計算方法について説明します。

## <a name="whats-in-an-assessment"></a>評価の内容

**プロパティ** | **詳細**
--- | ---
**ターゲットの場所** | Azure 上の移行先となる場所を指定します。<br/><br/>Server Assessment で現在サポートされているターゲット リージョンは次のとおりです。オーストラリア東部、オーストラリア南東部、ブラジル南部、カナダ中部、カナダ東部、インド中部、米国中部、中国東部、中国北部、東アジア、米国東部、米国東部 2、ドイツ中部、ドイツ北東部、東日本、西日本、韓国中部、韓国南部、米国中北部、北ヨーロッパ、米国中南部、東南アジア、インド南部、英国南部、英国西部、US Gov アリゾナ、US Gov テキサス、US Gov バージニア、米国中西部、西ヨーロッパ、インド西部、米国西部、米国西部 2。
**ストレージの種類** | Azure のストレージに使用するディスクの種類を指定します。 <br/><br/> オンプレミスに合わせたサイズ設定の場合は、ターゲットのストレージ ディスクの種類として、Premium マネージド、Standard SSD マネージド、Standard HDD マネージドのいずれかを指定できます。 パフォーマンス ベースのサイズ設定の場合は、ターゲットのストレージ ディスクの種類として、Premium マネージド、Standard HDD マネージド、Standard SSD マネージドのいずれかを指定できます。 ストレージの種類を Automatic として指定すると、ディスクに関する推奨事項は、ディスクのパフォーマンス データ (1 秒あたりの入出力操作 (IOPS) 数とスループット) に基づきます。 <br/><br/>ストレージの種類に Premium または Standard を指定すると、選択したストレージの種類におけるディスク SKU が評価で推奨されます。 99.9% の単一インスタンス VM SLA を達成したい場合は、ストレージの種類に Premium マネージド ディスクを指定できます。 これにより、評価に含まれるすべてのディスクが Premium マネージド ディスクとして推奨されるようになります。 Azure Migrate の移行評価では、マネージド ディスクのみがサポートされます。
**予約インスタンス (RI)** | このプロパティは、Azure で[予約インスタンス](https://azure.microsoft.com/pricing/reserved-vm-instances/)を指定するのに役立ちます。 続いて評価でのコスト見積もりで、RI 割引が考慮されます。 RI は、現在、Azure Migrate では従量課金制についてのみサポートされています。
**サイズ変更の設定基準** | VM を Azure に*適したサイズ*にするために使用される基準を設定します。 *パフォーマンスベース* のサイズ設定を選択することも、パフォーマンス履歴を考慮せずに*オンプレミスに合わせて* VM のサイズを設定することもできます。
**パフォーマンス履歴** | マシンのパフォーマンス データを評価するために考慮する期間を設定します。 このプロパティは、サイズ設定の基準が*パフォーマンス ベース*の場合にのみ適用されます。
**百分位数の使用率** | 適切なサイズ設定のために考慮するパフォーマンス サンプル セットのパーセンタイル値を指定します。 このプロパティは、サイズ設定がパフォーマンス ベースの場合にのみ適用されます。
**VM シリーズ** | 適切なサイズ変更を検討する VM シリーズを指定できるようにします。 たとえば、Azure で A シリーズ VM に移行する予定がない運用環境がある場合は、リストまたはシリーズから A シリーズを除外することができるため、選択したシリーズでのみ、適切なサイズ変更が実行されます。
**快適性係数** | Azure Migrate Server Assessment では、評価時にバッファー (快適性係数) が考慮されます。 VM のマシン使用率データ (CPU、メモリ、ディスク、ネットワーク) に加えて、このバッファーが適用されます。 快適性係数は、季節ごとの使用量、短期間のパフォーマンス履歴、将来に使用量が増える可能性などの問題に相当します。<br/><br/> たとえば、使用率 20% の 10 コア VM の結果は、通常 2 コア VM になります。 一方、快適性係数を 2.0x とした場合は、結果が 4 コア VM になります。
**プラン** | 登録されている [Azure プラン](https://azure.microsoft.com/support/legal/offer-details/)を表示します。 Azure Migrate はそれに応じてコストを見積もります。
**通貨** | アカウントの請求通貨を表示します。
**割引率 (%)** | Azure オファーに適用される任意のサブスクリプション固有の割引を一覧表示します。 既定の設定は 0% です。
**VM のアップタイム** | VM が Azure 上で 24 時間 365 日稼働するわけではない場合は、Azure 上で稼働する期間 (1 か月あたりの日数と 1 日あたりの時間数) を指定できます。それに応じてコストの見積もりが処理されます。 既定値は、1 か月あたり 31 日、1 日あたり 24 時間です。
**Azure ハイブリッド特典** | ソフトウェア アシュアランスがあり、かつ [Azure ハイブリッド特典](https://azure.microsoft.com/pricing/hybrid-use-benefit/)を受ける資格があるかどうかを指定します。 [はい] に設定すると、Windows VM に Windows Azure 以外の価格は考慮されません。 既定の設定は [はい] です。

## <a name="how-are-assessments-calculated"></a>評価の計算方法

Azure Migrate Server Assessment では、オンプレミス サーバーについて収集されたメタデータを使って評価が計算されます。 評価計算は、3 段階で処理されます。 つまり、サーバーごとに、最初に Azure 適合性分析、次にサイズ設定、最後に月間コスト見積もりが行われます。 前の段階で合格したサーバーだけが次の段階に進みます。 たとえば、Azure 適合性分析に合格しなかったサーバーは、Azure に不適合とマークされ、サイズ設定とコスト計算は行われません。

## <a name="azure-suitability-analysis"></a>Azure 適合性分析

すべてのマシンが Azure での実行に適しているとはかぎりません。 サーバー評価では、Azure 移行の適合性について各オンプレミス マシンが評価されます。 また、評価された各マシンは、次のいずれかの適合性カテゴリに割り当てられます。
- **[Azure に対応]** : マシンをそのまま変更せずに Azure に移行できます。 Azure で起動し、Azure のフル サポートを受けます。
- **Azure に条件付きで対応**:マシンは Azure で起動する可能性はありますが、Azure サポートの一部を受けられないことがあります。 たとえば、Azure でサポートされない過去のバージョンの Windows Server OS を実行しているマシンなどが該当します。 このようなマシンを Azure に移行する前には注意が必要です。アセスメントで示された修復ガイダンスに従い、対応に関する問題を修正します。
- **[Azure に未対応]** : Azure では、マシンは起動しません。 たとえば、オンプレミス マシンに接続されているディスクが 64 TB を超える場合は、Azure でホストできません。 アセスメントで示された修復ガイダンスに従い、対応に関する問題を修正してからマシンを Azure に移行する必要があります。 [Azure に未対応] と分類されたマシンのサイズ調整とコスト見積もりは行われません。
- **[Readiness 不明]** : オンプレミス環境から収集したメタデータが不十分なために、Azure Migrate がマシンの対応性を判断できませんでした。

Server Assessment は、マシンのプロパティとゲスト オペレーティング システムを調べて、オンプレミス マシンの Azure 対応性を判断します。

### <a name="machine-properties"></a>マシンのプロパティ

Server Assessment は、オンプレミス VM の次のプロパティを調べて、Azure で実行できるかどうかを判断します。

**プロパティ** | **詳細** | **Azure 対応性の状態**
--- | --- | ---
**ブートの種類** | Azure は、ブートの種類が UEFI ではなく BIOS として VM をサポートします。 | ブートの種類が UEFI の場合は条件付きで対応します。
**コア** | マシンのコア数は、Azure VM でサポートされている最大コア数 (128) 以下である必要があります。<br/><br/> パフォーマンス履歴が使用可能な場合、Azure Migrate では、使用されているコアの数が比較で考慮されます。 アセスメント設定で快適性係数が指定されている場合、使用されているコアの数に快適性係数が乗算されます。<br/><br/> パフォーマンス履歴がない場合、Azure Migrate は快適性係数を適用せずに、割り当てられているコアの数を使用します。 | 制限以下の場合は対応します。
**メモリ** | マシンのメモリ サイズは、Azure VM で許容される最大メモリ (Azure M シリーズ Standard_M128m&nbsp;<sup>2</sup> で 3892 GB) 以下である必要があります。 [詳細情報](https://docs.microsoft.com/azure/virtual-machines/windows/sizes)。<br/><br/> パフォーマンス履歴が使用可能な場合、Azure Migrate では、使用されているメモリが比較で考慮されます。 快適性係数が指定されている場合、使用されているメモリに快適性係数が乗算されます。<br/><br/> 履歴がない場合は、快適性係数は適用されず、割り当てられているメモリが使用されます。<br/><br/> | 制限内であれば対応します。
**ストレージ ディスク** | ディスクの割り当てサイズは、32 TB 以下である必要があります。 Azure では 64 TB の Ultra SSD ディスクをサポートしますが、現在 Azure Migrate Server Assessment では、Ultra SSD がまだサポートされていないため、ディスク サイズの制限として 32 TB がチェックされます。 <br/><br/> マシンに接続されているディスクの数は、OS ディスクを含めて 65 個以下である必要があります。 | 制限内であれば対応します。
**ネットワーク** | コンピューターには 32 個以下のネットワークインターフェイス (NIC) が接続されている必要があります。 | 制限内であれば対応します。

### <a name="guest-operating-system"></a>ゲスト オペレーティング システム
Server Assessment は、VM のプロパティとともに、マシンのゲスト オペレーティング システムを調べて Azure で実行できるかどうかを判断します。

> [!NOTE]
> VMware VM の場合、Server Assessment は、vCenter Server で VM に指定されているオペレーティング システムを使ってゲスト OS 分析を処理します。 VMware で実行されている Linux VM については、現在のところゲスト OS の正確なカーネル バージョンが識別されません。

Server Assessment でオペレーティング システムに基づいて VM の Azure 対応性が確認されるときには、次のロジックが使用されます。

**オペレーティング システム** | **詳細** | **Azure 対応性の状態**
--- | --- | ---
Windows Server 2016 および全 SP | Azure は完全サポートを提供します。 | Azure に対応
Windows Server 2012 R2 および全 SP | Azure は完全サポートを提供します。 | Azure に対応
Windows Server 2012 および全 SP | Azure は完全サポートを提供します。 | Azure に対応
Windows Server 2008 R2 および全 SP | Azure は完全サポートを提供します。| Azure に対応
Windows Server 2008 (32 ビットおよび 64 ビット) | Azure は完全サポートを提供します。 | Azure に対応
Windows Server 2003、2003 R2 | これらのオペレーティング システムはサポート終了日が過ぎているため、Azure でのサポートには[カスタム サポート契約 (CSA)](https://aka.ms/WSosstatement) が必要です。 | Azure に条件付きで対応。 Azure に移行する前に OS のアップグレードを検討してください。
Windows 2000、98、95、NT、3.1、MS-DOS | これらのオペレーティング システムは、サポート終了日を過ぎています。 マシンは Azure で起動する場合がありますが、Azure は OS をサポートしません。 | Azure に条件付きで対応。 Azure に移行する前に OS をアップグレードすることをお勧めします。
Windows Client 7、8、10 | Azure は、[Visual Studio サブスクリプション](https://docs.microsoft.com/azure/virtual-machines/windows/client-images)にのみサポートを提供します。 | Azure に条件付きで対応
Windows 10 Pro デスクトップ | Azure は、[マルチ テナント ホスティング権限](https://docs.microsoft.com/azure/virtual-machines/windows/windows-desktop-multitenant-hosting-deployment)にサポートを提供します。 | Azure に条件付きで対応
Windows Vista、XP Professional | これらのオペレーティング システムは、サポート終了日を過ぎています。 マシンは Azure で起動する場合がありますが、Azure は OS をサポートしません。 | Azure に条件付きで対応。 Azure に移行する前に OS をアップグレードすることをお勧めします。
Linux | Azure はこれらの [Linux オペレーティング システム](../virtual-machines/linux/endorsed-distros.md)をサポートしています。 他の Linux オペレーティング システムも Azure で起動する可能性はありますが、Azure に移行する前に、サポート対象バージョンへの OS のアップグレードをお勧めします。 | Azure に対応 (バージョンがサポートされている場合)。<br/><br/>条件付きで対応 (バージョンがサポートされていない場合)。
他のオペレーティング システム<br/><br/> 例: Oracle Solaris、Apple Mac OS、FreeBSD など | Azure では、これらのオペレーティング システムはサポートされません。 マシンは Azure で起動する場合がありますが、Azure は OS をサポートしません。 | Azure に条件付きで対応。 Azure に移行する前に、サポートする OS をインストールすることをお勧めします。  
vCenter Server で **[Other]\(その他\)** と指定された OS | この場合、Azure Migrate は OS を識別できません。 | 対応不明。 VM で実行している OS が Azure でサポートされることを確認します。
32 ビット オペレーティング システム | マシンは Azure で起動できますが、Azure がフル サポートを提供しない可能性があります。 | Azure に条件付きで対応。 Azure に移行する前に、マシンの OS を 32 ビット OS から 64 ビット OS にアップグレードすることをご検討ください。

## <a name="sizing"></a>サイズ変更

マシンが Azure に対応することが確認されると、Server Assessment は推奨のサイズ設定を作成して、オンプレミス VM に対応する適切な Azure VM とディスク SKU を特定します。 これらの推奨サイズは、指定した評価プロパティによって異なります。

- 評価で "*パフォーマンス ベースのサイズ設定*" が使用された場合、Azure Migrate はマシンのパフォーマンス履歴を考慮して Azure での VM サイズとディスクの種類を特定します。 この方法は、オンプレミス VM を割り当て過ぎて使用率が低下した場合に、Azure で VM のサイズを適切に設定してコストを削減したい場合に特に役立ちます。 この方法では、移行中にサイズを最適化することができます。
- VM のサイズ設定のパフォーマンス データを考慮せずに、オンプレミスのマシンを Azure に対してそのままの状態にしておく場合は、サイズ設定条件を*オンプレミス*に設定できます。 次に、Server Assessment は、使用率データを考慮せずに、オンプレミスの構成に基づいて VM のサイズを設定します。 この場合は、評価プロパティで指定したストレージの種類 (Standard HDD、Standard SSD、または Premium ディスク) に基づいて、ディスクのサイズ設定が行われます。

### <a name="performance-based-sizing"></a>パフォーマンス ベースのサイズ設定

パフォーマンス ベースのサイズ設定では、Server Assessment は、VM に接続されているディスクから開始し、ネットワーク アダプターが続きます。 続いて、オンプレミス VM のコンピューティング要件に基づいて、Azure VM SKU をマップします。 Azure Migrate アプライアンスは、オンプレミス環境をプロファイルして、CPU、メモリ、ディスク、およびネットワーク アダプターのパフォーマンス データを収集します。

**パフォーマンス データの収集手順:**

1. VMware VM の場合、Azure Migrate アプライアンスは、20 秒間隔ごとにリアルタイムのサンプル ポイントを収集します。 Hyper-V VM の場合、リアルタイムのサンプル ポイントは 30 秒間隔で収集されます。
1. アプライアンスは、収集したサンプル ポイントを 10 分ごとにロール アップし、過去 10 分間の最大値を Server Assessment に送信します。
1. Server Assessment では、過去 1 か月のすべての 10 分のサンプル ポイントが格納されます。 次に、*パフォーマンス履歴*と*百分位の使用率*に指定された評価プロパティに応じて、適切なサイズ設定に使用する適切なデータ ポイントを識別します。 たとえば、パフォーマンス履歴を 1 日に、百分位の使用率を 95 番目に設定した場合、Server Assessment では、過去 1 日間の 10 分のサンプル ポイントが昇順で並べ替えられ、正しいサイズ設定のために 95 番目の百分位値が選択されます。
1. この値に快適性係数が乗算されて、アプライアンスが収集する各メトリック (CPU 使用率、メモリ使用率、ディスク IOPS (読み取りと書き込み)、ディスク スループット (読み取りと書き込み)、ネットワーク スループット (インとアウト)) の有効なパフォーマンス使用率データが得られます。

有効な使用率の値が決定されると、次のようにしてストレージ、ネットワーク、およびコンピューティングのサイズ設定が処理されます。

**ストレージのサイズ設定**:Azure Migrate は、マシンに接続されているすべてのディスクを Azure のディスクにマップしようとします。

> [!NOTE]
> Azure Migrate Server Assessment では、マネージド ディスクのみが評価対象としてサポートされます。

  - Server Assessment では、必要な IOPS の合計を取得するために、ディスクの読み取りと書き込みの IOPS を追加します。 同様に、読み取りと書き込みのスループット値を追加して、各ディスクのスループットの合計を取得します。
  - ストレージの種類に [Automatic] を指定した場合は、有効な IOPS とスループットの値を基に、Server Assessment が、Azure で Standard HDD、Standard SSD、Premium ディスクのどれにディスクをマップすべきかを判断します。 ストレージの種類を Standard HDD/SSD/Premium に設定した場合は、選択したストレージの種類 (Standard HDD/SSD/Premium ディスク) におけるディスク SKU の検出が Server Assessment によって試行されます。
  - Server Assessment で必要な IOPS とスループットのディスクが見つからなかった場合は、そのマシンが Azure に不適合とマークされます。
  - Server Assessment は、適合する一連のディスクを見つけると、評価の設定で指定されている場所に対応したディスクを選択します。
  - 対象となるディスクが複数ある場合は、Server Assessment は最も低コストのディスクを選択します。
  - どのディスクのパフォーマンス データも得られない場合は、ディスクの構成データ (ディスク サイズ) を使用して Azure で Standard SSD ディスクが検索されます。

**ネットワークのサイズ設定**:Server Assessment は、オンプレミス マシンに接続されたネットワーク アダプターの数およびそれらのネットワーク アダプターが必要とするパフォーマンスに対応できる Azure VM を見つけようとします。
- オンプレミス VM の有効なネットワーク パフォーマンスを取得するために、Server Assessment は、すべてのネットワーク アダプターについてマシンから送信される 1 秒あたりのデータ容量 (MBps) (ネットワーク出力) を集計し、快適性係数を適用します。 この数値を使用して、必要なネットワーク パフォーマンスをサポートできる Azure VM を見つけます。
- Server Assessment は、ネットワーク パフォーマンスと共に、Azure VM が必要なネットワーク アダプター数をサポートできるかどうかも考慮します。
- ネットワーク パフォーマンス データが使用できない場合は、Server Assessment は、VM のサイズ設定でネットワーク アダプター数だけを考慮します。

**コンピューティングのサイズ設定**:ストレージとネットワークの要件が計算されると、Server Assessment は CPU とメモリの要件を考慮して Azure での適切な VM サイズを求めます。
- Azure Migrate は、有効な使用コア数とメモリを確認して、Azure での適切な VM サイズを割り出します。
- 適切なサイズが見つからない場合、そのマシンは Azure に不適合とマークされます。
- 適切なサイズが見つかった場合は、ストレージとネットワークの計算が適用されます。 その後、場所と価格レベルの設定が適用され、VM サイズの最終的な推奨事項が作成されます。
- 条件を満たす Azure VM サイズが複数ある場合、最も低コストのディスクをお勧めします。

### <a name="as-on-premises-sizing"></a>オンプレミスのサイズ設定

*オンプレミスのサイズ設定*を使用する場合、Server Assessment は VM とディスクのパフォーマンス履歴を考慮しません。 代わりに、オンプレミスで割り当てられたサイズに基づいて、Azure で VM SKU を割り当てます。 同様にディスクのサイズ設定でも、Server Assessment は、評価プロパティで指定したストレージの種類 (Standard HDD/SSD/Premium) を確認し、それに応じてディスクの種類を推奨します。 既定のストレージの種類は Premium ディスクです。

## <a name="confidence-ratings"></a>信頼度レーティング
Azure Migrate のパフォーマンス ベースの評価には、それぞれ 1 つ星 (最低) から 5 つ星 (最高) までの範囲の信頼度レーティングが関連付けられます。
- 信頼度レーティングは、評価の計算に必要なデータ ポイントの可用性に基づいて、評価に割り当てられます。
- 評価の信頼度レーティングは、Azure Migrate による推奨サイズの信頼性を判断する目安となります。
- 信頼度レーティングは、*オンプレミス*の評価には適用されません。
- パフォーマンス ベースのサイズ設定では、Server Assessment が以下を必要とします。
    - CPU と VM メモリの使用率データ。
    - VM に接続されているディスクごとの、ディスク IOPS とスループット データ。
    - VM に接続したネットワーク アダプターごとにパフォーマンス ベースのサイズ設定を処理するためのネットワーク I/O。

   これらの使用率の数値のいずれかが vCenter Server で利用できない場合は、推奨サイズの信頼性が損なわれる可能性があります。

使用可能なデータ ポイントの割合に応じて、評価の信頼度レーティングは次のようになります。

   **データ ポイントの可用性** | **信頼度レーティング**
   --- | ---
   0-20% | 1 つ星
   21-40% | 2 つ星
   41-60% | 3 つ星
   61-80% | 4 つ星
   81-100% | 5 つ星

### <a name="low-confidence-ratings"></a>信頼度レーティングが低い

次のようないくつかの理由で、評価の信頼度レーティングが低くなることがあります。

- 評価を作成する期間について環境をプロファイルしなかった。 たとえば、パフォーマンス期間を 1 日に設定して評価を作成する場合は、すべてのデータ ポイントを収集するために、検出を開始してから少なくとも 1 日待つ必要があります。
- 評価の計算対象期間中にシャットダウンされた VM がある。 いずれかの VM で電源がオフになっている期間がある場合、Server Assessment はその期間のパフォーマンス データを収集できません。
- 評価の計算対象期間中に作成された VM がある。 たとえば、前月のパフォーマンス履歴で評価を作成する場合に、ほんの 1 週間前にその環境で VM が作成されていると、その新しい VM のパフォーマンス履歴は全期間にわたって存在しないことになります。

> [!NOTE]
> 評価の信頼度レーティングが 5 つ星を下回る場合は、アプライアンスが環境をプロファイルできるように少なくとも 1 日待ってから、評価を再計算することをお勧めします。 このようにしない場合、パフォーマンスベースのサイズ見積もりの信頼性が損なわれる可能性があります。 その場合は、評価をオンプレミスのサイズ設定切り替えることをお勧めします。

## <a name="monthly-cost-estimation"></a>月間コスト見積もり

推奨サイズの設定が完了すると、Azure Migrate は移行後のコンピューティング コストとストレージ コストを計算します。

- **コンピューティング コスト**:Azure Migrate は、Billing API を使用して、推奨される Azure VM サイズで VM の月間コストを計算します。
    - この計算では、オペレーティング システム、ソフトウェア アシュアランス、予約インスタンス、VM のアップタイム、場所、および通貨の設定が考慮されます。
    - すべてのマシンのコストが集計され、月間コンピューティング コストの合計が計算されます。
- **ストレージ コスト**:次のように、マシンの月間ストレージ コストは、マシンに接続されているすべてのディスクの月間コストを集計して計算されます。
    - Server Assessment は、すべてのマシンのストレージ コストを集計して、月間ストレージ コストの合計を計算します。
    - 現在、この計算では、アセスメント設定で指定されたプランは考慮されません。

コストは、アセスメント設定で指定された通貨で表示されます。


## <a name="next-steps"></a>次の手順

[VMware VM](tutorial-assess-vmware.md) または [Hyper-V VM](tutorial-assess-hyper-v.md) の評価を作成します。
