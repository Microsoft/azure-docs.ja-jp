---
title: Azure Security Center for IoT のセキュリティ アラート ガイド | Microsoft Docs
description: Azure Security Center for IoT とサービスを使用したセキュリティ アラートと推奨される修復方法について説明します。
services: asc-for-iot
ms.service: asc-for-iot
documentationcenter: na
author: mlottner
manager: rkarlin
editor: ''
ms.assetid: a5c25cba-59a4-488b-abbe-c37ff9b151f9
ms.subservice: asc-for-iot
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/28/2019
ms.author: mlottner
ms.openlocfilehash: 99ffa49a8e379f6c3a2139c082cd23f95c126e50
ms.sourcegitcommit: fe6b91c5f287078e4b4c7356e0fa597e78361abe
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/29/2019
ms.locfileid: "68597245"
---
# <a name="azure-security-center-for-iot-security-alerts"></a>Azure Security Center for IoT のセキュリティ アラート

Azure Security Center for IoT では、高度な分析および脅威インテリジェンスを使用して IoT ソリューションを継続的に分析し、悪意のあるアクティビティに関するアラートを受け取ることができます。
さらに、期待されるデバイスの動作の知識に基づいて、カスタム アラートを作成できます。
アラートは侵害のリスクのインジケーターとして機能し、調査して修復する必要があります。

この記事では、IoT Hub や IoT デバイスでトリガーできる組み込みアラートの一覧を示します。
組み込みアラートのほかに、Azure Security Center for IoT では、IoT ハブやデバイスの予想される動作に基づいてカスタム アラートを定義することもできます。
詳しくは、「[カスタム アラートの作成](quickstart-create-custom-alerts.md)」をご覧ください。

## <a name="built-in-alerts-for-iot-devices"></a>IoT デバイス用の組み込みアラート

| Severity | 名前 | データ ソース | 説明 | 推奨される修復手順|                  
|----------|---------------|-------------|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 高     | ローカル ログインの成功                                 | エージェント       | デバイスへのローカル サインインが成功したことが検出されました | サインイン ユーザーが承認済みのパーティーであることを確認してください。  |
| 高     | ブルートフォース試行の成功  | エージェント       | 複数回の失敗したログイン試行に続き、ログインの成功が確認されました。 デバイス上で試行されたブルートフォース攻撃が成功した可能性があります。 | デバイス上の SSH ブルートフォース アラートとアクティビティを確認してください。 <br>悪意のあるアクティビティであった場合は、<br> セキュリティが侵害されたアカウントについて、パスワードのリセットをロールアウトします。<br> デバイスにマルウェアがないか調査し、(見つかった場合は) 修復してください。  |
| 高     | バイナリ コマンド ライン | エージェント | コマンド ラインからの LA Linux バイナリの呼び出しまたは実行が検出されました。 このプロセスは正当なアクティビティである場合もあれば、デバイスのセキュリティが侵害されたことを示している可能性もあります。|   コマンドについて、それを実行したユーザーに確認し、そのデバイス上での実行が見込まれる正当な行為であるかどうかを確認します。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。 |
| 高     | リバース シェル | エージェント | %{Compromised Host} 上のホスト データの分析で、リバース シェルの可能性が検出されました。 リバース シェルは、セキュリティが侵害されたマシンに、悪意のあるアクターが制御するマシンをコール バックさせる目的で使用されることが少なくありません。|  コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。  |
| 高     | ファイアウォールの無効化                                       | エージェント       | ホスト上のファイアウォールに対して操作が実行されている可能性が検出されました。 データの抜き取りを試みる悪意のあるアクターによって、ホスト上のファイアウォールが無効にされることは少なくありません。|  コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。 |
| 高     | Web シェル | エージェント | Web シェルが使用されている可能性があることが検出されました。 一般に、悪意のあるアクターは、セキュリティを侵害したマシンに Web シェルをアップロードして、持続性を獲得したり、さらに悪用したりします。|  コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。 |
| 高     | ポート フォワーディングの検出| エージェント  | 外部 IP アドレスへのポート フォワーディングの開始が検出されました。|  コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。 |
| 高     | Auditd ログ記録を無効にする試みが行われている可能性があることが検出されました | エージェント       | Linux Auditd システムは、システムに関するセキュリティ関連情報を追跡する手段を提供しています。 このシステムは、自分のシステムで発生しているイベントについて、可能な限り多くの情報を記録します。 この情報は、ミッション クリティカルな環境でセキュリティ ポリシーの違反者を特定し、違反者が実行するアクションを把握するうえで非常に重要です。 Auditd ログ記録を無効にすると、システムで使用されているセキュリティ ポリシーの違反を検出できなくなる可能性があります。 |それがビジネス上の理由から正当なアクティビティであったかどうかをデバイスの所有者に確認してください。 そうではなかった場合、このイベントは、悪意のあるアクターによる隠蔽のアクティビティである可能性があります。 情報セキュリティ チームに直ちにインシデントをエスカレートしてください。|
| 低  | SAS トークン署名が無効です                            | IoT Hub     | デバイスによって使用される SAS トークンに、無効な署名があります。 この署名は、プライマリ キーとセカンダリ キーのどちらとも一致しません。|  デバイスのアラートを確認してください。 これ以上必要な操作はありません。  |
| Medium   | x.509 デバイス証明書の拇印が一致しません           | IoT Hub     | X.509 デバイス証明書の拇印は、構成と一致しませんでした。 |デバイスでアラートを確認してください。 これ以上必要な操作はありません。 |
| Medium   | X.509 証明書の有効期限が切れました | IoT Hub     | X.509 デバイス証明書の有効期限が切れました。 |  証明書の有効期限が切れた正当なデバイスである可能性もありますが、正当なデバイスを偽装しようとする試みである可能性もあります。 現在、正当なデバイスが正しく通信しているようであれば、偽装の試みである可能性が高くなります。 ||
| Medium   | ローカル ログインに失敗しました | エージェント       | デバイスへのローカル ログインの試行の失敗が検出されました。 |
| Medium   | 暗号コイン マイナーのイメージ| エージェント       | 通常はデジタル通貨マイニングに関連するプロセスの実行が検出されました。| コマンドを実行したユーザーに、それがデバイス上の正当なアクティビティであったことを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。|   
| Medium   | 悪意のある資格情報へのアクセスによく使用されるツールが検出されました | エージェント       | 悪意を持って資格情報にアクセスしようとする行為に一般に関連するツールの使用が検出されました。 |  コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったことを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。|  |
| Medium   | 暗号コイン マイナーのコンテナー イメージが検出されました                   | エージェント       | 既知のデジタル通貨マイニング イメージを実行するコンテナーが検出されました。 |  1.意図した動作ではない場合、関連するコンテナー イメージを削除してください。<br> 2.安全でない TCP ソケット経由では Docker デーモンにアクセスできないことを確認してください。 手順 3. 情報セキュリティ チームにアラートをエスカレートしてください。|
| Medium   | 既知の攻撃ツール                                      | エージェント       | なんらかの方法で他のマシンを攻撃する悪意のあるユーザーに関連していることの多いツールが検出されました。 |コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。|
| Medium   | htaccess ファイルへのアクセスが検出されました                       | エージェント       | ホスト データの分析で、htaccess ファイルが操作された可能性が検出されました。 htaccess は、基本的なリダイレクト機能や、基本パスワード保護をはじめとするさらに高度な機能など、Apache Web ソフトウェアを実行する Web サーバーに複数の変更を加えることができる強力な構成ファイルです。 悪意のあるアクターは持続性を獲得するために、セキュリティを侵害したマシン上の htaccess ファイルに変更を加えることがよくあります。 |それがホスト上で見込まれる正当なアクティビティであることを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。|
| Medium   | 一般的な Linux ボットに似た動作が検出されました| エージェント | 一般的な Linux ボットネットに関連付けられたプロセスの実行が検出されました。| コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。 |
| Medium   | 不審なファイルのダウンロードと、それに続くファイルの実行アクティビティ| エージェント| ホスト データの分析で、同じコマンドでダウンロードされて実行されたファイルが検出されました。 これは、悪意のあるアクターが犠牲者のマシンに感染ファイルを送り込む際に用いる一般的な手法です。 |コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。|
| Medium   | データが損失した可能性があることが検出されました | エージェント | データ エグレス条件の疑いが、ホスト データの分析を使用して検出されました。 悪意のあるアクターは、セキュリティを侵害したマシンからデータを取り出すことがよくあります。|コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| Medium   | ファイル名の後のスペース| エージェント | 不審な拡張子を持ったプロセスの実行が、ホスト データの分析を使用して検出されました。 不審な拡張子は、ファイルを開いても安全であるとユーザーを欺くことがあります。また、システム上にマルウェアが存在することを示す場合があります。 |コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| Medium   | TCP ソケットによる公開 Docker デーモン | エージェント | マシンのログは、Docker デーモン (dockerd) が TCP ソケットを公開していることを示します。 既定では、Docker の構成は、TCP ソケットが有効である場合には暗号化または認証は使用しません。 既定の Docker 構成では、該当するポートへのアクセス権さえ持っていればだれでも、Docker デーモンへのフル アクセスが可能です。|コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| Medium   | Fairware ランサムウェアに似た動作が検出されました | エージェント       | 不審な場所に適用された rm -rf コマンドの実行が、ホスト データの分析を使用して検出されました。 rm rf は再帰的にファイルを削除するものであるため、通常は個別のフォルダーでしか使用されません。 このケースでは、大量のデータが削除される可能性のある場所で使用されています。 Fairware ランサムウェアは、このフォルダーで rm -rf コマンドを実行することが知られています。 |コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったことを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| Medium   | バックドアの可能性が検出されました | エージェント |ご利用のサブスクリプション内のホストに不審なファイルがダウンロードされて実行されました。 これは一般に、バックドアのインストールに関連したタイプのアクティビティです。 |コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| Medium   | ローカル ホスト偵察が検出されました | エージェント       | 通常は一般的な Linux ボット偵察に関連するコマンドの実行が検出されました。 |不審なコマンド ラインを調査して、正当なユーザーによって実行されたものであることを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| Medium   | 共通ファイルの潜在的な上書き | エージェント | デバイス上の共通実行可能ファイルが上書きされています。 悪意のあるアクターは、そのアクションを隠したり持続性を獲得したりするための手段として、共通ファイルを上書きすることが知られています。 |コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| Medium   | 既知の悪意のあるソースからのファイルのダウンロードが検出されました  | エージェント       |  既知のマルウェア ソースからのファイルのダウンロードが検出されました。|コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| Medium   | 特権コンテナーが検出されました | エージェント       | マシンのログは、アクセス許可された Docker コンテナーが実行していることを示しています。 特権コンテナーには、ホストのリソースへのフル アクセス権があります。 セキュリティが侵害された場合、悪意のあるアクターは特権コンテナーを使用して、ホスト マシンにアクセスすることができます。|コンテナーを特権モードで実行する必要がない場合は、コンテナーから特権を削除してください。
| Medium   | ランサムウェア検出に似た動作が検出されました | エージェント       | ユーザーが自分のシステムや個人用ファイルにアクセスできないようにしたり、再びアクセスできるようにする代わりに身代金の支払いを要求したりする可能性のある既知のランサムウェアに似たファイルが実行されました。|コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| Medium   | システム ログ ファイルの削除が検出されました | エージェント       | ホスト上のログ ファイルの不審な削除が検出されました。 |コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| Medium   | スクリプト インタープリターとファイル名拡張子が一致しません | エージェント       | スクリプト インタープリターと、入力として与えられたスクリプト ファイルの拡張子の間で不一致が検出されました。 一般に、このタイプの不一致は、攻撃者によるスクリプトの実行と関係があります。 |コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| Medium   | 不審なコンパイルが検出されました  | エージェント       | 不審なコンパイルが検出されました。 悪意のあるアクターは、権限を昇格させるために、セキュリティを侵害したマシンでエクスプロイトをコンパイルすることがよくあります。  |コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| Medium   | nohup コマンドの疑わしい使用が検出されました | エージェント       | ホスト上で nohup コマンドの不審な使用が検出されました。 一般に、悪意のあるアクターは、一時ディレクトリから nohup コマンドを実行して、その実行可能ファイルをバックグラウンドで効果的に実行できるようにします。 一時ディレクトリにあるファイルに対してこのコマンドが実行されることはあり得ないか、通常の動作ではありません。 |コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| Medium   | useradd コマンドの疑わしい使用が検出されました         | エージェント       | useradd コマンドの不審な使用がデバイスで検出されました。 |コマンドを実行したユーザーに、それがデバイス上で見込まれる正当なアクティビティであったかどうかを確認してください。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| Medium   | 疑わしい IP アドレスの通信 | エージェント       | 不審な IP アドレスとの通信が検出されました。 |接続が正当なものであるかどうかを確認してください。 不審な IP との通信はブロックすることを検討してください。 
| 低      | SAS トークンの有効期限が切れています  | IoT Hub     | 有効期限切れの SAS トークンがデバイスによって使用されました  |トークンの有効期限が切れた正当なデバイスである可能性もありますが、正当なデバイスを偽装しようとする試みである可能性もあります。 現在、正当なデバイスが正しく通信しているようであれば、偽装の試みである可能性が高くなります。
| 低      | サイレントのデバイス | エージェント       | デバイスは過去 72 時間以内に利用統計情報をまったく送信していません。|デバイスがオンラインであり、データを送信していることを確認します。 Azure セキュリティ エージェントがデバイスで実行されていることを確認してください。
| 低      | Bash 履歴がクリアされました                                   | エージェント       | Bash 履歴ログがクリアされました。 一般に、悪意のあるアクターは、自身のコマンドがログに残らないよう Bash 履歴を消去します。 |コマンドを実行したユーザーにこのアラートのアクティビティを確認し、正当な管理アクティビティと見てよいかどうかを確認します。 そうではない場合、情報セキュリティ チームにアラートをエスカレートしてください。
| 低 | ブルートフォース試行の失敗 | エージェント       | 複数の失敗したログイン試行が識別されました。 デバイスに対し、ブルートフォース攻撃が試行されて失敗した可能性があります。 |デバイス上の SSH ブルートフォース アラートとアクティビティを確認してください。 これ以上必要な操作はありません。|
|

## <a name="built-in-alerts-for-iot-hub"></a>IoT Hub 用の組み込みアラート

| Severity | 名前                                                                         | 説明 | 推奨される修復方法|
|----------|------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|
| Medium   | 新しい証明書が IoT Hub に追加されました                                    |\'%{DescCertificateName}\' という名前の証明書が IoT ハブ \'%{DescIoTHubName}\' に追加されました。 このアクションが未承認のパーティーによって行われた場合、悪意のあるアクティビティであることを示している可能性があります。| 1.承認済みのパーティーによって証明書が追加されたことを確認してください。 <br> 2.追加したのが承認済みのパーティではない場合は、証明書を削除して、組織のセキュリティ チームにアラートをエスカレートしてください。  |
| Medium   | 証明書が IoT Hub から削除されました                                    | \'%{DescCertificateName}\' という名前の証明書が IoT ハブ \'%{DescIoTHubName}\' から削除されました。 このアクションが未承認のパーティーによって行われた場合、悪意のあるアクティビティであることを示している可能性があります。| 1.承認済みのパーティーによって証明書が削除されたことを確認してください。 <br> 2.証明書を削除したのが承認済みのパーティではない場合は、証明書を再び追加して、組織のセキュリティ チームにアラートをエスカレートしてください。 |
| Medium   | 証明書を IoT ハブに追加しようとして失敗したことが検出されました     | 証明書 \'%{DescCertificateName}\' を IoT ハブ \'%{DescIoTHubName}\' に追加しようとして失敗した形跡があります。 このアクションが未承認のパーティーによって行われた場合、悪意のあるアクティビティであることを示している可能性があります。|   証明書を変更するアクセス許可が承認済みのパーティーにのみ付与されていることを確認してください。  |
| Medium   | 証明書を IoT ハブから削除しようとして失敗したことが検出されました | 証明書 \'%{DescCertificateName}\' を IoT ハブ \'%{DescIoTHubName}\' から削除しようとして失敗した形跡があります。 このアクションが未承認のパーティーによって行われた場合、悪意のあるアクティビティであることを示している可能性があります。 |証明書を変更するアクセス許可が承認済みのパーティーにのみ付与されていることを確認してください。
| 低      | IoT ハブの診断設定を追加または編集しようとしたことが検出されました    | IoT ハブの診断設定を追加または編集しようとしたことが検出されました。 診断設定により、セキュリティ インシデントが発生した場合やネットワークが侵害された場合に、調査目的でアクティビティ証跡を再作成できます。 このアクションが承認されたパーティーによって行われたのでない場合、悪意のあるアクティビティであることを示している可能性があります。  |
| 低      | IoT ハブから診断設定を削除しようとしたことが検出されました       | IoT ハブ \'%{DescIoTHubName}\' の診断設定 \'%{DescDiagnosticSettingName}\' を追加または編集しようとする %{DescAttemptStatusMessage}\' の試みがありました。 診断設定により、セキュリティ インシデントが発生した場合やネットワークが侵害された場合に、調査目的でアクティビティ証跡を再作成できます。 このアクションを行ったのが承認済みのパーティーではない場合、悪意のあるアクティビティであることを示している可能性があります。 |1.承認済みのパーティーによって証明書が削除されたことを確認してください。<br> 2.証明書を削除したのが承認済みのパーティではない場合は、証明書を再び追加して、セキュリティ チームにアラートをエスカレートしてください。
|

## <a name="next-steps"></a>次の手順

- Azure Security Center for IoT サービスの[概要](overview.md)
- [セキュリティ データにアクセスする](how-to-security-data-access.md)方法を学習ぶ
- [デバイスの調査](how-to-investigate-device.md)について学ぶ