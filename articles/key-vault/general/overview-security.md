---
title: Azure Key Vault セキュリティ | Microsoft Docs
description: Azure Key Vault、キー、シークレットのアクセス許可を管理します。 キー コンテナーの認証と承認モデルおよびキー コンテナーをセキュリティで保護する方法について説明します。
services: key-vault
author: msmbaldwin
manager: rkarlin
tags: azure-resource-manager
ms.service: key-vault
ms.subservice: general
ms.topic: conceptual
ms.date: 04/18/2019
ms.author: mbaldwin
Customer intent: As a key vault administrator, I want to learn the options available to secure my vaults
ms.openlocfilehash: edef64c215f96b34cd0efbff4521a7d5adb98885
ms.sourcegitcommit: 927dd0e3d44d48b413b446384214f4661f33db04
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/26/2020
ms.locfileid: "88870580"
---
# <a name="azure-key-vault-security"></a>Azure Key Vault セキュリティ

クラウドでは暗号化キーとシークレット (証明書、接続文字列、パスワードなど) を保護する必要があるため、Azure Key Vault を使用します。 機密性が高いビジネスに不可欠なデータを格納するため、コンテナーおよび格納データのセキュリティを最大限に高める手順を実行する必要があります。 この記事では、Azure Key Vault のセキュリティを設計するときに考慮すべき概念の一部について説明します。

## <a name="identity-and-access-management"></a>ID 管理とアクセス管理

Azure サブスクリプション内でキー コンテナーを作成すると、作成したキー コンテナーは、そのサブスクリプションの Azure AD テナントに自動的に関連付けられます。 コンテナーのコンテンツを管理または取得しようとするすべてのユーザーは Azure AD で認証される必要があります。

- 認証では、呼び出し元の ID が確立されます。
- 承認によって、呼び出し元が実行できる操作が決定されます。 Key Vault での承認では、[ロール ベースのアクセス制御](../../role-based-access-control/overview.md) (RBAC) と Azure Key Vault アクセス ポリシーの組み合わせが使用されます。

### <a name="access-model-overview"></a>アクセス モデルの概要

コンテナーに対するアクセスは 2 つのインターフェイスすなわちプレーンを介して行います。 これらのプレーンは、管理プレーンとデータ プレーンです。

- "*管理プレーン*" は Key Vault そのものを管理する場所であり、コンテナーの作成と削除に使用されるインターフェイスです。 キー コンテナーのプロパティを読み取り、アクセス ポリシーを管理することもできます。
- "*データ プレーン*" では、キー コンテナーに格納されているデータを操作できます。 キー、シークレット、証明書の追加、削除、および変更を行うことができます。

いずれのプレーン内でもキー コンテナーにアクセスするには、すべての呼び出し元 (ユーザーまたはアプリケーション) が認証および承認される必要があります。 認証については、両方のプレーンで Azure Active Directory (Azure AD) が使用されます。 承認については、管理プレーンではロールベースのアクセス制御 (RBAC) が使用され、データ プレーンでは Key Vault アクセス ポリシーが使用されます。

1 つのメカニズムで両方のプレーンを認証するモデルには次のようないくつかの利点があります。

- 組織では、組織内のすべてのキー コンテナーへのアクセスを一元的に管理できます。
- 退職したユーザーは、組織内のすべてのキー コンテナーに即座にアクセスできなくなります。
- 組織では、Azure AD のオプションを使用して認証をカスタマイズできます (セキュリティを強化するために多要素認証を有効にするなど)。

### <a name="managing-administrative-access-to-key-vault"></a>キー コンテナーに対する管理アクセスの管理

リソース グループ内にキー コンテナーを作成するとき、Azure AD を使用してアクセスを管理します。 リソース グループ内のキー コンテナーを管理する権限をユーザーまたはグループに付与します。 適切な Azure ロールを割り当てることで、特定のスコープ レベルでアクセスを付与できます。 キー コンテナーを管理するためのアクセス権をユーザーに付与するには、定義済みの `key vault Contributor` ロールを特定のスコープでそのユーザーに割り当てます。 Azure ロールには以下のスコープ レベルを割り当てることができます。

- **サブスクリプション**:サブスクリプション レベルで割り当てられた Azure ロールは、そのサブスクリプション内のすべてのリソース グループとリソースに適用されます。
- **[リソース グループ]** :リソース グループ レベルで割り当てられた Azure ロールは、そのリソース グループ内のすべてのリソースに適用されます。
- **特定のリソース**: 特定のリソースに対して割り当てられた Azure ロールは、そのリソースに適用されます。 この場合、リソースは特定のキー コンテナーです。

定義済みのロールが複数あります。 定義済みのロールがニーズに合わない場合は、独自のロールを定義できます。 詳細については、[RBAC: 組み込みのロール](../../role-based-access-control/built-in-roles.md)に関するページをご覧ください。

> [!IMPORTANT]
> ユーザーがキー コンテナーの管理プレーンに対する `Contributor` 権限を持っている場合は、そのユーザーは Key Vault アクセス ポリシーを設定することで、データ プレーンへのアクセス権を自分自身に付与できます。 ご利用のキー コンテナーへの `Contributor` ロール アクセス権を持つユーザーの管理は厳密に行う必要があります。 承認されたユーザーだけがコンテナー、キー、シークレット、証明書にアクセスできるようにします。

<a id="data-plane-access-control"></a>
### <a name="controlling-access-to-key-vault-data"></a>Key Vault データへのアクセスの制御

Key Vault アクセス ポリシーでは、キー、シークレット、または証明書へのアクセス許可が個別に付与されます。 ユーザーに対してはキーへのアクセス権のみ付与でき、シークレットへのアクセス権は付与できません。 キー、シークレット、証明書へのアクセス許可は、コンテナー レベルで管理されます。

> [!IMPORTANT]
> Key Vault アクセス ポリシーでは、特定のキー、シークレット、証明書など、細かいオブジェクト レベルのアクセス許可はサポートされていません。 キーを作成および削除するためのアクセス許可を付与されたユーザーは、そのキー コンテナー内のすべてのキーに対してそれらの操作を実行できます。

キー コンテナーのアクセス ポリシーを設定するには、[Azure portal](https://portal.azure.com/)、[Azure CLI](/cli/azure/install-azure-cli?view=azure-cli-latest)、[Azure PowerShell](/powershell/azure/)、または [Key Vault 管理 REST API](/rest/api/keyvault/) を使用します。

データ プレーンのアクセスは、[Azure Key Vault の仮想ネットワーク サービス エンドポイント](overview-vnet-service-endpoints.md)を使用して制限することができます。 追加のセキュリティ層に対して[ファイアウォールと仮想ネットワーク規則](network-security.md)を構成するできます。

## <a name="network-access"></a>ネットワーク アクセス

コンテナーに対するアクセス権を持つ IP アドレスを指定することで、コンテナーの公開を縮小できます。 Azure Key Vault の仮想ネットワーク サービス エンドポイントを使用すると、指定した仮想ネットワークに対するアクセスを制限できます。 エンドポイントでは、IPv4 (インターネット プロトコル バージョン 4) アドレス範囲のリストへのアクセスを制限することもできます。 このようなソースの外部からお使いのキー コンテナーに接続するユーザーはすべて、アクセスを拒否されます。

ファイアウォール ルールを有効にした後は、要求が許可された仮想ネットワークまたは IPv4 アドレス範囲から送信された場合にのみ、ユーザーは Key Vault のデータを読み取ることができます。 これは、Azure portal から Key Vault にアクセスする場合にも適用されます。 ユーザーは Azure portal からキー コンテナーを参照できますが、クライアント マシンが許可リストに登録されていない場合、キー/シークレット/証明書を一覧表示できない場合があります。 これは、他の Azure サービスによる Key Vault 選択機能にも影響します。 ファイアウォール ルールでクライアント マシンが許可されていない場合、ユーザーはキー コンテナーを一覧表示できても、キーは一覧表示できないことがあります。

Azure Key Vault ネットワーク アドレスの詳細については、「[Azure Key Vault の仮想ネットワーク サービス エンドポイント](overview-vnet-service-endpoints.md)」を参照してください。

## <a name="monitoring"></a>監視

Key Vault のログによって、コンテナーに対して実行されたアクティビティの情報が保存されます。 Key Vault のログ:

- 認証されたすべての REST API 要求 (失敗した要求を含む)
  - キー コンテナーそのものに対する操作。 これらの操作には、作成、削除、アクセス ポリシーの設定、キー コンテナー属性 (タグなど) の更新が含まれます。
  - 次の操作を含む、キー コンテナーのキーとシークレットに関する操作。
    - これらのキーまたはシークレットの作成、変更、または削除。
    - 署名、確認、暗号化、復号化、キーのラップとラップ解除、シークレットの取得、およびキーとシークレット (およびそのバージョン) の一覧表示。
- 結果として 401 応答が発生する、認証されていない要求。 たとえば、ベアラー トークンを持たない要求、形式が正しくない要求、有効期限切れの要求、または無効なトークンを持つ要求です。

ログ情報にアクセスできるのは Key Vault の操作を行ってから 10 分以内です。 ストレージ アカウントでのログの管理はお客様に委ねられます。

- ログにアクセスできるユーザーを制限することでログのセキュリティを保護するには、標準的な Azure アクセス制御方法を使用します。
- ストレージ アカウントに保持する必要がなくなったログは削除します。

ストレージ アカウントを完全に管理するための推奨事項については、「[Azure Storage セキュリティ ガイド](../../storage/blobs/security-recommendations.md)」を参照してください。

## <a name="next-steps"></a>次の手順

- [Azure Key Vault の仮想ネットワーク サービス エンドポイント](overview-vnet-service-endpoints.md)
- [RBAC:組み込みのロール](../../role-based-access-control/built-in-roles.md)に関するページを参照してください。

