---
title: Project Acoustics Unity ベイク チュートリアル
titlesuffix: Azure Cognitive Services
description: このチュートリアルでは、Unity の Project Acoustics での音響ベイクについて説明します。
services: cognitive-services
author: NoelCross
manager: nitinme
ms.service: cognitive-services
ms.subservice: acoustics
ms.topic: tutorial
ms.date: 03/20/2019
ms.author: noelc
ROBOTS: NOINDEX
ms.openlocfilehash: 310decf8053ea16ba46250ba3aabe81c9c254e5e
ms.sourcegitcommit: 824e3d971490b0272e06f2b8b3fe98bbf7bfcb7f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/10/2019
ms.locfileid: "72243122"
---
# <a name="project-acoustics-unity-bake-tutorial"></a>Project Acoustics Unity ベイク チュートリアル
このチュートリアルでは、Unity の Project Acoustics を使用した音響ベイクについて説明します。

ソフトウェア要件:
* [Unity 2018.2 以上](https://unity3d.com) (Windows または MacOS)
* [Unity プロジェクトに統合されている Project Acoustics プラグイン](unity-integration.md)または[Project Acoustics Unity のサンプル コンテンツ](unity-quickstart.md)
* *省略可能:* クラウド コンピューティングを使用してベイクを高速化するための [Azure Batch アカウント](create-azure-account.md)

## <a name="open-the-project-acoustics-bake-window"></a>Project Acoustics ベイク ウィンドウを開く
Unity で、 **[Window]\(ウィンドウ\)** メニューの **[Acoustics]\(音響\)** を選択します。

![[Window]\(ウィンドウ\) メニューの [Acoustics]\(音響\) オプションが強調表示されている Unity エディター](media/window-acoustics.png)

## <a name="create-a-navigation-mesh"></a>ナビゲーション メッシュの作成
Project Acoustics ではナビゲーション メッシュを使用して、シミュレーションのためにリスナー プローブ ポイントを配置します。 Unity の[ナビゲーション メッシュ ワークフロー](https://docs.unity3d.com/Manual/nav-BuildingNavMesh.html)を使用できます。 または、別の 3D モデリング パッケージを使用して独自のメッシュを設計することもできます。

## <a name="mark-acoustic-scene-objects"></a>音響シーン オブジェクトをマークする
Project Acoustics は、シミュレーションを次の 2 種類のシーン オブジェクトに依存しています。
- シミュレーションで音を反射して遮るオブジェクト
- シミュレーションでリスナー プローブ ポイントを制限するプレーヤー ナビゲーション メッシュ

どちらのオブジェクトの種類も、 **[Objects]\(オブジェクト\)** タブを使用してマークします。

オブジェクトのマーキングでは *AcousticsGeometry* または *AcousticsNavigation* コンポーネントをオブジェクトに追加するだけであるため、[標準的な Unity コンポーネント ワークフロー](https://docs.unity3d.com/Manual/UsingComponents.html)を使用して、オブジェクトをマーク/マーク解除することもできます。 マークできるのは、メッシュ レンダラーと地形だけです。 他のすべてのオブジェクトの種類は無視されます。 チェック ボックスでは、影響を受けるすべてのオブジェクトがマークまたはマーク解除されます。

### <a name="mark-acoustic-occlusion-and-reflection-geometry"></a>音響オクルージョンとリフレクション ジオメトリをマークする
**[Acoustics]** ウィンドウの **[Objects]\(オブジェクト\)** タブを開きます。 オブジェクトが音を遮る、反射する、または吸収する場合は、オブジェクトを*音響ジオメトリ*としてマークします。 音響ジオメトリには、地面、壁、屋根、窓と窓ガラス、ラグ、大型家具などを含めることができます。 これらのオブジェクトには任意のレベルの複雑さを使用できます。 シーンはシミュレーションの前にボクセル化されているため、リーフを数多く含むツリーといった非常に詳細なメッシュでも、簡略化されたオブジェクトよりもベイクにかかる費用が少なくて済みます。

目に見えない衝突メッシュなど、音響に影響しないものは含めないでください。

プローブ計算時のオブジェクトの変換 ( **[Probes]\(プローブ\)** タブを使用) は、ベイクの結果で修正されます。 シーン内のマークされたオブジェクトを後で移動する場合は、プローブの計算とベイクを再度行う必要があります。

### <a name="mark-the-navigation-mesh"></a>ナビゲーション メッシュをマークする
Unity のワークフローを使用して作成されたナビゲーション メッシュは、音響システムによって取得されます。 独自のメッシュを使用するには、 **[Objects]\(オブジェクト\)** タブからマークします。

### <a name="for-reference-the-objects-tab-parts"></a>参照用:[Objects]\(オブジェクト\) タブの各部
タブ ページの各部分は次のとおりです (説明の後に図があります)。

1. タブ選択ボタン ( **[Objects]\(オブジェクト\)** タブが選択されています)。 これらのボタンを使用して、音響ベイクを実行するためのさまざまな手順を進めます (左から右へ)。
1. このタブを使用して行えることの簡単な説明。
1. 階層ウィンドウで使用可能なフィルター。 これらのオプションを使用して、階層ウィンドウをフィルター処理し、指定した種類のオブジェクトだけを表示することで、それらのオブジェクトを簡単にマークできます。 音響のオブジェクトをまだマークしていない場合、最後の 2 つのオプションを選択しても何も表示されません。 ただし、これらのオプションは、マークされた後のオブジェクトを見つけるのに役立ちます。
1. オブジェクトが選択されていない場合、このセクションにはシーン内のすべてのオブジェクトの状態が表示されます。
    * 合計: 非表示になっていないアクティブなオブジェクトの総数。
    * [Ignored]\(無視\): メッシュ レンダラー地形以外のオブジェクトの数。
    * [Mesh]\(メッシュ\): メッシュ レンダラー オブジェクトの数。
    * [Terrain]\(地形\): 地形オブジェクトの数。
    * [Geometry]\(ジオメトリ\): **[Acoustics Geometry]\(音響ジオメトリ\)** としてマークされた、メッシュ オブジェクトまたは地形オブジェクトの数。
    * [Navigation]\(ナビゲーション\): **[Acoustics Navigation]\(音響ナビゲーション\)** としてマークされた、メッシュ オブジェクトまたは地形オブジェクトの数。 この数には、Unity の NavMesh は含まれません。
1. シーン内の "マーク可能な" オブジェクトの総数。メッシュ レンダラーと地形のみです。 チェック ボックスを使用して、これらのオブジェクトを音響のジオメトリまたはナビゲーションとしてマーク (オブジェクトに適切なコンポーネントを追加) します。
1. 何も選択されていない場合、この注記では、必要に応じて、マークするオブジェクトを選択するようユーザーに促します。 いずれか一方または両方のチェック ボックスをオンにすると、シーン内のすべてのオブジェクトをマークできます。
1. オブジェクトが選択されている場合、このセクションには選択されているオブジェクトの状態だけが表示されます。
1. 選択されている "マーク可能な" オブジェクトの総数。 チェック ボックスをオンまたはオフにすると、選択されているオブジェクトのみがマークまたはマーク解除されます。

シーンで何も選択していない場合、 **[Objects]\(オブジェクト\)** タブは次の図のようになります。

![何も選択されていない [Acoustics]\(音響\) の [Objects]\(オブジェクト\) タブ](media/objects-tab-no-selection-detail.png)

シーンまたは階層ウィンドウで何かを選択している場合は、タブは次の図のようになります。

![選択されている [Acoustics]\(音響\) の [Objects]\(オブジェクト\) タブ](media/objects-tab-selection-detail.png)

マークされているオブジェクトとマークされていないオブジェクトがある場合、次の図のように、該当するチェック ボックスに "混在" を示す値が表示されます。

![混在を示す選択アイコンが強調して示されている [Acoustics]\(音響\) の [Objects]\(オブジェクト\) タブ](media/mixed-object-selection-detail.png)

チェック ボックスをオンにすると、すべての項目がマークされます。 オフにすると、すべてのオブジェクトがマーク解除されます。

ジオメトリとナビゲーションの両方でオブジェクトをマークできます。

## <a name="select-acoustic-materials"></a>音響マテリアルを選択する
オブジェクトをマークした後、 **[Materials]\(マテリアル\)** ボタンを選択します。 その後、音響マテリアルを割り当てます。 Project Acoustics のマテリアル システムは、Unity のビジュアル マテリアル システムに関連付けられています。 2 つのオブジェクトに別の音響マテリアルを割り当てるには、別のビジュアル マテリアルにする必要があります。

音響マテリアルの選択により、各サーフェスから反射される音エネルギーの量が決まります。 既定の音響マテリアルの吸音は鉄鋼に似ています。 Project Acoustics では、ビジュアル マテリアル名に基づいてマテリアルが提案されます。 音響マテリアルの**カスタム**をマテリアルに割り当てて、吸収係数スライダーをアクティブにして調整可能にすることもできます。

室内の特定のマテリアルの残響時間は、その吸収係数に反比例します。 ほとんどのマテリアルの吸収値は、0.01 から 0.20 の範囲です。 吸収係数がこの範囲外の場合、非常に吸収性が高いマテリアルです。

![吸収係数と残響時間の逆相関を示すグラフ。](media/reverb-time-graph.png)

### <a name="for-reference-parts-of-the-materials-tab"></a>参照用:[Materials]\(マテリアル\) タブの各部
![Unreal の [Acoustics]\(音響\) の [Materials]\(マテリアル\) タブ](media/materials-tab-detail.png)
1. **[Materials]\(マテリアル\)** ボタンを選択すると、このタブが表示されます。
2. このタブを使用して行えることの簡単な説明。
3. このチェック ボックスをオンにすると、 **[Acoustics Geometry]\(音響ジオメトリ\)** としてマークされたオブジェクトで使用されるマテリアルだけが一覧表示されます。 それ以外の場合は、シーンで使用されているすべてのマテリアルが一覧表示されます。
4. これらのオプションを使用して、 **[Acoustics]\(音響\)** 列 (6) のメニューのオプションの順序を変更します。 音響マテリアルを、 **[Name]\(名前\)** の順、または **[Absorptivity]\(吸収率\)** の低いものから高いものの順に、並べ替えます。
5. シーンで使用されているマテリアルの、アルファベット順に並べ替えられた一覧。 **[Show Marked Only]\(マークされているオブジェクトのみを表示\)** チェック ボックス (3) をオンにすると、 **[Acoustics Geometry]\(音響ジオメトリ\)** としてマークされたオブジェクトで使用されるマテリアルだけが表示されます。 ここでマテリアルを選択すると、シーン内のそのマテリアルを使用するすべてのオブジェクトが選択されます。
6. シーン マテリアルが割り当てられている音響マテリアル。 いずれかの項目を選択すると、そのシーン マテリアルに割り当てられている音響マテリアルが変更されます。 これらのメニューの並べ替え順序を変更するには、 **[Sort Acoustics By]\(音響の並べ替え\)** オプション (4) を使用します。
7. 左側の列 (6) で選択されているマテリアルの吸音係数。 値 0 は完全に反射する (吸収しない) ことを意味し、1 は完全に吸収する (反射しない) ことを意味します。 選択したマテリアルが **[Custom]\(カスタム\)** である場合を除き、吸収係数を変更することはできません。
8. **[Custom]\(カスタム\)** としてマークされたマテリアルでは、スライダーがアクティブ化されます。 スライダーを移動するか、値を入力して、吸収係数を割り当てることができます。

## <a name="calculate-and-review-listener-probe-locations"></a>リスナー プローブの場所を計算して確認する
マテリアルを割り当てたら、 **[Probes]\(プローブ\)** タブに切り替えます。 **[Calculate]\(計算\)** を選択して、シミュレーションのリスナー プローブ ポイントを配置します。

### <a name="what-the-calculate-button-does"></a>[Calculate]\(計算\) ボタンの機能
**[Calculate]\(計算\)** ボタンでは、選択した音響シーン ジオメトリを使用して、シミュレーションのためのシーンを準備します。

- シーン メッシュからジオメトリが取得され、"*ボクセル体積*" が計算されます。 ボクセル体積は、小さな立方体の "ボクセル" で構成されるシーン全体の体積です。 ボクセルのサイズは、 **[Simulation Resolution]\(シミュレーションの分解能\)** の設定によって制御されるシミュレーションの周波数によって決まります。 各ボクセルは、"オープン エア" またはシーン ジオメトリを含むものとしてマークされます。 ボクセルにジオメトリが含まれている場合、ボクセルはそのジオメトリに割り当てられたマテリアルの吸収係数でタグ付けされます。
- ナビゲーション メッシュを使用して、リスナー プローブ ポイントを配置します。 アルゴリズムによって、空間的な範囲、シミュレーション時間、ファイル サイズの競合に関する配慮のバランスが取られます。 狭い廊下と小さいスペースに常にある程度の範囲を持たせるためのものです。 一般的なプローブ ポイントでは、小さいシーンの 100 から大きいシーンの数千の範囲でカウントされます。

シーンのサイズやコンピューターの速度によっては、これらの計算に数分かかることがあります。

### <a name="review-voxel-and-probe-placement"></a>ボクセルとプローブの配置を確認する
ボクセル データとプローブ ポイントの両方の位置をプレビューし、シーンのベイク準備ができたことを確認します。 不完全なナビゲーション メッシュや欠落または余分な音響ジオメトリは、通常、プレビューで簡単に確認できます。 **[Gizmos]\(ギズモ\)** メニューを使用して、ボクセルとプローブの配置を有効または無効にします。

![Unity の [Gizmos]\(ギズモ\) メニュー](media/gizmos-menu.png)

音響ジオメトリを含むボクセルは、緑色のキューブとして表示されます。 シーンを調べ、ジオメトリである必要があるすべてのものにボクセルがあることを確認します。 シーン カメラは、ボクセルが示すオブジェクトから約 5 メートル以内に存在する必要があります。

粗分解能と細分解能で作成されたボクセルを比較すると、粗いボクセルは 2 倍の大きさになります。

![Unity エディターの粗いボクセル プレビュー](media/voxel-cubes-preview.png)

実行時にリスナー プローブ ポイントの位置の間でシミュレーション結果が補間されます。 シーン内でプレーヤーが移動すると予想されるあらゆる場所の近くにプローブ ポイントがあることを確認します。

![Unity エディターのプローブ プレビュー](media/probes-preview.png)

### <a name="take-care-with-scene-renames"></a>シーンの名前を変更する場合は注意が必要
シーン名は、プローブ ポイントの配置とボクセル化が保存されているファイルにシーンを接続するために使用されます。 プローブ ポイントの計算後にシーン名を変更すると、マテリアルの割り当てと配置データが失われるので、再実行する必要があります。

### <a name="for-reference-parts-of-the-probes-tab"></a>参照用:[Probes]\(プローブ\) タブの各部
![Unity の [Acoustics]\(音響\) の [Probes]\(プローブ\) タブ](media/probes-tab-detail.png)

1. **[Probes]\(プローブ\)** ボタンを選択すると、このタブが表示されます。
2. このタブで行えることの簡単な説明。
3. これらのオプションを使用して、シミュレーションの分解能を粗くするか細かくするかを設定します。 粗い方が高速ですが、トレードオフがあります。 詳細については、[ベイク精度](bake-resolution.md)に関する記事を参照してください。
4. 音響データ ファイルを配置する場所を指定します。 **[...]** ボタンを選択すると、フォルダー ピッカーが表示されます。 既定の場所は *Assets/AcousticsData* です。 この場所には、*Editor* サブフォルダーも作成されます。 詳細については、後の「[ベイク プロセスで追加されたデータ ファイル](#Data-Files)」を参照してください。
5. ここで指定したプレフィックスを使用して、このシーンのデータ ファイルに名前が付けられます。 既定値は "Acoustics_<*シーン名*>" です。
6. プローブが計算された後、ここで説明したコントロールは無効になります。 **[Clear]\(クリア\)** ボタンを選択すると計算が消去され、新しい設定を使用して再計算できるようにコントロールが有効になります。
7. **[Calculate]\(計算...\)** を選択すると、シーンがボクセル化され、プローブ ポイントの位置が計算されます。 計算は、コンピューター上でローカルに実行されます。 ベイクを実行する前に行う必要があります。

このバージョンの Project Acoustics では、プローブを手動で配置することはできません。 **[Probes]\(プローブ\)** タブの自動プロセスを使用します。

粗分解能と細分解能の詳細については、[ベイク精度](bake-resolution.md)に関する記事を参照してください。

## <a name="bake-your-scene-by-using-azure-batch"></a>Azure Batch を使用してシーンをベイクする
Azure Batch サービスを使用して、クラウド内のコンピューティング クラスターでシーンをベイクすることができます。 Project Acoustics Unity プラグインは Azure Batch に直接接続され、ベイク処理ごとに Azure Batch クラスターがインスタンス化、管理、破棄されます。 **[Bake]\(ベイク\)** タブで、Azure の資格情報を入力し、クラスター マシンのタイプとサイズを選択してから、 **[Bake]\(ベイク\)** を選択します。

### <a name="for-reference-parts-of-the-bake-tab"></a>参照用:[Bake]\(ベイク\) タブの各部
![Unity の [Acoustics]\(音響\) の [Bake]\(ベイク\) タブ](media/bake-tab-details.png)

1. **[Bake]\(ベイク\)** ボタンを選択すると、このタブが表示されます。
2. このページで行えることの簡単な説明。
3. Azure アカウントが作成された後、Azure 資格情報をこれらのフィールドに入力します。 詳細については、「[Azure Batch アカウントを作成する](create-azure-account.md)」をご覧ください。
4. Acoustics ツールセット用の Docker イメージ タグ フィールド。
5. Azure portal を開き、サブスクリプションの管理、使用状況の監視、課金情報の表示を行います。
6. 計算に使用する Azure Batch コンピューティング ノードのタイプを指定します。 ノードのタイプは、ご利用の Azure データ センターの場所でサポートされている必要があります。 不明な場合は、 **[Standard_F8s_v2]** のままにしておきます。
7. 計算に使用するノードの数。 この数は、ベイク時間に影響します。 Azure Batch でのコアの割り当てによって制限されます。 既定の割り当てで使用できるのは、2 つの 8 コア ノードまたは 1 つの 16 コア ノードだけですが、既定の割り当ては拡張できます。 コアの割り当ての制約の詳細については、「[Azure Batch アカウントを作成する](create-azure-account.md)」をご覧ください。
8. [優先順位の低いノード](https://docs.microsoft.com/azure/batch/batch-low-pri-vms)を使用するようにコンピューティング プールを構成するには、このチェック ボックスをオンにします。 優先順位の低いコンピューティング ノードを使用すると、コストが大幅に削減されます。 ただし、常に使用できるとは限らず、いつでも割り込まれる可能性があります。
9. **[Probes]\(プローブ\)** タブで計算されたシーンのプローブ数。プローブの数によって、クラウドで実行する必要があるシミュレーションの数が決まります。 プローブよりも多くのノードを指定することはできません。
10. ノードの起動時間を除く、クラウドでのジョブの実行にかかる時間の見積もり。 ジョブの実行の開始後は、このフィールドには、結果が返されるまでの時間の見積もりが表示されます。
11. シミュレーションを実行するために必要なコンピューティング時間の合計。 この値は、Azure で使用されるノードのコンピューティング時間の合計です。 詳細については、後の「[Azure のベイク コストを見積もる](#Estimating-bake-cost)」を参照してください。
12. このメッセージでは、ジョブの完了後に、ベイクの結果が保存される場所がユーザーに通知されます。
13. *(高度な用途専用:)* このボタンを選択すると、送信済みのベイクの情報が Unity で強制的に破棄されます。 たとえば、別のコンピューターを使用して結果をダウンロードした場合、 **[Clear State]\(状態のクリア\)** ボタンを選択してそのジョブを破棄します。 結果ファイルは、準備ができていても、ダウンロード "*されません*"。 "*これは、ジョブの取り消しと同じではありません。実行中のジョブはクラウドで引き続き実行されます。* "
14. このボタンを選択すると、ベイクがクラウドに送信されます。 ジョブの実行中、このボタンは **[Cancel Job]\(ジョブの取り消し\)** になります。
15. このボタンを選択すると、[PC での音響シミュレーション](#Local-bake)の処理が準備されます。
16. この領域にはベイクの状態が表示されます。 ベイクが完了すると、"Downloaded" (ダウンロード済み) と表示されます。

アクティブなジョブ、コンピューティング プール、ストレージに関する完全な情報は、[Azure portal](https://portal.azure.com) でいつでも入手できます。

ジョブの実行中は、 **[Bake]\(ベイク\)** ボタンのラベルが **[Cancel Job]\(ジョブの取り消し\)** に変わります。 このボタンを使用して、進行中のジョブを取り消すことができます。 確認するように求められます。 ジョブの取り消しを元に戻すことはできません。 取り消すと、結果は使用できなくなりますが、使用された Azure のコンピューティング時間は引き続き課金されます。

ベイクを開始したら、Unity を閉じてかまいません。 プロジェクト、ノードのタイプ、ノード数によっては、クラウド ベイクに数時間かかることがあります。 プロジェクトを再度読み込んで Acoustics ウィンドウを開くと、ベイク ジョブの状態が更新されます。 ジョブが完了すると、出力ファイルがダウンロードされます。

セキュリティのため、Azure 資格情報はローカル コンピューターに保存され、Unity エディターに関連付けられます。 これらは、Azure へのセキュリティで保護された接続を確立する目的でのみ使用されます。

## <a name="find-the-status-of-a-running-job-on-the-azure-portal"></a>実行中のジョブの状態を Azure portal で調べる

1. **[bake]\(ベイク\)** タブでベイク ジョブ ID を探します。

    ![強調して示されている、[bake]\(ベイク\) タブの Unity ベイク ジョブ ID](media/unity-job-id.png)  

2. [Azure portal](https://portal.azure.com) を開き、ベイクに使用された Batch アカウントに移動して **[ジョブ]** を選択します。

    ![Azure portal でのジョブのリンク](media/azure-batch-jobs.png)  

3. ジョブの一覧でジョブ ID を検索します。

   ![強調して示されている Azure portal でのベイク ジョブの状態](media/azure-bake-job-status.png)  

4. ジョブ ID を選択すると、関連するタスクの状態と全体的なジョブの状態が表示されます。

   ![ベイク タスクの状態](media/azure-batch-task-state.png)  


### <a name="Estimating-bake-cost"></a> Azure のベイク コストを見積もる

ベイクのコストを見積もるには、 **[Estimated Compute Cost]\(推定コンピューティング コスト\)** の値 (時間) から始めます。 その値に、選択した **VM ノード タイプ**の現地通貨での時間あたりコストを掛けます。 結果にはノードを稼働させるために必要なノード時間は含まれないことに注意してください。

たとえば、ノード タイプとして、時間あたりのコストが 0.40 ドルの **Standard_F8s_v2** を選択するとします。 **Estimated Compute Cost\(推定コンピューティング コスト\)** が 3 時間 57 分の場合、ジョブを実行するための推定コストは、"0.40 ドル * 最大 4 時間 = 最大 1.60 ドル" になります。 実際のコストは、ノードの起動に余分な時間がかかるため、少し高くなる可能性があります。

ノードの時間あたりコストについては、「[Batch の価格](https://azure.microsoft.com/pricing/details/virtual-machines/linux)」をご覧ください。 (カテゴリとして、 **[コンピューティングの最適化]** または **[ハイ パフォーマンス コンピューティング]** を選択します。)

## <a name="Local-bake"></a> PC でシーンをベイクする
独自の PC でシーンをベイクすることもできます。 この方法は、Azure Batch アカウントを作成する前に、小さいシーンで音響を実験するのに役立つ場合があります。 ただし、シーンのサイズによっては、ローカル音響シミュレーションに時間がかかる場合があることに注意してください。

### <a name="minimum-hardware-requirements"></a>最小ハードウェア要件
* x86-64 プロセッサ。少なくとも 8 個のコアと 32 GB の RAM
* Docker を実行するためには [Hyper-V 対応](https://docs.microsoft.com/virtualization/hyper-v-on-windows/quick-start/enable-hyper-v)であること

たとえば、テストでは、8 コアのマシンに 3 GHz の Intel Xeon E5-1660 と 32 GB 以上の RAM を備えたものが必要です
* 100 プローブの小さいシーンでは、粗ベイクの場合に約 2 時間、細ベイクの場合に 32 時間かかりました。
* 1000 プローブの中規模のシーンでは、粗ベイクの場合に約 20 時間、細ベイクの場合に 21 日かかりました。

### <a name="set-up-docker"></a>Docker を設定する
シミュレーションを処理する PC 上に Docker をインストールして構成します。
1. [Docker Desktop](https://www.docker.com/products/docker-desktop) をインストールします。
2. Docker の設定を開き、 **[Advanced]\(詳細\)** に移動して、少なくとも 8 GB の RAM でリソースを構成します。 Docker に CPU を多く割り当てると、ベイクの実行速度は上がります。  
![Docker 設定の例](media/docker-settings.png)
1. **[Shared Drives]\(共有ドライブ\)** に移動し、処理に使用されるドライブの共有を有効にします。  
![Docker 共有ドライブ オプション](media/docker-shared-drives.png)

### <a name="run-the-local-bake"></a>ローカル ベイクを実行する
1. **[Bake]\(ベイク\)** タブで **[Prepare Local Bake]\(ローカル ベイクの準備\)** ボタンを選択します。次に、入力ファイルと実行スクリプトの保存先フォルダーを選択します。 ハードウェアの最小要件を満たしており、そのマシンにフォルダーをコピーして Docker がインストールされていれば、どのマシンでもベイクを実行できます。
2. シミュレーションを開始するには、Windows では *runlocalbake.bat* スクリプトを実行し、MacOS では *runlocalbake.sh* スクリプトを実行します。 このスクリプトでは、シミュレーションの処理に必要なツールセットで Project Acoustics Docker イメージがフェッチされて、シミュレーションが開始されます。
3. シミュレーションが終了したら、結果の *.ace* ファイルを Unity プロジェクトにコピーします。 Unity にそれをバイナリ ファイルとして確実に認識させるには、".bytes" をファイル拡張子に追加します ("Scene1.ace.bytes" などとします)。 シミュレーションの詳細ログは、*AcousticsLog.txt* に格納されます。 問題が発生した場合は、このファイルを調べると問題の診断に役立ちます。

## <a name="Data-Files"></a> ベイク プロセスで追加されたデータ ファイル

ベイク プロセスの間に、次の 4 つのデータ ファイルが作成されます。 1 つにはシミュレーション結果が含まれ、タイトルが付いています。 その他には Unity エディターに関するデータが格納されています。

シミュレーション結果:
* *Assets/AcousticsData/Acoustics\_[SceneName].ace.bytes*:このファイルは実行時ルックアップ テーブルです。 シミュレーション結果とボクセル化された音響シーン要素が含まれています。 このファイルの名前と場所は、**Probes\(プローブ\)** タブで変更できます。

   "*シミュレーション結果のファイルを削除しないように注意してください。これはシーンを再ベイクしない限り、回復できません。* "

エディターのデータ ファイル:
* *Assets/Editor/[SceneName]\_AcousticsParameters.asset*:このファイルには、ユーザーが Acoustics UI のフィールドに入力したデータが格納されます。 このファイルの名前と場所を変更することはできません。
* *Assets/AcousticsData/Editor/Acoustics_[SceneName].vox*:このファイルにはボクセル化された音響ジオメトリとマテリアル プロパティが格納されます。これらは、 **[Probes]\(プローブ\)** タブの **[Calculate]\(計算\)** ボタンを選択すると計算されます。このファイルの名前と場所は、**Probes\(プローブ\)** タブで変更できます。
* *Assets/AcousticsData/Editor/Acoustics\_[SceneName]\_config.xml*:このファイルには、 **[Calculate]\(計算\)** を選択すると計算されるシミュレーション パラメーターが格納されます。 このファイルの名前と場所は、**Probes\(プローブ\)** タブで変更できます。

## <a name="set-up-the-acoustics-lookup-table"></a>音響ルックアップ テーブルの設定
プロジェクト パネルからシーンに **[Project Acoustics]** プレハブをドラッグます。

![Unity の Acoustics プレハブ](media/acoustics-prefab.png)

**ProjectAcoustics** ゲーム オブジェクト選択して、そのインスペクター パネルに移動します。 ベイク結果の場所を指定します (*Assets/AcousticsData* の .ace ファイル)。それを Acoustics Manager スクリプトにドラッグするか、テキスト ボックスの横にある円ボタンを選択します。

![Unity の Acoustics Manager プレハブ](media/acoustics-manager.png)

## <a name="next-steps"></a>次の手順
* [Unity の設計コントロール](unity-workflow.md)を確認します。
* [Project Acoustics の設計概念](design-process.md)を確認します。
