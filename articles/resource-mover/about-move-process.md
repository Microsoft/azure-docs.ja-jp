---
title: Azure Resource Mover の移動プロセスについて
description: Azure Resource Mover を使用してリージョン間でリソースを移動するプロセスについて説明します
author: rayne-wiselman
manager: evansma
ms.service: resource-move
ms.topic: overview
ms.date: 02/01/2021
ms.author: raynew
ms.openlocfilehash: 6eba77e1af2cd1a038f2ebd61a85ccd03b9a0741
ms.sourcegitcommit: 3ee3045f6106175e59d1bd279130f4933456d5ff
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/31/2021
ms.locfileid: "106074456"
---
# <a name="about-the-move-process"></a>移動プロセスについて

[Azure Resource Mover](overview.md) は、Azure リージョン間で Azure リソースを移動するのに役立ちます。 この記事では、Resource Mover によって使用されるコンポーネントの概要と、移動プロセスについて説明します。 


## <a name="components"></a>コンポーネント

これらのコンポーネントは、リージョン移動中に使用されます。

**コンポーネント** | **詳細**
--- | ---
**Resource Mover** |  Resource Mover は、[Azure リソース プロバイダー](../azure-resource-manager/management/resource-providers-and-types.md)と連携して、リージョン間でのリソースの移動を調整します。 Resource Mover は、リソースの依存関係を分析し、移動プロセス中のリソースの状態を維持および管理します。 
**移動コレクション** |  移動コレクションは [Azure Resource Manager](../azure-resource-manager/management/overview.md) のオブジェクトです。<br/><br/> 移動コレクションは、サブスクリプション内のソースとターゲット リージョンのペアの組み合わせごとに、リージョンの移動プロセス中に作成されます。 このコレクションには、移動するリソースに関するメタデータと構成情報が格納されます。<br/><br/>移動コレクションに追加されたリソースは、同じサブスクリプション内に存在する必要がありますが、異なるリソース グループに存在することができます。 
**移動リソース** | リソースを移動コレクションに追加すると、Resource Mover によって移動リソースとして追跡されます。<br/><br/> Resource Mover は、移動コレクション内のすべての移動リソースに関する情報を保持し、ソースとターゲット リソースの間の 1 対 1 の関係を維持します。 
**依存関係** | Resource Mover は、コレクションに追加されたリソースを検証し、移動コレクションに含まれていない依存関係がリソースにあるかどうかを確認します。<br/><br/> リソースの依存関係を特定したら、それらの依存関係を移動コレクションに追加して移動することも、ターゲット リージョンで別の既存のリソースを選択することもできます。 移動を開始する前に、すべての依存関係を解決する必要があります。 



## <a name="move-region-process"></a>リージョンの移動プロセス 

![移動の手順を示す図](./media/about-move-process/move-steps.png)

各移動リソースは、要約された手順を経て処理されます。

| **Step** | **詳細** | **状態/問題** |
| --- | --- | --- |
| **ステップ 1:リソースの選択** | リソースを選択します。 リソースが移動コレクションに追加されます。 | リソースの状態は、"*準備が保留中*" に移行します。<br/><br/> リソースに依存関係がある場合、"*依存関係の検証*" は、依存リソースを移動コレクションに追加する必要があることを示します。 |
| **手順 2:依存関係の検証** | 検証プロセスを開始します。<br/><br/> 依存リソースが保留中であることが検証によって示された場合は、それらを移動コレクションに追加します。 <br/><br/> 移動したくない場合でも、すべての依存リソースを追加してください。 移動するリソースがターゲット リージョンで代わりに異なるリソースを使用するように、後で指定することができます。<br/><br/> 未処理の依存関係がなくなるまで、検証を繰り返してください。 | すべての依存関係が追加され、検証が成功すると、リソースの状態は問題なく "*準備が保留中*" に移行します。 |
| **手順 1:準備** | 準備プロセスを開始します。 準備手順は、移動するリソースによって異なります。<br/><br/> - **ステートレス リソース**:ステートレス リソースには構成情報のみが含まれます。 これらのリソースは、移動するためにデータの継続的なレプリケーションを必要としません。 例として、Azure 仮想ネットワーク (VNet)、ネットワーク アダプター、ロード バランサー、ネットワーク セキュリティ グループなどがあります。 この種類のリソースの場合、準備プロセスにより Azure Resource Manager テンプレートが生成されます。<br/><br/> - **ステートフル リソース**:ステートフル リソースには、構成情報と、移動する必要があるデータの両方が含まれます。 たとえば、Azure VM や Azure SQL データベースなどがあります。 準備プロセスは、リソースごとに異なります。 ソース リソースをターゲット リージョンにレプリケートすることが含まれる場合があります。 | 開始すると、リソースの状態は "*準備が進行中*" に移行します。<br/><br/> 準備が完了すると、リソースの状態は問題なく "*移動の開始が保留中*" に移行します。<br/><br/> プロセスが失敗すると、状態は "*準備が失敗*" に移行します。 |
| **手順 4:移動の開始** | 移動プロセスを開始します。 移動方法はリソースの種類によって異なります。<br/><br/> - **ステートレス**:通常、ステートレス リソースの場合、移動プロセスにより、インポートされたテンプレートがターゲット リージョンにデプロイされます。 このテンプレートは、ソース リソースの設定と、ターゲット設定に対して行った手動の編集に基づいています。<br/><br/> - **ステートフル**:ステートフル リソースの場合、移動プロセスには、ターゲット リージョンでのリソースの作成、またはコピーの有効化が含まれることがあります。<br/><br/>  ステートフル リソースの場合のみ、移動を開始するとソース リソースのダウンタイムが発生する可能性があります。 たとえば、VM や SQL などです。 | 移動を開始すると、状態は "*移動の開始が進行中*" に移行します。<br/><br/> 移動の開始が成功すると、リソース状態は問題なく "*移動のコミットが保留中*" に移行します。 <br/><br/> 移動プロセスが失敗した場合は、状態は "*移動の開始が失敗*" に移行します。 |
| **手順 5、オプション 1:移動の破棄** | 最初の移動後に、完全な移動を行うかどうかを決定できます。 そうしない場合は、移動を破棄することができ、Resource Mover はターゲットで作成されたリソースを削除します。 ステートフル リソースのレプリケーション プロセスは、破棄プロセス後も続行されます。 このオプションは、テストに役立ちます。 | リソースを破棄すると、状態は "*破棄が進行中*" に移行します。<br/><br/> 破棄が成功すると、状態は問題なく "*移動の開始が保留中*" に移行します。<br/><br/> 破棄が失敗すると、状態は "*移動の破棄に失敗*" に移行します。 |
| **手順 5、オプション 2:移動のコミット** | 最初の移動後に、完全な移動を行う場合は、ターゲット リージョンのリソースを確認し、準備ができたら移動をコミットします。<br/><br/> ステートフル リソースの場合のみ、コミットによって、VM や SQL などのソース リソースにアクセスできなくなる可能性があります。 | 移動をコミットすると、リソースの状態は *移動のコミットが進行中** に移行します。<br/><br/> コミットが成功すると、リソースの状態は問題なく "*移動のコミットが完了*" と表示されます。<br/><br/> コミットが失敗すると、状態は "*移動のコミットに失敗*" に移行します。 |
| **手順 6:ソースの削除** | 移動をコミットし、ターゲット リージョンのリソースを確認したら、ソース リソースを削除できます。 | コミットした後、リソース状態は "*ソースの削除が保留中*" の状態に移行します。 次に、ソース リソースを選択して削除します。<br/><br/> - 削除できるのは、"*ソースの削除が保留中*" 状態のリソースのみです。 <br/><br/>Resource Mover ポータルでリソース グループや SQL Server を削除することはできません。 これらのリソースの削除は、リソースのプロパティ ページからのみ行うことができます。 |


## <a name="move-region-states"></a>リージョンの移動の状態

移動プロセスには、さまざまな状態と、各状態で発生する可能性がある問題があります。 これらの概要をフローチャートに示します。

![考えられる状態と問題のフローチャート](./media/about-move-process/process.png)


### <a name="dependency-analysis"></a>依存関係の分析

移動プロセスを進めていくと、次の場合に依存関係の検証を求められることがあります。
- リソースが、移動コレクションに含まれていない依存リソースを使用している。
- 移動コレクション内の依存リソースに、移動コレクションに含まれていない独自の依存関係がある。
- リソースのターゲット設定を変更したため、依存関係を再検証する必要がある。


### <a name="remove-resources"></a>リソースの削除

リソースを移動したくない場合は、移動コレクションから削除できます。 一般的に、リソースはその後、レプリケーションや保存されたテンプレートなどの関連するアクションやオブジェクトと共にコレクションから削除されます。 リソースを削除したときに実際に何が起きるかは、リソースの種類と、削除したときのリソースの状態によって異なります。 [詳細については、こちらを参照してください](remove-move-resources.md)。

## <a name="move-impact"></a>移動の影響

次の表は、リージョン間を移動する際の影響の概要を示しています。

**動作** | **複数のリージョン間**
--- | --- | --- 
**データ** | リソース データとメタデータが移動されます。<br/><br/> メタデータは、リソースの依存関係と操作の状態を追跡するために一時的に保存されます。
**リソース** | ソース リソースは、アプリが動作し続けられるようにそのまま維持され、移動後に必要に応じて削除できます。<br/><br/> ターゲット リージョンにリソースが作成されます。
移動プロセス | 手動による介入と監視を必要とする複数ステップのプロセス。
**テスト** | 移動後もアプリがターゲット リージョンで引き続き期待どおりに動作する必要があるため、移動のテストは重要です。
**ダウンタイム**: |  データ損失は予期されませんが、リソースを移動するためのダウンタイムがいくらか予期されます。



## <a name="next-steps"></a>次のステップ

Azure VM を別のリージョンに[移動する](tutorial-move-region-virtual-machines.md)。
Azure SQL リソースを別のリージョンに[移動する](tutorial-move-region-sql.md)。
