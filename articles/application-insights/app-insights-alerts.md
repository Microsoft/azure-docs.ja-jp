---
title: "Azure Application Insights のアラートの設定 | Microsoft Docs"
description: "Web アプリにおける長い応答時間、例外、パフォーマンスまたは使用状況のその他の変化について通知します。"
services: application-insights
documentationcenter: 
author: CFreemanwa
manager: carmonm
ms.assetid: f8ebde72-f819-4ba5-afa2-31dbd49509a5
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 03/14/2017
ms.author: bwren
ms.translationtype: HT
ms.sourcegitcommit: b6c65c53d96f4adb8719c27ed270e973b5a7ff23
ms.openlocfilehash: 78996fdb1bbb9bc2e532f80dc9611efad389119e
ms.contentlocale: ja-jp
ms.lasthandoff: 08/17/2017

---
# <a name="set-alerts-in-application-insights"></a>Application Insights のアラートの設定
[Azure Application Insights][start] では、Web アプリのパフォーマンスまたは使用状況のメトリックの変化についてアラートを発行できます。 

Application Insights は、[さまざまなプラットフォーム][platforms]で実行中のアプリケーションを監視して、パフォーマンスの問題の診断と使用パターンの把握を支援します。

次の 3 種類のアラートがあります。

* **メトリック アラート**は、一定の期間に、メトリックが応答時間、例外の数、CPU 使用率、ページ ビューなどのしきい値を超えたときに通知します。 
* [**Web テスト**][availability]は、サイトがインターネットで使用できなくなったとき、または応答速度が低下したときに通知します。 [Learn more][availability].
* [**プロアクティブ診断**](app-insights-proactive-diagnostics.md)は、通常と異なるパフォーマンス パターンについて通知するよう自動的に構成されます。

この記事では、メトリック アラートについて説明します。

## <a name="set-a-metric-alert"></a>メトリック アラートの設定
[アラート ルール] ブレードを開き、追加ボタンをクリックします。 

![[アラート ルール] ブレードで、[アラートの追加] をクリックします。 測定するリソースとしてアプリケーションを設定し、アラートの名前を指定して、メトリックを選択します。](./media/app-insights-alerts/01-set-metric.png)

* その他のプロパティの前に、リソースを設定します。 **「(コンポーネント)」のリソースを選択** します。
* アラートに付ける名前は、リソース グループ内で (アプリケーション内だけでなく) 一意である必要があります。
* しきい値を入力するように求められたら、単位に注意してください。
* [電子メール所有者] チェック ボックスをオンにすると、このリソース グループへのアクセス権を持つすべてのユーザーにアラートが電子メールで送信されます。 この一連のユーザーを展開するには、(リソースではなく) [リソース グループまたはサブスクリプション](app-insights-resources-roles-access-control.md) にそれらのユーザーを追加します。
* "追加の電子メール" を指定すると、([電子メール所有者] チェック ボックスをオンにしたかどうかにかかわらず) アラートは個人またはグループに送信されます。 
* アラートに応答する Web アプリを設定している場合は、[webhook アドレス](../monitoring-and-diagnostics/insights-webhooks-alerts.md) を設定します。 このアプリは、アラートがアクティブ化されている場合にも、アラートが解決済みの場合にも呼び出されます。 (ただし、現時点でクエリ パラメーターは Webhook プロパティとしては渡されないという点に注意してください)。
* アラートを有効化または無効化にすることができます。ブレードの上部にあるボタンを参照してください。

*[アラートの追加] ボタンが表示されません。* 

* 組織アカウントを使用していることを確認してください。 所有者または投稿者が、アプリケーションのリソースにアクセスする場合に、アラートを設定できます。 アクセス制御ブレードを確認します。 [アクセス制御の詳細情報][roles]。

> [!NOTE]
> アラート ブレードで、アラートが既に設定されていることがわかります。[プロアクティブ診断](app-insights-proactive-failure-diagnostics.md)に関する記事をご覧ください。 自動アラートにより、要求の失敗率というメトリックが監視されます。 プロアクティブ アラートを無効にしない限り、要求失敗率に独自のアラートを設定する必要はありません。 
> 
> 

## <a name="see-your-alerts"></a>アラートの表示
アラートの状態が非アクティブとアクティブとの間で変化すると、メールが送信されます。 

[アラート ルール] ブレードに、各アラートの現在の状態が表示されます。

アラート ボックスの一覧には、最近のアクティビティの概要が表示されます。

![アラートのドロップダウン](./media/app-insights-alerts/010-alert-drop.png)

状態の変更履歴はアクティビティ ログにあります。

![[概要] ブレードで、[設定]、[監査ログ] の順にクリックします](./media/app-insights-alerts/09-alerts.png)

## <a name="how-alerts-work"></a>アラートのしくみ
* アラートには、"アクティブ化なし"、"アクティブ化"、"解決済み" の 3 つの状態があります。 アクティブ化は指定された条件が最後に評価されたときに、true であったことを意味します。
* アラートの状態が変更されると、通知が生成されます (アラートを生成したときにアラートの条件が既に true の場合は、条件が false になるまで通知を取得しない可能性があります)。
* 電子メールのチェック ボックスをオンにした場合、または電子メール アドレスを指定した場合は、通知ごとに電子メールが生成されます。 [通知] ドロップダウン リストで調べることもできます。
* アラートはメトリックが到着するたびに評価されますが、それ以外は評価されません。
* 評価では、前の期間にメトリックが集計され、これをしきい値と比較して新しい状態が決定されます。
* 選択した期間によって、メトリックが集計される間隔が指定されます。 これはアラートが評価される頻度には影響しません。アラートの評価の頻度は、メトリックの到着の頻度に左右されます。
* しばらくの間、特定のメトリックのデータが到着しない場合、このギャップはアラートの評価とメトリック エクスプローラーのグラフにさまざまな影響を及ぼします。 メトリック エクスプローラーでは、グラフのサンプリング間隔よりも長い期間データがない場合、グラフには値 0 が表示されます。 ただし、同じメトリックに基づくアラートは再評価されず、アラートの状態は変更されません。 
  
    データが最終的に到着すると、グラフは 0 以外の値に戻ります。 アラートでは、指定した期間に使用できるデータに基づいて評価が行われます。 その期間に使用できる新しいデータ ポイントが 1 つしかない場合、集計はそのデータ ポイントだけに基づきます。
* 長い期間を設定した場合でも、アラートの状態 (警告状態と正常状態) 遷移が頻繁に発生する場合があります。 これは、メトリック値がしきい値付近で変動している場合に発生する可能性があります。 しきい値にヒステリシスありません。警告状態への切り替えは正常状態への切り替えと同じ値で発生します。

## <a name="what-are-good-alerts-to-set"></a>どのようなアラートを設定するのが適切でしょうか。
これは、アプリケーションごとに異なります。 第一に、多数のメトリックを設定しないことをお勧めします。 通常の動作を把握するために、アプリケーションの実行中に、しばらくの間、メトリックのグラフを観察してください。 これは、パフォーマンスを向上させる方法を見つけるために役立ちます。 次に、メトリックが標準ゾーンを超えた場合に通知するアラートを設定します。 

次のような一般的なアラートがあります。

* [ブラウザー メトリック][client]、特にブラウザー **ページの読み込み時間**は、Web アプリケーションに適しています。 ページに多数のスクリプトがある場合は、**ブラウザーの例外**を探してください。 これらのメトリックとアラートを取得するには、[Web ページの監視][client]を設定する必要があります。
* Web アプリケーションのサーバー側の**サーバー応答時間**。 アラートの設定に加え、このメトリックを監視して、高い要求率でメトリックが過度に変動するかどうかを確認します。この変動は、アプリケーションでリソースが不足していることを示している可能性があります。 
* **サーバー例外** - サーバー例外を表示するには、 [追加のセットアップ](app-insights-asp-net-exceptions.md)を実行する必要があります。

[失敗率のプロアクティブ診断](app-insights-proactive-failure-diagnostics.md)により、アプリケーションがエラー コードで要求に応答する率が自動的に監視されます。 

## <a name="automation"></a>Automation
* [PowerShell を使用したアラートの設定の自動化](app-insights-powershell-alerts.md)
* [webhook を使用したアラートへの対応の自動化](../monitoring-and-diagnostics/insights-webhooks-alerts.md)

## <a name="video"></a>ビデオ

> [!VIDEO https://channel9.msdn.com/events/Connect/2016/112/player]

## <a name="see-also"></a>関連項目
* [可用性 Web テスト](app-insights-monitor-web-app-availability.md)
* [アラートの設定の自動化](app-insights-powershell-alerts.md)
* [プロアクティブ診断](app-insights-proactive-diagnostics.md) 

<!--Link references-->

[availability]: app-insights-monitor-web-app-availability.md
[client]: app-insights-javascript.md
[platforms]: app-insights-platforms.md
[roles]: app-insights-resources-roles-access-control.md
[start]: app-insights-overview.md


