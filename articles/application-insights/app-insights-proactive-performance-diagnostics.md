---
title: "スマート検出 - パフォーマンスの異常 |Microsoft Docs"
description: "Application Insights は、アプリのテレメトリのプロアクティブな分析を実行し、潜在的なパフォーマンスの問題について警告します。 この機能には設定は不要です。"
services: application-insights
documentationcenter: windows
author: antonfrMSFT
manager: douge
ms.assetid: 6acd41b9-fbf0-45b8-b83b-117e19062dd2
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 10/31/2016
ms.author: awills
translationtype: Human Translation
ms.sourcegitcommit: 63c901529b81c75f46f1b21219054817c148063a
ms.openlocfilehash: 1c46c40b09ca1923190d3c7109d25bd7525cb577


---
# <a name="smart-detection---performance-anomalies"></a>スマート検出 - パフォーマンスの異常


[Application Insights](app-insights-overview.md) は、アプリのテレメトリを詳細に分析し、潜在的なパフォーマンスの問題について警告できます。 この記事は、スマート アラートをメールで受信されたユーザーを主に想定しています。

この機能は、設定が不要であり、アプリによって十分なテレメトリが生成されると自動的にアクティブになります。

## <a name="what-is-smart-detection-of-performance-anomalies"></a>パフォーマンスの異常のスマート検出とは何ですか。
スマート検出は、アプリから Application Insights に送信されるテレメトリを分析することで、そのアプリのパフォーマンスの異常なパターンを検出します。

具体的には、一部のユーザーにのみ影響する、または一部のケースでのみユーザーに影響するパフォーマンス上の問題を検出します。

たとえば、あるブラウザーでお使いのアプリケーションのページが他のブラウザーと比較して読み込みが遅い場合や、特定のサーバーからの要求の処理が遅い場合などに通知します。 また、ある地域の特定の時間帯におけるページ読み込みの遅延など、プロパティの組み合わせに関連する問題も検出します。

上記のような異常はデータを調べるだけでは検出は困難ですが、想像以上によく発生します。 多くの場合、お客様からのクレームによってのみ表面化します。 その時点では遅すぎます。影響を受けたユーザーはすぐに競合他社のソリューションに切り替えてしまうからです。

現時点では、このアルゴリズムはページの読み込み時間、サーバーにおける要求の応答時間、および依存関係の応答時間を監視します。  

しきい値規則や構成規則を設定する必要はありません。 異常パターンの検出には、機械学習およびデータ マイニングのアルゴリズムが使用されます。

## <a name="about-the-smart-detection-alert"></a>スマート検出アラートについて
* *この電子メールが送られてきたのはなぜですか。*
  * スマート検出によって、アプリケーションから Application Insights に送信されたテレメトリが分析され、アプリケーションでパフォーマンスの問題が検出されたからです。
* *この通知は、明らかに問題があることを意味していますか。*
  * いいえ。 これは単に、より詳しく確認することを推奨するものです。
* *どうすればよいですか。*
  * [提示されたデータを確認してください](#responding-to-an-alert)。 メトリックス エクスプローラーを使用してパフォーマンスを経時的に見直し、その他のメトリックを調べます。 [検索] を使用して、根本原因の特定に役立つ特定のイベントを除外します。
* *私のデータはマイクロソフトからも見られるのですか。*
  * いいえ。 サービスは完全に自動化されています。 通知を受け取るだけです。 ユーザーのデータは [プライベート](app-insights-data-retention-privacy.md)です。

## <a name="the-detection-process"></a>検出プロセス
* *どのようなパフォーマンスの異常が検出されますか。*
  * ユーザーご自身で確認するには時間がかかるようなパターンが検出されます。 たとえば、場所、時刻、プラットフォームといった特定の組み合わせにおけるパフォーマンスの低下などです。
* *Application Insights によって収集されたすべてのデータが分析されるのですか。*
  * 現時点ではすべてではありません。 現在は、要求の応答時間、依存関係の応答時間、およびページの読み込み時間が分析されます。 その他のメトリックの分析も間もなく行われる予定です。
* *独自の異常検出ルールを作成できますか。*

  * まだありません。 ただし、次のことができます。
  * メトリックがしきい値を超えたときに通知する[アラートを設定](app-insights-alerts.md)する。
  * 自分で分析できるように、[データベース](app-insights-code-sample-export-sql-stream-analytics.md)、[PowerBI](app-insights-export-power-bi.md)、または[その他](app-insights-code-sample-export-telemetry-sql-database.md)のツールに、[テレメトリをエクスポート](app-insights-export-telemetry.md)する。
* *どのくらいの頻度で分析は実行されますか。*

  * 前日のテレメトリの分析が毎日実行されます。
* *これにより、[メトリック アラート](app-insights-alerts.md)が置き換えられるのですか。*
  * いいえ。  異常と見なされる可能性のあるすべての動作を検出することを確約しているわけではありません。

## <a name="how-to-investigate-the-issues-raised"></a>発生した問題を調査する方法
診断レポートは、メールまたは異常リストから開きます。

![メール アラートから、リンクをクリックして Azure で診断レポートを開く](./media/app-insights-proactive-performance-diagnostics/03.png)

* **[日時]** は、問題が検出された日時を示します。
* **[内容]** には、以下が示されます。

  * 検出された問題。
  * 問題の動作が見られたイベント セットの特性。
* パフォーマンスの低いセットと他のすべてのイベントの平均的な動作の比較表。

リンクをクリックしてメトリックス エクスプローラーを開き、パフォーマンスの低いセットの時間とプロパティでフィルターされた関連するレポートで検索を実行します。

時間の範囲とフィルターを変更して、テレメトリを調べます。

## <a name="how-can-i-improve-performance"></a>パフォーマンスを向上させるにはどうすればよいですか。
Web サイト ユーザーにとって最大の不満の 1 つは、自らの経験でわかるように、時間のかかる応答や応答障害です。 したがって、この問題に対処することが重要です。

### <a name="triage"></a>トリアージ
まず、それは重要なことですか。 ページの読み込みには常に時間がかかるが、そのページの閲覧を必要としているユーザーが 1 % にすぎない場合は、多分、他にもっと考えるべき重要なことがあります。 一方、ユーザーの 1% しかそのページを開いていないが、毎回例外がスローされる場合、調べてみる価値はあるでしょう。

一般的なガイドラインとして、電子メールで IMPACT ステートメントを使用します。ただし、それがすべてではありません。 確認すべきその他の証拠を収集します。

問題のパラメーターを検討します。 地理的な場所によって状況が異なる場合は、該当するリージョンを対象とする[可用性テスト](app-insights-monitor-web-app-availability.md)をセットアップします。単にそのエリアのネットワークの問題かもしれません。

### <a name="diagnose-slow-page-loads"></a>遅いページ読み込みの診断
どこに問題がありますか。 サーバーは応答するのに時間がかかりますか。ページはかなり長いですか。ページを表示するのにブラウザーは多くの処理を必要としますか。

ブラウザーのメトリック ブレードを開きます。 ブラウザーのページ読み込み時間のセグメント表示で、どこで時間がかかっているかがわかります。 

* **[要求送信時間]** の値が大きい場合は、サーバーの応答に時間がかかっているか、または要求が大量のデータを伴う POST 要求です。 応答時間を調べるには、 [パフォーマンス メトリック](app-insights-web-monitor-performance.md#metrics) を確認します。
* [依存関係の追跡](app-insights-asp-net-dependencies.md) をセットアップして、パフォーマンス低下の原因が外部のサービスによるものか、内部のデータベースによるものかを確認します。
* **[受信応答時間]** が大部分を占めている場合は、ページと、JavaScript、CSS、イメージなどのページの依存部分 (ただし、非同期で読み込まれるデータではない) が長くなっています。 [可用性テスト](app-insights-monitor-web-app-availability.md)をセットアップし、依存部分を読み込むオプションを必ず設定します。 いくつかの結果を取得したら、結果の詳細を開き展開して、各種ファイルの読み込み時間を表示します。
* **[クライアントの処理時間]** の値が大きい場合は、スクリプトの実行に時間がかかっています。 理由が明らかでない場合は、何らかのタイミング コードを追加することを検討し、trackMetric 呼び出しで時間を送信してください。

### <a name="improve-slow-pages"></a>表示が遅いページの改善
サーバーの応答およびページ読み込み時間を短縮するためのアドバイスは Web に多数掲載されていますが、ここではその一部を取り上げます。 把握済みかもしれませんがいくつかのヒントを参考までに以下に示します。

* ファイルのサイズが大きいため読み込みに時間がかかる: スクリプトとその他の部分を非同期に読み込みます。 スクリプトのバンドルを使用します。 メイン ページをウィジェットに分割し、データを別々に読み込みます。 長いテーブルに対して古いプレーンな HTML が送信されない: スクリプトを使用してデータを JSON またはその他のコンパクトな形式で要求し、所定のテーブルに入力します。 このようなすべてにおいて有効な優れたフレームワークがあります  (これらはまた、当然ながら、大きなスクリプトを伴います)。
* サーバーの依存関係が低速: コンポーネントの地理的な場所について検討してください。 たとえば、Azure を使用している場合、Web サーバーとデータベースが同じリージョンにあることを確認します。 クエリで必要以上の情報が取得されませんか。 キャッシュまたはバッチは役に立ちますか。
* 容量の問題: 応答時間と要求数のサーバー メトリックを確認してください。 応答時間のピークと要求数のピークが合わない場合は、サーバーが拡大されている可能性があります。

## <a name="notification-emails"></a>通知メール
* *通知を受信するために、このサービスに登録する必要はありますか。*
  * いいえ。 ボットは定期的に Application Insights を使用するすべてのユーザーからのデータを調査し、問題を検出した場合に通知を送信します。
* *登録を解除できますか。または、代わりに同僚に通知が送信されるように設定できますか。*

  * アラートまたはメールの登録解除リンクをクリックします。

    現在、通知は [Application Insights リソースへの書き込みアクセス権](app-insights-resources-roles-access-control.md)のあるユーザーに送信されます。

    また、[スマート検出] ブレードで受信者のリストの設定を編集できます。
* *メッセージで受信ボックスをいっぱいにしたくありません。*
  * まだ報告したことがない、最も関連性の高い問題について、1 日 1 件に制限されています。 どのメッセージも繰り返し送信されることはありません。
* *通知に対して何もしない場合、リマインダが送信されますか。*
  * いいえ。各問題についてのメッセージが送信されるのは 1 回のみです。
* *メールが消えました。どうしたらポータルで通知を見つけられますか。*
  * アプリの Application Insights の概要で、 **[スマート検出]** タイルをクリックします。 これで、最大 7 日前までのすべての通知を検索できるようになります。

## <a name="next-steps"></a>次のステップ
これらの診断ツールを使用すると、アプリからテレメトリを調査できます。

* [メトリックス エクスプローラー](app-insights-metrics-explorer.md)
* [Search エクスプローラー](app-insights-diagnostic-search.md)
* [Analytics - 強力なクエリ言語](app-insights-analytics-tour.md)

スマート検出は、すべて自動化されています。 ただし、アラートを追加で設定する機能が用意されています。

* [手動で構成するメトリックのアラート](app-insights-alerts.md)
* [可用性 Web テスト](app-insights-monitor-web-app-availability.md)



<!--HONumber=Nov16_HO3-->


