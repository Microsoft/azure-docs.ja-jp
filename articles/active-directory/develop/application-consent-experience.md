---
title: Azure AD アプリの同意エクスペリエンス
titleSuffix: Microsoft identity platform
description: Azure AD の同意エクスペリエンスについて、Azure AD でアプリケーションを管理および開発する場合の使用方法を詳しく説明します
services: active-directory
author: rwike77
manager: CelesteDG
ms.service: active-directory
ms.subservice: develop
ms.custom: aaddev
ms.workload: identity
ms.topic: conceptual
ms.date: 04/06/2021
ms.author: ryanwi
ms.reviewer: jesakowi, asteen
ms.openlocfilehash: c570fc9f30d69f13546353cf6edab4122ae35142
ms.sourcegitcommit: 5f482220a6d994c33c7920f4e4d67d2a450f7f08
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/08/2021
ms.locfileid: "107105415"
---
# <a name="understanding-azure-ad-application-consent-experiences"></a>Azure AD アプリケーションの同意エクスペリエンスについて

Azure Active Directory (Azure AD) アプリケーションの同意ユーザー エクスペリエンスの詳細について説明します。 これにより、ご自分の組織でアプリケーションをインテリジェントに管理したり、よりシームレスな同意エクスペリエンスでアプリケーションを開発したりすることができます。

## <a name="consent-and-permissions"></a>同意とアクセス許可

同意は、保護されたリソースにアプリケーションが代理でアクセスする認証を、ユーザーが許可するプロセスです。 管理者またはユーザーは、組織または個人のデータへのアクセスを許可するように同意を求められることがあります。

同意を許可する実際のユーザー エクスペリエンスは、ユーザーのテナント、ユーザーの機関でのスコープ (ロール)、クライアント アプリケーションによって要求されている[アクセス許可](v2-permissions-and-consent.md)の種類に設定されたポリシーによって異なります。 つまり、そのアプリケーション開発者とテナント管理者は、同意エクスペリエンスの一部を制御できます。 管理者は、テナントで同意エクスペリエンスを制御するために、テナント上でポリシーまたはアプリを柔軟に設定および無効化することができます。 アプリケーション開発者は、要求されているアクセス許可の種類、およびユーザーの同意フローまたは管理者の同意フローにユーザーをガイドする必要があるかどうかを指示します。

- **ユーザーの同意フロー** は、現在のユーザーのみに対する同意を記録する目的で、アプリケーション開発者がユーザーを承認エンドポイントに直接アクセスさせます。
- **管理者の同意フロー** は、テナント全体に対する同意を記録する目的で、アプリケーション開発者がユーザーを管理者の同意エンドポイントに直接アクセスさせます。 管理者の同意フローが適切に動作するようにするため、アプリケーション開発者はアプリケーション マニフェストで `RequiredResourceAccess` プロパティのアクセス許可をすべて一覧する必要があります。 詳細については、[アプリケーション マニフェスト](./reference-app-manifest.md)に関するページを参照してください。

## <a name="building-blocks-of-the-consent-prompt"></a>同意プロンプトの構成要素

同意プロンプトは、代理でクライアント アプリケーションが保護されたリソースにアクセスすることを信頼するかどうかを判断するために必要な情報を、ユーザーが確実に所有できるように設計されています。 構成要素を理解すると、ユーザーが許可する同意によって豊かな情報に基づく意思決定を下せるようになり、これにより、開発者はより適切なユーザー エクスペリエンスをビルドすることができます。

次の図と表では、同意プロンプトの構成要素に関する情報を示しています。

:::image type="content" source="./media/application-consent-experience/consent_prompt.png" alt-text="同意プロンプトの構成要素":::

| # | コンポーネント | 目的 |
| ----- | ----- | ----- |
| 1 | ユーザー識別子 | この識別子は、クライアント アプリケーションが代わりに、保護されたリソースにアクセスすることを要求していることを表します。 |
| 2 | タイトル | このタイトルは、ユーザーの同意フローまたは管理者の同意フローのいずれをユーザーが経由しているかに基づいて変更されます。 ユーザーの同意フローでは、タイトルは “要求されているアクセス許可” になります。一方、管理者の同意フローでは、タイトルには “組織として承認する” の行が追加されます。 |
| 3 | アプリのロゴ | このイメージは、ユーザーがアクセスしようとしているアプリがこのアプリであるかどうかの目印になります。 このイメージは、アプリケーション開発者によって提供され、このイメージの所有権は検証されていません。 |
| 4 | アプリの名前 | この値によって、ユーザーのデータへのアクセスを要求しているアプリケーションをユーザーに通知します。 この名前は開発者によって提供され、このアプリ名の所有権は検証されていないことに注意してください。 |
| 5 | 発行元ドメイン | この値によって、信頼性を評価できる可能性があるドメインがユーザーに提供されます。 このドメインは開発者によって提供され、この発行元ドメインの所有権は検証されていません。 |
| 6 | 発行元の確認 | 青い "検証済み" バッジは、アプリの発行元が Microsoft Partner Network アカウントを使用して ID を検証し、検証プロセスを完了したことを意味します。|
| 7 | パブリッシャー情報  | アプリケーションが Microsoft またはお客様の組織によって公開されているかどうかが表示されます。 |
| 8 | アクセス許可 | この一覧には、クライアント アプリケーションによって要求されているアクセス許可が含まれます。 ユーザーは常に、同意する場合、クライアント アプリケーションが代理でアクセスすることが承認されるデータの内容を理解するために、要求されているアクセス許可の種類を評価する必要があります。 アプリケーション開発者は、最低限の特権を含むアクセス許可を要求することをお勧めします。 |
| 9 | アクセス許可の説明 | この値は、アクセス許可を公開しているサービスによって提供されます。 アクセス許可の説明を表示するには、アクセス許可の横にあるシェブロンを切り替える必要があります。 |
| 10| アプリの使用条件 | これらの使用条件には、アプリケーションのサービス使用条件とプライバシーに関する声明へのリンクが含まれます。 発行元は、サービスの使用条件でルールを概説する責任があります。 さらに、発行元はプライバシーに関する声明でユーザー データを使用および共有する方法を開示する責任があります。 発行元がマルチテナント アプリケーションに対するこれらの値へのリンクを提供していない場合は、同意プロンプトに太字の警告が含まれます。 |
| 11 | https://myapps.microsoft.com | これは、現在、データへのアクセス権がある任意の Microsoft 以外のアプリケーションをユーザーが確認および削除できるリンクです。 |
| 12 | こちらでご報告ください | このリンクは、アプリを信頼できない場合、このアプリが他のアプリを偽装していると思われる場合、アプリがデータを誤用すると思われる場合、またはその他の理由で、疑わしいアプリを報告するために使用されます。 |

## <a name="app-requires-a-permission-within-the-users-scope-of-authority"></a>アプリからユーザーの権限の範囲内でのアクセス許可が求められる

一般的な同意シナリオは、ユーザーがユーザーの権限の範囲内にあるアクセス許可セットを求めるアプリにアクセスすることです。 ユーザーは、ユーザーの同意フローにリダイレクトされます。

管理者には、テナント全体の代わりに同意することを許可する、従来の同意プロンプトに追加のコントロールが表示されます。 コントロールは既定ではオフにされているため、管理者が明示的にチェック ボックスをオンにした場合にのみ、テナント全体の代わりに同意が許可されます。 現時点では、このチェック ボックスは全体管理者ロールにのみ表示されるため、クラウド管理者とアプリ管理者にはこのチェック ボックスは表示されません。

:::image type="content" source="./media/application-consent-experience/consent_prompt_1a.png" alt-text="シナリオ 1a の同意プロンプト":::

ユーザーには従来の同意プロンプトが表示されます。

:::image type="content" source="./media/application-consent-experience/consent_prompt_1b.png" alt-text="従来の同意プロンプトを示しているスクリーンショット。":::

## <a name="app-requires-a-permission-outside-of-the-users-scope-of-authority"></a>アプリからユーザーの権限の範囲外のアクセス許可が求められる

もう 1 つの一般的な同意シナリオは、ユーザーがユーザーの権限の範囲外にある少なくとも 1 つのアクセス許可を必要とするアプリにアクセスすることです。

管理者には、テナント全体の代わりに同意することを許可する、従来の同意プロンプトに追加のコントロールが表示されます。

:::image type="content" source="./media/application-consent-experience/consent_prompt_1a.png" alt-text="シナリオ 1a の同意プロンプト":::

管理者でないユーザーはアプリケーションへの同意の許可からブロックされ、そのアプリへのアクセス許可を管理者に要求するように指示されます。

:::image type="content" source="./media/application-consent-experience/consent_prompt_2b.png" alt-text="アプリへのアクセスを管理者に依頼するようユーザーに通知する同意プロンプトのスクリーンショット。":::

## <a name="user-is-directed-to-the-admin-consent-flow"></a>ユーザーが管理者の同意フローにリダイレクトされる

もう 1 つの一般的なシナリオは、ユーザーが管理者の同意フローに移動するか、リダイレクトされる場合です。

管理ユーザーには管理者の同意プロンプトが表示されます。 タイトルとアクセス許可の説明はこのプロンプトで変更され、この変更によって許可するファクトが強調表示され、このプロンプトによってテナント全体の代わりに要求されたデータへのアクセス権がアプリに付与されます。

:::image type="content" source="./media/application-consent-experience/consent_prompt_3a.png" alt-text="シナリオ 3a の同意プロンプト":::

管理者でないユーザーはアプリケーションへの同意の許可からブロックされ、そのアプリへのアクセス許可を管理者に要求するように指示されます。

:::image type="content" source="./media/application-consent-experience/consent_prompt_2b.png" alt-text="アプリへのアクセスを管理者に依頼するようユーザーに通知する同意プロンプトのスクリーンショット。":::

## <a name="next-steps"></a>次のステップ

- [Azure AD の同意フレームワークの実装方法](./quickstart-register-app.md)の詳細な手順を入手します。
- 詳細については、[マルチテナント アプリケーションが同意フレームワークを使用して](./howto-convert-app-to-be-multi-tenant.md)多層アプリケーションのパターンのサポートが強化されている、"user" と "admin" の同意を実装する方法について学習します。
- [アプリの発行元ドメインを構成する方法](howto-configure-publisher-domain.md)について説明します。