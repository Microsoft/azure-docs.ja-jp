---
title: Azure Active Directory のサインイン診断とは
description: Azure Active Directory におけるサインイン診断の概要について説明します。
services: active-directory
documentationcenter: ''
author: MarkusVi
manager: daveba
editor: ''
ms.assetid: e2b3d8ce-708a-46e4-b474-123792f35526
ms.service: active-directory
ms.devlang: na
ms.topic: overview
ms.tgt_pltfrm: na
ms.workload: identity
ms.subservice: report-monitor
ms.date: 12/15/2020
ms.author: markvi
ms.reviewer: tspring
ms.collection: M365-identity-device-management
ms.openlocfilehash: cdef3e1f1a60c9eb0c751855837e9cbe77e015e9
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/19/2021
ms.locfileid: "98572291"
---
# <a name="what-is-the-sign-in-diagnostic-in-azure-ad"></a>Azure AD におけるサインイン診断とは

Azure Active Directory (Azure AD) には、管理対象リソースに対してユーザーが実行できる操作を制御するための柔軟なセキュリティ モデルが用意されています。 これらのリソースへのアクセスは、"*だれ*" がアクセスするかだけでなく、"*どのように*" アクセスするかによっても制御されます。 通常、柔軟性のあるモデルにはある程度の複雑さが伴います。使用できる構成オプションの数がその理由です。 複雑さにより、エラーのリスクが増す可能性があります。

IT 管理者には、システム内のアクティビティの分析情報が得られるソリューションが必要です。 その可視性により、発生した問題を診断して解決することができます。 そのようなソリューションの例として、Azure AD のサインイン診断が挙げられます。 この診断を使用すると、サインイン中に何が起きたかを分析し、Microsoft のサポートを求める必要なく問題を解決するための推奨事項を確認できます。

この記事では、ソリューションの機能とその使用方法の概要を説明します。

## <a name="requirements"></a>必要条件

サインイン診断は、Azure AD のすべてのエディションで使用できます。

使用するには、Azure AD のグローバル管理者である必要があります。

## <a name="how-it-works"></a>しくみ

Azure AD では、サインインの試行に対する応答は、"*だれ*" がサインインしているかと、"*どのように*" テナントにアクセスするかに関連付けられています。 たとえば、管理者は、企業ネットワークからサインインする際、通常はテナントのすべての要素を構成できます。 ただし、同じユーザーでも、信頼されていないネットワークから同じアカウントを使用してサインインした場合はブロックされることがあります。

サインインの試行に応答するシステムの柔軟性が高いことから、最終的に、サインインのトラブルシューティングが必要なシナリオに行き着く可能性があります。サインイン診断とは、次のことを行う機能です。

- サインイン イベントのデータを分析する。

- 何が起きたかを表示する。

- 問題の解決方法に関する推奨事項を提示する。

Azure AD のサインイン診断は、サインイン エラーの自己診断が有効になるように設計されています。 診断プロセスを完了するには、以下の操作が必要です。

![サインイン診断を示す図。](./media/overview-sign-in-diagnostics/process.png)

1. 対象となるサインイン イベントのスコープを定義します。

2. 確認するサインインを選択します。

3. 診断結果を確認します。

4. 措置を講じます。

### <a name="define-scope"></a>スコープの定義

この手順の目的は、調査対象となるサインイン イベントのスコープを定義することです。 スコープは、ユーザーまたは識別子 (correlationId、requestId) と時間範囲に基づいています。 スコープをさらに絞り込むには、アプリ名を指定できます。 Azure AD は、スコープ情報を使用して適切なイベントを見つけます。  

### <a name="select-sign-in"></a>サインインの選択  

Azure AD では、検索条件に基づいて一致するすべてのサインイン イベントが取得され、認証の概要のリスト ビューに表示されます。

![認証の概要セクションを示す部分的なスクリーンショット。](./media/overview-sign-in-diagnostics/authentication-summary.png)

このビューに表示される列をカスタマイズできます。

### <a name="review-diagnostic"></a>診断の確認

選択したサインイン イベントについては、Azure AD によって診断結果が表示されます。

![診断結果セクションを示す部分的なスクリーンショット。](./media/overview-sign-in-diagnostics/diagnostics-results.png)

これらの結果は評価から始まり、何が起きたかについて、いくつかの文で説明されます。 この説明は、システムの挙動を理解するために役立ちます。

次に、選択したサインイン イベントに適用された、関係する条件付きアクセス ポリシーの概要が表示されます。 診断結果には、問題を解決するために推奨される修復手順も含まれます。 必ずしも追加の支援なしで問題を解決できるとは限らないため、サポート チケットを開くことが推奨される場合もあります。

### <a name="take-action"></a>アクションの実行

この時点で、問題の解決に必要な情報が得られているものと思われます。

## <a name="scenarios"></a>シナリオ

サインイン診断の対象となるシナリオは次のとおりです。

- 条件付きアクセスによってブロック

- 条件付きアクセスに失敗

- 条件付きアクセスからの多要素認証 (MFA)

- その他の要件からの MFA

- MFA プルーフアップが必要

- MFA プルーフアップが必要 (危険なサインイン場所)

- サインインに成功

### <a name="blocked-by-conditional-access"></a>条件付きアクセスによってブロック

このシナリオでは、サインイン試行が条件付きアクセス ポリシーによってブロックされています。

![[アクセスのブロック] が選択された状態のアクセス構成を示すスクリーンショット。](./media/overview-sign-in-diagnostics/block-access.png)

このシナリオの診断セクションには、ユーザーのサインイン イベントと適用されているポリシーに関する詳細が表示されます。

### <a name="failed-conditional-access"></a>条件付きアクセスに失敗

このシナリオは、通常、条件付きアクセス ポリシーの要件が満たされなかったことが原因で失敗したサインイン試行の結果です。 一般的な例を次に示します。

![一般的なポリシーの例と [アクセス権の付与] が選択された状態のアクセス構成を示すスクリーンショット。](./media/overview-sign-in-diagnostics/require-controls.png)

- ハイブリッド Azure AD 参加済みのデバイスを必要とする

- 承認済みクライアント アプリを必須にする

- アプリの保護ポリシーを必須にする

このシナリオの診断セクションには、ユーザーのサインイン試行と適用されているポリシーに関する詳細が表示されます。

### <a name="mfa-from-conditional-access"></a>条件付きアクセスからの MFA

このシナリオでは、設定された多要素認証を使用してサインインするという要件が条件付きアクセス ポリシーにあります。

![[多要素認証が必要] が選択された状態のアクセス構成を示すスクリーンショット。](./media/overview-sign-in-diagnostics/require-mfa.png)

このシナリオの診断セクションには、ユーザーのサインイン試行と適用されているポリシーに関する詳細が表示されます。

### <a name="mfa-from-other-requirements"></a>その他の要件からの MFA

このシナリオでは、多要素認証の要件が条件付きアクセス ポリシーによって強制されていません。 たとえば、多要素認証はユーザーごとになっています。

![多要素認証がユーザーごとになっている構成を示すスクリーンショット。](./media/overview-sign-in-diagnostics/mfa-per-user.png)

この診断シナリオの目的は、以下に関する詳細情報をさらに提供することです。

- 多要素認証の割り込みのソース
- クライアントとの対話の結果

ユーザーのサインイン試行の詳細をすべて表示することもできます。

### <a name="mfa-proof-up-required"></a>MFA プルーフアップが必要

このシナリオでは、サインイン試行が、多要素認証を設定する要求によって割り込まれています。 この設定はプルーフアップとも呼ばれます。

多要素認証のプルーフアップは、ユーザーが多要素認証を使用するよう要求されているにもかかわらず、まだそれを構成していない、つまり、管理者がその構成をユーザーに要求している場合に発生します。

この診断シナリオの目的は、多要素認証の割り込みが、ユーザーの構成の不足に起因することを明らかにすることです。 推奨される解決策は、ユーザーによるプルーフアップの完了です。

### <a name="mfa-proof-up-required-risky-sign-in-location"></a>MFA プルーフアップが必要 (危険なサインイン場所)

このシナリオでは、サインイン試行が、危険なサインイン場所からの多要素認証を設定する要求によって割り込まれています。

この診断シナリオの目的は、多要素認証の割り込みが、ユーザーの構成の不足に起因することを明らかにすることです。 推奨される解決策は、ユーザーによるプルーフアップの完了です。具体的には、安全と思われるネットワークの場所からプルーフアップを実行します。

たとえば、企業ネットワークがネームド ロケーションとして定義されている場合、ユーザーは代わりに企業ネットワークからのプルーフアップを試みる必要があります。

### <a name="successful-sign-in"></a>サインインに成功

条件付きアクセスまたは多要素認証による割り込みが発生しなかったサインイン イベントのシナリオです。

この診断シナリオでは、条件付きアクセス ポリシーまたは多要素認証による割り込みが予期されていたユーザー サインイン イベントの詳細情報が表示されます。

## <a name="next-steps"></a>次のステップ

- [Azure Active Directory レポートの概要](overview-reports.md)
- [Azure Active Directory の監視とは](overview-monitoring.md)
