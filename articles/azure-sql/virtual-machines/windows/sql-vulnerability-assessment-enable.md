---
title: Azure VM 上の SQL Server の SQL 脆弱性評価
description: Azure Virtual Machines で実行されている SQL Server データベースの SQL 脆弱性評価について説明します。
services: virtual-machines-windows
author: MashaMSFT
ms.service: virtual-machines-sql
ms.subservice: security
ms.topic: conceptual
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 12/02/2020
ms.author: mathoma
ms.openlocfilehash: 817203b8e795ce15c8c48c18bc7b9a46217dc93a
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/19/2021
ms.locfileid: "97356719"
---
# <a name="sql-vulnerability-assessment-for-sql-server-on-azure-vms"></a>Azure VM 上の SQL Server の SQL 脆弱性評価
[!INCLUDE[appliesto-sqlvm](../../includes/appliesto-sqlvm.md)]

SQL 脆弱性評価 (VA) は、データベースの潜在的な脆弱性を検出、追跡、修復するのに役立つ、構成が容易なサービスです。 これを使用すると、Azure VM 上の SQL Server のデータベース セキュリティを事前に強化することができます。 

脆弱性評価は、高度な SQL セキュリティ機能の統合パッケージである [Azure Defender for SQL](../../database/azure-defender-for-sql.md) オファリングの一部です。 脆弱性評価は、一元的な Azure Defender for SQL ポータルまたは Azure Security Center を使用して、アクセスおよび管理できます。 

## <a name="overview"></a>概要

SQL 脆弱性評価 (VA) は、セキュリティの状態を可視化するサービスです。 脆弱性評価には、セキュリティの問題を解決し、データベースのセキュリティを強化するために実践できる手順が含まれています。 以下のことに役立ちます。 

- データベース スキャン レポートが必要なコンプライアンス要件を満たす。 
- データのプライバシー基準を満たす。 
- 変更の追跡が困難である動的データベース環境を監視する。 

脆弱性評価は、セキュリティの脆弱性にフラグを付ける規則のナレッジ ベースを採用したスキャン サービスです。 これは、誤った設定、過剰なアクセス許可、保護されていない機密データなど、ベスト プラクティスからの逸脱を明らかにします。 

規則は Microsoft のベスト プラクティスに基づき、データベースとその貴重なデータにとって最も大きなリスクとなるセキュリティの問題に注目します。 データベース レベルの問題と、サーバーのファイアウォール設定やサーバー レベルの権限などのサーバー レベルのセキュリティ問題がカバーされます。 これらのルールでは、さまざまな規制機関の数多くのコンプライアンス基準を満たすための要件も示しています。 

スキャンの結果には、各々の問題を解決するために実践できる手順が含まれ、カスタマイズした修復スクリプトが適宜提供されます。 次に対する許容されるベースラインを設定することにより、ご利用環境に合わせて評価レポートをカスタマイズできます。 

- アクセス許可の構成 
- 機能の構成 
- データベース設定 

## <a name="enable-sql-va"></a>SQL VA を有効にする

脆弱性評価を実装するには、マシン上の SQL Server に対して Azure Defender を有効にします。 

SQL Server に対して Azure Defender を使用するには、次の手順を実行します。

1. [SQL IaaS エージェント拡張機能をインストールします](sql-agent-extension-manually-register-single-vm.md)
1. [Log Analytics エージェントの自動プロビジョニングを有効にします](../../../security-center/security-center-enable-data-collection.md#auto-provision-mma)
1. [オプションの Security Center プランを有効にします](../../../security-center/defender-for-sql-usage.md#step-2-enable-the-optional-plan-in-security-centers-pricing-and-settings-page)

脆弱性評価は Azure Defender for SQL の一部であるため、仮想マシンで Azure Defender を有効にすると、セキュリティの脆弱性を特定するために、12 時間ごとにデータベースが自動的にスキャンされます。 結果は Azure Security Center に送信され、Azure Defender for SQL によって保護されている SQL データ資産の一元的な集計ビューが表示されます。 

> [!NOTE]
> スキャンは軽量で安全です。実行するデータベースごとに数秒しかかからず、完全に読み取り専用です。 データベースが変更されることはありません。 

## <a name="view-report"></a>レポートの表示

データベース レポートには、セキュリティ状態の概要が示されます。 検出された問題の数とそれぞれの重大度が表示されます。 結果には、ベスト プラクティスからの逸脱に関する警告と、セキュリティ関連の設定 (データベースのプリンシパルとロール、および関連付けられている権限など) のスナップショットが含まれます。  

レポートを表示するには、次の手順を実行します。

1. Azure portal で [Azure Security Center](https://ms.portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) に移動します。
1. **[全般]** メニューで **[推奨事項]** を選択します。 

   :::image type="content" source="media/sql-vulnerability-assessment-enable/recommendations-in-security-center.png" alt-text="Azure portal から Azure Security Center の [設定] にある [推奨事項] に移動します":::

1. [推奨事項] まで下にスクロールし、 **[脆弱性の修復]** を展開します。
1. **[マシン上の SQL サーバーの脆弱性評価の結果を修復する必要がある]** を選択します。 

   :::image type="content" source="media/sql-vulnerability-assessment-enable/report-in-security-center.png" alt-text="Azure Security Center の [推奨事項] ブレードでレポートを表示します":::

このページには、サブスクリプション内のすべての SQL Server VM で特定されたセキュリティの脆弱性の集計が表示されます。 


## <a name="analyze-results"></a>分析結果

結果を確認し、レポートで示されている結果のうち環境で実際にセキュリティの問題となるものを特定します。 問題となった各結果をドリルダウンして、問題の影響と、各セキュリティ チェックが不合格になった理由を理解します。  

:::image type="content" source="media/sql-vulnerability-assessment-enable/sample-report.png" alt-text="結果を確認し、レポートで示されている結果のうち環境で実際にセキュリティの問題となるものを特定します。":::

## <a name="set-baseline"></a>基準計画の設定 

評価の結果を確認しながら、環境において許容されるベースラインとして結果をマークできます。 このベースラインは本来、結果のレポート方法をカスタマイズするものです。 ベースラインに一致する結果は、それ以降のスキャンで合格と見なされます。 ベースラインのセキュリティ状態を確立した後は、脆弱性評価では、ベースラインからの逸脱のみが報告されます。 これにより、関連する問題に意識を集中することができます。 

:::image type="content" source="media/sql-vulnerability-assessment-enable/analyze-report-for-details.png" alt-text="評価の結果を確認しながら、環境において許容されるベースラインとして結果をマークできます。":::

## <a name="export-results"></a>結果のエクスポート

Azure Security Center の[連続エクスポート](../../../security-center/continuous-export.md)機能を使用して、Azure イベント ハブまたは Log Analytics ワークスペースに脆弱性評価の結果をエクスポートします。 


## <a name="next-steps"></a>次のステップ

詳細については、[Azure SQL での SQL の脆弱性評価](../../database/sql-vulnerability-assessment.md)および[Azure Security Center を使用した SQL データの保護](../../../security-center/security-center-introduction.md)に関する記事を参照してください。

