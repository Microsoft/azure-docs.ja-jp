---
title: Azure Monitor メトリックス エクスプローラー
description: Azure Monitor メトリックス エクスプローラーの新機能について説明します
author: vgorbenko
services: azure-monitor
ms.service: azure-monitor
ms.topic: conceptual
ms.date: 12/20/2018
ms.author: vitaly.gorbenko
ms.component: metrics
ms.openlocfilehash: 8932f8aa1dd950693378e9fc58c79838fad6166b
ms.sourcegitcommit: 21466e845ceab74aff3ebfd541e020e0313e43d9
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/21/2018
ms.locfileid: "53741761"
---
# <a name="azure-monitor-metrics-explorer"></a>Azure Monitor メトリックス エクスプローラー

Azure Monitor メトリックス エクスプローラーは、グラフの描画、傾向の視覚的な相関付け、およびメトリック内の値の急上昇と急降下をしらべることができる Microsoft Azure ポータルのコンポーネントです。 メトリックス エクスプローラーは、Azure でホストされているか Azure Monitor サービスによって監視されているアプリケーションとインフラストラクチャのさまざまなパフォーマンスと可用性の問題を調査するための重要な出発点です。

## <a name="metrics-in-azure"></a>Azure のメトリック

Microsoft Azure におけるメトリックは、時間をかけて収集して保存された一連の測定値とカウントです。 標準 ("プラットフォーム") メトリックとカスタム メトリックがあります。 標準メトリックは、Azure プラットフォーム自体によって提供されます。 標準メトリックは、Azure リソースの状態と使用状況の統計を反映します。 一方、カスタム メトリックは、アプリケーションが[カスタム イベント用の Application Insights API](https://docs.microsoft.com/azure/application-insights/app-insights-api-custom-events-metrics) を使用して、Azure に送信します。 カスタム メトリックは、他のアプリケーション固有のメトリックと共に Application Insights リソース内に格納されます。

## <a name="create-a-new-chart"></a>新しいグラフを作成する

1. Azure ポータルを開きます
2. 新しい **[監視]** タブに移動し、その下にある **[メトリック]** を選択します。

   ![メトリックのイメージ](./media/metrics-charts/00001.png)

3. **メトリック セレクター**が自動的に開きます。 関連付けられているメトリックを表示するには、一覧からリソースを選択します。 一覧には、メトリックがあるリソースのみが表示されます。

   ![メトリックのイメージ](./media/metrics-charts/00002.png)

   > [!NOTE]
   >1 つ以上の Azure サブスクリプションがある場合、メトリックス エクスプローラーには、[ポータルの設定] -> [サブスクリプションでフィルター] の一覧で選択されているすべてのサブスクリプションのリソースが表示されます。 これを変更するには、画面上部にある [ポータルの設定] 歯車アイコンをクリックし、使用するサブスクリプションを選択します。

4. 一部のリソースの種類 (ストレージ アカウントと Virtual Machines) では、メトリックを選択する前に **[名前空間]** を選択する必要があります。 各名前空間には、その名前空間のみに関連付けられ、他の名前空間には関連付けられていない独自のメトリック セットがあります。

   たとえば、Azure Storage には、"BLOB"、"ファイル"、"キュー"、および "テーブル" というサブサービスのメトリックがあり、これらは、すべてがストレージ アカウントの一部です。 ただし、"キュー メッセージの数" メトリックは、もちろん "キュー" サブサービスに適用され、それ以外のストレージ アカウントのサブサービスには適用されません。

   ![メトリックのイメージ](./media/metrics-charts/00003.png)

5. 一覧からメトリックを選択します。 メトリックの名前の一部がわかっている場合は、入力を開始して、使用可能なメトリックのフィルター処理された一覧を表示できます。

   ![メトリックのイメージ](./media/metrics-charts/00004.png)

6. メトリックを選択すると、選択したメトリックの既定の集計でグラフが表示されます。 この時点で、**メトリック セレクター**の外側をクリックするだけで、セレクターを閉じることができます。 必要に応じて、グラフを異なる集計に切り替えることもできます。 一部のメトリックでは、集計の切り替えによって、グラフに表示する値を選択できます。 たとえば、平均値、最小値、および最大値の間で切り替えることができます。 

7. **[メトリックの追加]** をクリックして手順 3 から 6 を繰り返すことで、同じグラフにさらにメトリックを追加できます。

   > [!NOTE]
   > 通常は、単位が異なるメトリック ("ミリ秒" と "キロバイト") やスケールが大幅に異なるメトリックを 1 つのグラフには表示しません。 代わりに、複数のグラフを使用することを検討してください。 メトリックス エクスプローラーで複数のグラフを作成するには、[グラフの追加] ボタンをクリックします。

## <a name="apply-filters-to-charts"></a>グラフにフィルターを適用する

ディメンションがあるメトリックを表示しているグラフには、フィルターを適用できます。 たとえば、"トランザクション数" メトリックには "応答の種類" というディメンションがあります。このディメンションは、トランザクションからの応答が成功したか失敗したかを示します。このディメンションでフィルター処理すると、成功した (または失敗した) トランザクションのみが折れ線グラフで表示されます。 

### <a name="to-add-a-filter"></a>フィルターを追加するには

1. グラフの上の **[フィルターの追加]** を選択します

2. フィルター処理するディメンション (プロパティ) を選択します。

   ![メトリックの画像](./media/metrics-charts/00006.png)

3. グラフを描画するときに含めるディメンションの値を選択します (この例では、成功したストレージ トランザクションを除外しています)。

   ![メトリックの画像](./media/metrics-charts/00007.png)

4. フィルターの値を選択したら、フィルター セレクターの外側をクリックして、セレクターを閉じます。 これで、グラフには、失敗したストレージ トランザクションの数が表示されます。

   ![メトリックの画像](./media/metrics-charts/00008.png)

5. 手順 1 ～ 4 を繰り返して、同じグラフに複数のフィルターを適用できます。

## <a name="segment-a-chart"></a>グラフをセグメント化する

メトリックをディメンションによって分割し、メトリックの異なるセグメントの比較を視覚化して、ディメンションの値が異常なセグメントを識別できます。 

### <a name="to-segment-a-chart"></a>グラフをセグメント化するには

1. グラフの上の **[Apply splitting]\(分割の適用\)** をクリックします。
 
   > [!NOTE]
   > 複数のフィルターを設定できますが、1 つのグラフに設定できるのは 1 つの分割/セグメント化の値のみとなります。

2. グラフをセグメント化するディメンションを選択します。

   ![メトリックの画像](./media/metrics-charts/00010.png)

   これで、グラフには、それぞれがディメンションのセグメントである複数の線が表示されます。

   ![メトリックの画像](./media/metrics-charts/00012.png)

3. **グループ セレクター**の外側のクリックして、セレクターを閉じます。

   > [!NOTE]
   > シナリオとは無関係のセグメントを非表示にしてグラフを読みやすくするには、同じディメンションでフィルター処理と分割の両方を使用します。

### <a name="new-alert-rule"></a>新しいアラート ルール

メトリック ベースのアラート ルールの基になるロジックの基準として、メトリックを視覚化するために設定した条件を使用することもできます。 

**[新しいアラート ルール]** をクリックすると、

![赤色で強調表示されている [新しいアラート ルール] ボタン](./media/metrics-charts/015.png)

カスタムのアラート ルールを生成しやすくするために、事前に設定されたグラフからの基になるメトリック ディメンションを含むアラート ルール作成ウィンドウが表示されます。

![アラート ルールの作成](./media/metrics-charts/016.png)

メトリック アラートの設定の詳細については、こちらの[記事](alerts-metric.md)を確認してください。

## <a name="lock-boundaries-of-chart-y-axis"></a>グラフの Y 軸の境界をロックする

大きな値のわずかな変動をグラフで示す場合、Y 軸の範囲をロックすることが重要となります。 

たとえば成功した要求のボリュームが 99.99% から 99.5% に低下した場合、サービスの品質としては、大幅な悪化を表している可能性があります。 しかし、グラフの既定の設定では、数値のわずかな変動は気付きにくいか、まったくわからないこともあります。 この場合、グラフの下限境界を 99% にロックすれば、このわずかな低下を目立たせることができます。 

また別の例としては、使用可能なメモリにおける変動が挙げられます。この値が 0 に達することは技術的にはありえません。 もっと高い値に範囲を固定すれば、使用可能なメモリ量の低下が特定しやすくなると考えられます。 

Y 軸の範囲を制御するには、 グラフの […] メニューを使用し、**[グラフの編集]** を選択して、グラフの詳細設定にアクセスします。 [Y 軸の範囲] セクションの各値を変更してください。または、既定値に戻すには、**[自動]** ボタンを使用します。

![メトリックの画像](./media/metrics-charts/00014-manually-set-granularity.png)

> [!WARNING]
> 通常、ある期間にわたってさまざまな個数や合計を追跡する (カウント、合計、最小、最大などの集計を使用する) グラフで Y 軸の境界をロックするためには、自動による既定の設定をそのまま使うのではなく、時間の粒度を固定的に指定する必要があります。 なぜなら、ブラウザー ウィンドウのサイズや画面の解像度をユーザーが変更することで、時間の粒度が自動的に変わると、グラフ上の値が変化するためです。 それによって生じた時間の粒度の変化がグラフの外観に影響を及ぼし、Y 軸の範囲に対する現在の選択が適さなくなってしまいます。

## <a name="pin-charts-to-dashboards"></a>ダッシュボードにグラフをピン留めする

グラフを構成した後、他の監視テレメトリと関連して再び表示したり、チームと共有したりできるように、グラフをダッシュボードに追加できます。

構成したグラフをダッシュボードにピン留めするには:

グラフを構成した後、グラフの右上隅にある **[Chart Actions]\(グラフの操作\)** メニューをクリックし、**[ダッシュボードに固定]** をクリックします。

![メトリックの画像](./media/metrics-charts/00013.png)

## <a name="next-steps"></a>次の手順

  [カスタム KPI ダッシュボードの作成](https://docs.microsoft.com/azure/application-insights/app-insights-tutorial-dashboards)に関する記事で、メトリックを使用した実用的なダッシュボードを作成するためのベスト プラクティスを確認します。
