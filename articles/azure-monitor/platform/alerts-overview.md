---
title: Azure でのアラートと通知監視の概要
description: Azure でのアラートの概要です。 アラート、クラシック アラート、およびアラート インターフェイス。
ms.service: azure-monitor
ms.subservice: alerts
ms.topic: conceptual
author: rboucher
ms.author: robb
ms.date: 01/28/2018
ms.openlocfilehash: 7f6c7f22cef1cf49a9ff7b2cb87716abd61821c4
ms.sourcegitcommit: 8b37091efe8c575467e56ece4d3f805ea2707a64
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/09/2020
ms.locfileid: "75830328"
---
# <a name="overview-of-alerts-in-microsoft-azure"></a>Microsoft Azure のアラートの概要 

この記事では、アラートの概要、利点、および使用方法について説明します。  




## <a name="what-are-alerts-in-microsoft-azure"></a>Microsoft Azure のアラートの概要
アラートは、監視データで重要な状態が見つかると事前に通知します。 管理者は、その通知を見て、システムのユーザーが問題に気付く前に問題を識別して対処できます。 

この記事では、以前は Log Analytics と Application Insights によって管理されていたアラートも含まれるようになった Azure Monitor の統合アラート エクスペリエンスについて説明します。 [以前のアラート エクスペリエンス](alerts-classic.overview.md)とアラートの種類は、*クラシック アラート*と呼ばれます。 この古いエクスペリエンスと古いアラートの種類は、アラート ページの上部にある **[クラシック アラートの表示]** を選択することで表示できます。 

## <a name="overview"></a>概要

次の図は、アラートのフローを示したものです。 

![アラート フローの図](media/alerts-overview/Azure-Monitor-Alerts.svg)

アラート ルールは、アラート、およびアラートが発生したときに実行されるアクションとは別になっています。 アラート ルールによってアラートのターゲットと条件が取得されます。 アラート ルールは、有効または無効の状態にすることができます。 有効になっているアラートだけが発生します。 

アラート ルールの主な属性は次のとおりです。

**ターゲット リソース**: アラートに使用できるスコープとシグナルを定義します。 ターゲットには、任意の Azure リソースを指定できます。 ターゲットの例として、仮想マシン、ストレージ アカウント、仮想マシン スケール セット、Log Analytics ワークスペース、Application Insights リソースなどがあります。 特定のリソース (仮想マシンなど) では、アラート ルールのターゲットとして複数のリソースを指定できます。

**シグナル**: ターゲット リソースによって出力されます。 シグナルにすることができるのは、メトリック、アクティビティ ログ、Application Insights、およびログです。

**条件**: ターゲット リソースに適用されるシグナルとロジックの組み合わせ。 例 : 
   - CPU 使用率 > 70%
   - サーバー応答時間 > 4 ミリ秒 
   - ログ クエリの結果数 > 100

**アラート名**: ユーザーによって構成されるアラート ルールの特定の名前。

**アラートの説明**: ユーザーによって構成されるアラート ルールの説明。

**[重大度]** :アラート ルールで指定されている条件が満たされた場合のアラートの重大度。 重大度の範囲は 0 ～ 4 です。
   - 重大度 0 = 重大
   - 重大度 1 = エラー
   - 重大度 2 = 警告
   - 重大度 3 = 情報
   - 重大度 4 = 詳細情報 

**アクション**:アラートが発生したときに実行される特定のアクション。 詳細については、[アクション グループ](../../azure-monitor/platform/action-groups.md)に関する記事をご覧ください。

## <a name="what-you-can-alert-on"></a>アラートできるもの

[データ ソースの監視](../../azure-monitor/platform/data-sources.md)に関するページで説明されているように、メトリックとログについてアラートできます。 これらには次が含まれますが、これらに限定されるものではありません。
- メトリックの値
- ログの検索クエリ
- アクティビティ ログのイベント
- 基になっている Azure プラットフォームの正常性
- Web サイトの可用性のテスト

Azure Monitor のメトリック、Application Insights、Log Analytics、および Service Health のアラート機能は以前は別々でした。 Azure では、ユーザー インターフェイスとさまざまなアラート方法が時間と共に統合され、改善されました。 この統合は現在も継続中です。 その結果、新しいアラート システムにまだ組み込まれていないアラート機能がいくつかあります。  

| **モニター ソース** | **シグナルの種類**  | **説明** | 
|-------------|----------------|-------------|
| サービス正常性 | アクティビティ ログ  | サポートされていません。 「[サービス通知のアクティビティ ログ アラートを作成する](../../azure-monitor/platform/alerts-activity-log-service-notifications.md)」をご覧ください。  |
| Application Insights | Web 可用性テスト | サポートされていません。 [Web テスト アラート](../../azure-monitor/app/monitor-web-app-availability.md)に関するページをご覧ください。 Application Insights にデータを送信するようにインストルメント化されたすべての Web サイトで使用できます。 Web サイトの可用性または応答性が期待を下回る場合に通知を受け取ります。 |

## <a name="manage-alerts"></a>Manage alerts
アラートの状態を設定して、それが解決プロセス内のどこにあるかを指定できます。 アラート ルールで指定されている基準が満たされると、アラートが作成または生成されます。アラートの状態は "*新規*" です。 アラートを確認した場合や、アラートを終了した場合は、その状態を変更できます。 状態の変更はすべて、アラートの履歴に格納されます。

次のアラートの状態がサポートされています。

| State | 説明 |
|:---|:---|
| 新規 | 問題が検出されたばかりであり、まだレビューされていません。 |
| [Acknowledged] (確認済み) | 管理者がアラートをレビューし、それに対する作業を開始しました。 |
| クローズ | 問題が解決されました。 アラートが終了されされた後、それを再び開いて別の状態に変更できます。 |

*アラートの状態*は異なり、*監視条件*には依存しません。 アラートの状態は、ユーザーによって設定されます。 監視条件は、システムによって設定されます。 アラートが発生すると、アラートの監視条件が "*発生*" に設定されます。 アラート発生の原因になった状態が解消されると、監視条件は "*解決済み*" に設定されます。 アラートの状態は、ユーザーが変更するまで変わりません。 [アラートとスマート グループの状態を変更する方法](https://aka.ms/managing-alert-smart-group-states)について参照してください。

## <a name="smart-groups"></a>スマート グループ 

スマート グループは機械学習アルゴリズムに基づくアラートの集計であり、アラートのノイズの削減とトラブルシューティングに役立ちます。 [スマート グループに関する詳細](https://aka.ms/smart-groups)および[スマート グループを管理する方法](https://aka.ms/managing-smart-groups)を参照してください。


## <a name="alerts-experience"></a>アラート エクスペリエンス 
既定の [アラート] ページには、特定の時間枠内に作成されたアラートの概要が表示されます。 ここには、重大度ごとのアラートの合計が、重大度ごとの各状態にあるアラートの総数を識別する列と共に表示されます。 任意の重大度を選択すると、その重大度でフィルター処理された [[すべてのアラート]](#all-alerts-page) ページが開きます。

または、[REST API を使用して、サブスクリプションに生成されたアラート インスタンスをプログラムで列挙する](#manage-your-alert-instances-programmatically)こともできます。

> [!NOTE]
   >  過去 30 日以内に生成されたアラートのみにアクセスできます。

クラシック アラートは表示または追跡されません。 サブスクリプションまたはフィルター パラメーターを変更して、ページを更新することができます。 

![[アラート] ページのスクリーンショット](media/alerts-overview/alerts-page.png)

ページの上部にあるドロップダウン メニューで値を選択することによって、このビューをフィルター処理できます。

| 列 | 説明 |
|:---|:---|
| サブスクリプション | アラートを表示する Azure サブスクリプションを選択します。 必要に応じて、すべてのサブスクリプションを選択できます。 このビューには、選択したサブスクリプション内のアクセス権のあるアラートのみが含まれます。 |
| Resource group | 1 つのリソース グループを選択します。 このビューには、選択されたリソース グループ内のターゲットを含むアラートのみが含まれます。 |
| 時間の範囲 | このビューには、選択された時間枠内に発生したアラートのみが含まれます。 サポートされる値は、過去 1 時間、過去 24 時間、過去 7 日間、および過去 30 日間です。 |

[アラート] ページの上部にある次の値を選択すると、別のページが開きます。

| 値 | 説明 |
|:---|:---|
| アラート合計数 | 選択された条件に一致するアラートの総数。 この値を選択すると、フィルター処理されていない [すべてのアラート] ビューが開きます。 |
| スマート グループ | 選択された条件に一致する、アラートから作成されたスマート グループの総数。 この値を選択すると、[すべてのアラート] ビューにスマート グループの一覧が開きます。
| アラート ルールの合計 | 選択されたサブスクリプションおよびリソース グループ内のアラート ルールの総数。 この値を選択すると、選択されたサブスクリプションおよびリソース グループに対してフィルター処理された [ルール] ビューが開きます。


## <a name="manage-alert-rules"></a>アラート ルールの管理
**[ルール]** ページを表示するには、 **[アラート ルールの管理]** を選択します。 [ルール] ページは、複数の Azure サブスクリプションにまたがるすべてのアラート ルールを管理するための単一の場所です。 ここにはすべてのアラート ルールが一覧表示され、それをターゲット リソース、リソース グループ、ルール名、または状態に基づいて並べ替えることができます。 このページで、アラート ルールの編集、有効化、または無効化を行うことができます。  

 ![[ルール] ページのスクリーンショット](./media/alerts-overview/alerts-preview-rules.png)


## <a name="create-an-alert-rule"></a>アラート ルールを作成する
アラートは、監視サービスやシグナルの種類には関係なく、一貫した方法で作成できます。 発生したすべてのアラートや関連する詳細を単一のページで確認できます。
 
新しいアラート ルールを作成する方法は、次のとおりです。
1. アラートの _ターゲット_ を選択します。
1. そのターゲットに使用できるシグナルから _シグナル_ を選択します。
1. そのシグナルからのデータに適用される _ロジック_ を指定します。
 
この簡素化された作成プロセスでは、ユーザーは Azure リソースを選択する前に、サポートされている監視ソースやシグナルを把握しておく必要はなくなります。 使用可能なシグナルの一覧は、ユーザーが選択したターゲット リソースに基づいて自動的にフィルター処理されます。 また、そのターゲットに基づき、アラート ルールのロジックの定義を自動的に案内されます。  

アラート ルールを作成する方法の詳細については、「[Azure Monitor を使用してアラートを作成、表示、管理する](../../azure-monitor/platform/alerts-metric.md)」を参照してください。

アラートは複数の Azure 監視サービス全体で使用できます。 これらの各サービスを使用する方法およびタイミングについては、「[Azure のアプリケーションおよびリソースの監視](../../azure-monitor/overview.md)」を参照してください。 


## <a name="all-alerts-page"></a>[すべてのアラート] ページ 
**[すべてのアラート]** ページを表示するには、 **[アラート合計数]** を選択します。 ここでは、選択された時間枠内に作成されたアラートの一覧を表示できます。 個々のアラートの一覧、またはそれらのアラートを含むスマート グループの一覧のどちらかを表示できます。 ページの上部にあるバナーを選択すると、ビューが切り替わります。

![[すべてのアラート] ページのスクリーンショット](media/alerts-overview/all-alerts-page.png)

ページの上部にあるドロップダウン メニュー内の次の値を選択することによって、ビューをフィルター処理できます。

| 列 | 説明 |
|:---|:---|
| サブスクリプション | アラートを表示する Azure サブスクリプションを選択します。 必要に応じて、すべてのサブスクリプションを選択できます。 このビューには、選択したサブスクリプション内のアクセス権のあるアラートのみが含まれます。 |
| Resource group | 1 つのリソース グループを選択します。 このビューには、選択されたリソース グループ内のターゲットを含むアラートのみが含まれます。 |
| リソースの種類 | 1 つ以上のリソースの種類を選択します。 このビューには、選択された種類のターゲットを含むアラートのみが含まれます。 この列は、リソース グループを指定した後でのみ使用できます。 |
| リソース | リソースを選択します。 このビューには、そのリソースをターゲットとして含むアラートのみが含まれます。 この列は、リソースの種類を指定した後でのみ使用できます。 |
| 重大度 | アラートの重大度を選択するか、または **[すべて]** を選択してすべての重大度のアラートを含めます。 |
| 監視条件 | 監視条件を選択するか、 **[すべて]** を選択してすべての条件のアラートを含めます。 |
| アラートの状態 | アラートの状態を選択するか、 **[すべて]** を選択してすべての状態のアラートを含めます。 |
| サービスの監視 | サービスを選択するか、または **[すべて]** を選択してすべてのサービスを含めます。 そのサービスをターゲットとして使用してルールによって作成されたアラートのみが含まれます。 |
| 時間の範囲 | このビューには、選択された時間枠内に発生したアラートのみが含まれます。 サポートされる値は、過去 1 時間、過去 24 時間、過去 7 日間、および過去 30 日間です。 |

表示する列を選択するには、ページの上部にある **[列]** を選択します。 

## <a name="alert-details-page"></a>[アラートの詳細] ページ
アラートを選択すると、このページにアラートの詳細が表示され、その状態を変更できます。

![[アラートの詳細] ページのスクリーンショット](media/alerts-overview/alert-detail2.png)

[アラートの詳細] ページには、以下のセクションが含まれています。

| Section | 説明 |
|:---|:---|
| まとめ | アラートに関するプロパティやその他の重大な情報を表示します。 |
| 履歴 | アラートによって実行された各アクションと、アラートに加えられたすべての変更を一覧表示します。 現在は、状態の変更に制限されています。 |
| 診断 | アラートが含まれているスマート グループに関する情報。 "*アラートの数*" は、そのスマート グループに含まれているアラートの数を示します。 アラートの一覧ページ内の時間フィルターに関係なく、過去 30 日間に作成された、同じスマート グループ内の他のアラートが含まれます。 アラートを選択すると、その詳細が表示されます。 |

## <a name="role-based-access-control-rbac-for-your-alert-instances"></a>アラート インスタントのロールベースのアクセス制御 (RBAC)

アラート インスタンスを使用および管理するには、ユーザーに[監視共同作成者](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#monitoring-contributor)または[監視閲覧者](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#monitoring-reader)のいずれかの組み込み RBAC ロールが必要です。 これらのロールは、サブスクリプション レベルからリソース レベルでの詳細な割り当てまで、Azure Resource Manager のすべてのスコープでサポートされています。 たとえば、ユーザーが仮想マシン `ContosoVM1` に対する "監視共同作成者" アクセス権のみを持っている場合は、`ContosoVM1` で生成されたアラートのみを使用および管理できます。

## <a name="manage-your-alert-instances-programmatically"></a>プログラムによるアラート インスタンスの管理

サブスクリプションに対して生成されたアラートをプログラムで照会したい場合があります。 たとえば、Azure portal の外部でカスタム ビューを作成したり、アラートを分析してパターンと傾向を特定したりする場合です。

サブスクリプションに対して生成されたアラートをクエリするには、[Alert Management REST API](https://aka.ms/alert-management-api) を使用するか、[Azure Resource Graph](../../governance/resource-graph/overview.md) と [REST API for Resources](/rest/api/azureresourcegraph/resourcegraph(2019-04-01)/resources/resources)を使用します。

リソース用の Resource Graph REST API を使用すると、大規模な警告インスタンスをクエリできます。 これは、多くのサブスクリプションにわたって生成されたアラートを管理しなければならない場合にお勧めします。 

次の Resource Graph REST API の要求例では、1つのサブスクリプション内のアラートの数を返します:

```json
{
  "subscriptions": [
    <subscriptionId>
  ],
  "query": "AlertsManagementResources | where type =~ 'Microsoft.AlertsManagement/alerts' | summarize count()"
}
```

Azure Resource Graph Explorer を使用して、ポータルでこの Resource Graph クエリの結果を確認することもできます: [portal.azure.com](https://portal.azure.com/?feature.customportal=false#blade/HubsExtension/ArgQueryBlade/query/AlertsManagementResources%20%7C%20where%20type%20%3D~%20%27Microsoft.AlertsManagement%2Falerts%27%20%7C%20summarize%20count())

照会は、アラートの[必須](alerts-common-schema-definitions.md#essentials)フィールドに対して行うことができます。

[Alert Management REST API](https://aka.ms/alert-management-api) を使用すると、[アラート コンテキスト](alerts-common-schema-definitions.md#alert-context) フィールドなど、特定のアラートに関する詳細情報を取得できます。

## <a name="next-steps"></a>次のステップ

- [スマート グループの詳細](https://aka.ms/smart-groups)
- [アクション グループの詳細](../../azure-monitor/platform/action-groups.md)
- [Azure でのアラート インスタンスの管理](https://aka.ms/managing-alert-instances)
- [スマート グループの管理](https://aka.ms/managing-smart-groups)
- [Azure アラートの価格についての詳細](https://azure.microsoft.com/pricing/details/monitor/)






