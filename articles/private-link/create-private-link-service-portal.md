---
title: クイックスタート - Azure portal を使用してプライベート リンク サービスを作成する
titlesuffix: Azure Private Link
description: このクイックスタートでは、Azure portal を使用して Private Link サービスを作成する方法を説明します
services: private-link
author: asudbring
ms.service: private-link
ms.topic: quickstart
ms.date: 01/18/2021
ms.author: allensu
ms.openlocfilehash: d394a475c5121607f70c03437382e104a5d0cbee
ms.sourcegitcommit: 4d48a54d0a3f772c01171719a9b80ee9c41c0c5d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/24/2021
ms.locfileid: "98746409"
---
# <a name="quickstart-create-a-private-link-service-by-using-the-azure-portal"></a>クイック スタート:Azure portal を使用して Private Link サービスを作成する

自分のサービスを参照する Private Link サービスを作成してみましょう。  Private Link には、Azure Standard Load Balancer の背後にデプロイされたサービスやリソースへのアクセス権を付与することができます。  サービスのユーザーは、各自の仮想ネットワークからプライベートにアクセスすることができます

## <a name="prerequisites"></a>前提条件

* アクティブなサブスクリプションが含まれる Azure アカウント。 [無料でアカウントを作成できます](https://azure.microsoft.com/free/?WT.mc_id=A261C142F)。

## <a name="sign-in-to-the-azure-portal"></a>Azure portal にサインインする

Azure Portal ( https://portal.azure.com ) にサインインします。

## <a name="create-an-internal-load-balancer"></a>内部ロード バランサーを作成します。

このセクションでは、仮想ネットワークと内部 Azure Load Balancer を作成します。

### <a name="virtual-network"></a>仮想ネットワーク

このセクションでは、Private Link サービスにアクセスするロード バランサーのホストとなる仮想ネットワークとサブネットを作成します。

1. 画面の左上で、 **[リソースの作成] > [ネットワーク] > [仮想ネットワーク]** の順に選択するか、検索ボックスで **Virtual network** を検索します。

2. **[仮想ネットワークの作成]** の **[基本]** タブで次の情報を入力または選択します。

    | **設定**          | **Value**                                                           |
    |------------------|-----------------------------------------------------------------|
    | **プロジェクトの詳細**  |                                                                 |
    | サブスクリプション     | Azure サブスクリプションを選択します。                                  |
    | リソース グループ   | **[CreatePrivLinkService-rg]** を選択します |
    | **インスタンスの詳細** |                                                                 |
    | 名前             | 「**myVNet**」と入力します                                    |
    | リージョン           | **[米国東部 2]** を選択します |

3. **[IP アドレス]** タブを選択するか、ページの下部にある **[Next: IP Addresses]\(次へ: IP アドレス\)** ボタンを選択します。

4. **[IP アドレス]** タブで、次の情報を入力します。

    | 設定            | 値                      |
    |--------------------|----------------------------|
    | IPv4 アドレス空間 | 「**10.1.0.0/16**」と入力します。 |

5. **[サブネット名]** で、 **[default]\(既定\)** という単語を選択します。

6. **[サブネットの編集]** に次の情報を入力します。

    | 設定            | 値                      |
    |--------------------|----------------------------|
    | サブネット名 | 「**mySubnet**」と入力します。 |
    | サブネットのアドレス範囲 | 「**10.1.0.0/24**」と入力します。 |

7. **[保存]** を選択します。

8. **[確認と作成]** タブを選択するか、 **[確認と作成]** ボタンを選択します。

9. **［作成］** を選択します

### <a name="create-a-standard-load-balancer"></a>Standard Load Balancer の作成

ポータルを使用して Standard 内部ロード バランサーを作成します。 

1. 画面の左上で、 **[リソースの作成]**  >  **[ネットワーク]**  >  **[Load Balancer]** を選択します。

2. **[ロード バランサーの作成]** ページの **[基本]** タブで、次の情報を入力または選択します。 

    | 設定                 | 値                                              |
    | ---                     | ---                                                |
    | サブスクリプション               | サブスクリプションを選択します。    |    
    | Resource group         | 前の手順で作成した **CreatePrivLinkService-rg** を選択します。|
    | 名前                   | 「**myLoadBalancer**」と入力します                                   |
    | リージョン         | **[米国東部 2]** を選択します。                                        |
    | Type          | **[内部]** を選択します。                                        |
    | SKU           | **[Standard]** を選択します。 |
    | 仮想ネットワーク | 前のステップで作成した **myVNet** を選択します。 |
    | Subnet  | 前のステップで作成した **mySubnet** を選択します。 |
    | IP アドレスの割り当て | **[動的]** を選択します。 |
    | 可用性ゾーン | **[ゾーン冗長]** を選択します |

3. 残りの設定は既定値をそのまま使用し、 **[確認と作成]** を選択します。

4. **[確認および作成]** タブで、 **[作成]** を選択します。   

## <a name="create-load-balancer-resources"></a>ロード バランサーのリソースを作成する

このセクションでは、次の構成を行います。

* ロード バランサーのバックエンド アドレス プールの設定。
* 正常性プローブ。
* ロード バランサー規則。

### <a name="create-a-backend-pool"></a>バックエンド プールの作成

バックエンド アドレス プールには、ロード バランサーに接続された仮想 NIC の IP アドレスが含まれています。 

バックエンド アドレス プール **myBackendPool** を作成し、インターネット トラフィックを負荷分散するために仮想マシンを含めます。

1. 左側のメニューで **[すべてのサービス]** 、 **[すべてのリソース]** の順に選択し、リソースの一覧で **[myLoadBalancer]** を選択します。

2. **[設定]** で、 **[バックエンド プール]** 、 **[追加]** の順に選択します。

3. **[バックエンド プールの追加]** ページ上で、バックエンド プールの名前として「**myBackendPool**」と入力し、 **[追加]** を選択します。

### <a name="create-a-health-probe"></a>正常性プローブの作成

ロード バランサーは、正常性プローブを使用してアプリの状態を監視します。 

正常性プローブは、正常性チェックへの応答に基づいて、ロード バランサーに含める VM を追加したり削除したりします。 

**myHealthProbe** という正常性プローブを作成し、VM の正常性を監視します。

1. 左側のメニューで **[すべてのサービス]** 、 **[すべてのリソース]** の順に選択し、リソースの一覧で **[myLoadBalancer]** を選択します。

2. **[設定]** で、 **[正常性プローブ]** 、 **[追加]** の順に選択します。
    
    | 設定 | 値 |
    | ------- | ----- |
    | 名前 | 「**myHealthProbe**」と入力します。 |
    | Protocol | **[TCP]** を選択します。 |
    | Port | 「**80**」と入力します。|
    | Interval | プローブの試行の **間隔** を示す秒数として、「**15**」を入力します。 |
    | 異常のしきい値 | **異常しきい値** またはプローブの連続する失敗の回数として **[2]** を選択します。この回数を超えると、VM は異常と見なされます。|
    | | |

3. 残りの部分は既定値のままにし、 **[OK]** を選択します。

### <a name="create-a-load-balancer-rule"></a>ロード バランサー規則の作成

ロード バランサー規則の目的は、一連の VM に対するトラフィックの分散方法を定義することです。 着信トラフィック用のフロントエンド IP 構成と、トラフィックを受信するためのバックエンド IP プールを定義します。 送信元と送信先のポートは、この規則で定義します。 

このセクションでは、ロード バランサー規則を作成します。

* 「**myHTTPRule**」という名前を付けます。
* フロントエンドには、「**LoadBalancerFrontEnd**」という名前を付けます。
* **ポート 80** でリッスンします。
* 負荷分散されたトラフィックを、**ポート 80** の **myBackendPool** という名前のバックエンドに送信します。

1. 左側のメニューで **[すべてのサービス]** 、 **[すべてのリソース]** の順に選択し、リソースの一覧で **[myLoadBalancer]** を選択します。

2. **[設定]** で、 **[負荷分散規則]** 、 **[追加]** の順に選択します。

3. 負荷分散規則の構成には、以下の値を使用します。
    
    | 設定 | 値 |
    | ------- | ----- |
    | 名前 | 「**myHTTPRule**」と入力します。 |
    | IP バージョン | **[IPv4]** を選択します |
    | フロントエンド IP アドレス | **[LoadBalancerFrontEnd]** を選択します |
    | Protocol | **[TCP]** を選択します。 |
    | Port | 「**80**」と入力します。|
    | バックエンド ポート | 「**80**」と入力します。 |
    | バックエンド プール | **[myBackendPool]** を選択します。|
    | 正常性プローブ | **[myHealthProbe]** を選択します。 |
    | アイドル タイムアウト (分) | スライダーを **15** 分に移動します。 |
    | TCP リセット | **[Enabled]** を選択します。 |

4. 残りの部分は既定値のままにし、次に **[OK]** を選択します。

## <a name="create-a-private-link-service"></a>プライベート リンク サービスを作成する

このセクションでは、Standard ロード バランサーの背後に Private Link サービスを作成します。

1. Azure portal のページ左上隅の領域にある **[リソースの作成]** を選択します。

2. **[Marketplace を検索]** ボックスで「**Private Link**」を検索します。

3. **［作成］** を選択します

4. **[Private Link センター]** の **[概要]** で、青色の **[Create private link service]\(Private Link サービスの作成\)** ボタンを選択します。

5. **[Create private link service]\(Private Link サービスの作成\)** の **[基本]** タブで、次の情報を入力または選択します。

    | 設定 | 値 |
    | ------- | ----- |
    | **プロジェクトの詳細** |  |
    | サブスクリプション | サブスクリプションを選択します。 |
    | リソース グループ | **[CreatePrivLinkService-rg]** を選択します。 |
    | **インスタンスの詳細** |  |
    | 名前 | 「**myPrivateLinkService**」と入力します。 |
    | リージョン | **[米国東部 2]** を選択します。 |

6. **[送信設定]** タブを選択するか、ページ下部の **[Next: Outbound settings]\(次へ: 送信設定\)** を選択します。

7. **[送信設定]** タブで、次の情報を入力または選択します。

    | 設定 | 値 |
    | ------- | ----- |
    | Load Balancer | **[myLoadBalancer]** を選択します。 |
    | ロード バランサーのフロントエンド IP アドレス | **[LoadBalancerFrontEnd (10.1.0.4)]** を選択します。 |
    | ソース NAT サブネット | **[mySubnet (10.1.0.0/24)]** を選択します。 |
    | TCP プロキシ v2 を有効にする | 既定値の **[いいえ]** のままにします。 </br> アプリケーションで TCP プロキシ v2 ヘッダーが必要な場合は、 **[はい]** を選択します。 |
    | **プライベート IP アドレスの設定** |  |
    | 既定の設定のままにします |  |

8. **[アクセス セキュリティ]** タブを選択するか、ページ下部の **[Next: Access security]\(次へ: アクセス セキュリティ\)** を選択します。

9. **[アクセス セキュリティ]** タブは、既定値の **[ロールベースのアクセス制御のみ]** のままにします。

10. **タグ** タブを選択するか、**次へ: タグ** がページの下部にあるので、これをクリックします。

11. **[確認と作成]** タブを選択するか、ページの下部にある **[次へ: 確認と作成]** を選択します。

12. **[確認と作成]** タブの **[作成]** を選択します。

Private Link サービスが作成され、トラフィックを受信できるようになります。 トラフィック フローを確認する場合は、アプリケーションを Standard Load Balancer の背後に構成します。


## <a name="create-private-endpoint"></a>プライベート エンドポイントの作成

このセクションでは、Private Link サービスをプライベート エンドポイントにマップします。 仮想ネットワークには、Private Link サービスのプライベート エンドポイントが含まれています。 この仮想ネットワークには、Private Link サービスにアクセスするリソースが含まれています。

### <a name="create-private-endpoint-virtual-network"></a>プライベート エンドポイントの仮想ネットワークを作成する

1. 画面の左上で、 **[リソースの作成] > [ネットワーク] > [仮想ネットワーク]** の順に選択するか、検索ボックスで **Virtual network** を検索します。

2. **[仮想ネットワークの作成]** の **[基本]** タブで次の情報を入力または選択します。

    | **設定**          | **Value**                                                           |
    |------------------|-----------------------------------------------------------------|
    | **プロジェクトの詳細**  |                                                                 |
    | サブスクリプション     | Azure サブスクリプションを選択します。                                  |
    | リソース グループ   | **[CreatePrivLinkService-rg]** を選択します |
    | **インスタンスの詳細** |                                                                 |
    | 名前             | 「**myVNetPE**」と入力します                                    |
    | リージョン           | **[米国東部 2]** を選択します |

3. **[IP アドレス]** タブを選択するか、ページの下部にある **[Next: IP Addresses]\(次へ: IP アドレス\)** ボタンを選択します。

4. **[IP アドレス]** タブで、次の情報を入力します。

    | 設定            | 値                      |
    |--------------------|----------------------------|
    | IPv4 アドレス空間 | 「**11.1.0.0/16**」と入力します |

5. **[サブネット名]** で、 **[default]\(既定\)** という単語を選択します。

6. **[サブネットの編集]** に次の情報を入力します。

    | 設定            | 値                      |
    |--------------------|----------------------------|
    | サブネット名 | 「**mySubnetPE**」と入力します |
    | サブネットのアドレス範囲 | 「**11.1.0.0/24**」と入力します |

7. **[保存]** を選択します。

8. **[確認と作成]** タブを選択するか、 **[確認と作成]** ボタンを選択します。

9. **［作成］** を選択します

### <a name="create-private-endpoint"></a>プライベート エンドポイントの作成

1. ポータルの画面の左上で、 **[リソースの作成]**  >  **[Networking]\(ネットワーキング\)**  >  **[Private Link]\(プライベート リンク\)** を選択するか、検索ボックスに「**プライベート リンク**」と入力します。

2. **［作成］** を選択します

3. **プライベート リンク センター** で、左側のメニューから **[プライベート エンドポイント]** を選択します。

4. **[プライベート エンドポイント]** で、 **[+ 追加]** を選択します。

5. **[プライベート エンドポイントの作成]** の **[基本]** タブで、次の情報を入力または選択します。

    | 設定 | 値 |
    | ------- | ----- |
    | **プロジェクトの詳細** | |
    | サブスクリプション | サブスクリプションを選択します。 |
    | Resource group | **[CreatePrivLinkService-rg]** を選択します。 このリソース グループは、前のセクションで作成しました。|
    | **インスタンスの詳細** |  |
    | 名前  | 「**myPrivateEndpoint**」と入力します。 |
    | リージョン | **[米国東部 2]** を選択します。 |

6. **[リソース]** タブを選択するか、ページ下部の **[次へ: リソース]** ボタンを選択します。
    
7. **[リソース]** で、次の情報を入力または選択します。

    | 設定 | 値 |
    | ------- | ----- |
    | 接続方法 | **[マイ ディレクトリ内の Azure リソースに接続します]** を選択します。 |
    | サブスクリプション | サブスクリプションを選択します。 |
    | リソースの種類 | **Microsoft.Network/privateLinkServices** を選択します。 |
    | リソース | **myPrivateLinkService** を選択します。 |

8. **[構成]** タブを選択するか、 **[次へ: 構成]** ボタン (画面の下部にあります) を選択します。

9. **[構成]** で、次の情報を入力または選択します。

    | 設定 | 値 |
    | ------- | ----- |
    | **ネットワーク** |  |
    | Virtual Network | **myVNetPE** を選択します。 |
    | Subnet | **mySubnetPE** を選択します。 |

10. **[確認と作成]** タブを選択するか、画面の下部にある **[確認と作成]** ボタンを選択します。

11. **［作成］** を選択します

### <a name="ip-address-of-private-endpoint"></a>プライベート エンドポイントの IP アドレス

このセクションでは、ロード バランサーとプライベート リンク サービスに対応するプライベート エンドポイントの IP アドレスについて説明します。

1. Azure portal の左側の列から **[リソース グループ]** を選択します。

2. **CreatePrivLinkService-rg** リソース グループを選択します。

3. **CreatePrivLinkService-rg** リソース グループの **[myPrivateEndpoint]** を選択します。

4. **[myPrivateEndpoint]** の **[概要]** ページで、プライベート エンドポイントに関連付けられているネットワーク インターフェイスの名前を選択します。  ネットワーク インターフェイスの名前は、**myPrivateEndpoint.nic** で始まります。

5. このプライベート エンドポイント NIC の **[概要]** ページの **[プライベート IP アドレス]** に、エンドポイントの IP アドレスが表示されます。
    

## <a name="clean-up-resources"></a>リソースをクリーンアップする

Private Link サービスの使用が完了したら、リソース グループを削除して、このクイックスタートで使用したリソースをクリーンアップします。

1. ポータル上部の検索ボックスに「**CreatePrivLinkService-rg**」と入力し、検索結果から **[CreatePrivLinkService-rg]** を選択します。
1. **[リソース グループの削除]** を選択します。
1. **[TYPE THE RESOURCE GROUP NAME]\(リソース グループ名の入力\)** に「**CreatePrivLinkService-rg**」と入力します。
1. **[削除]** を選択します。

## <a name="next-steps"></a>次のステップ

このクイック スタートでは次の作業を行います。

* 仮想ネットワークと内部 Azure Load Balancer を作成しました。
* Private Link サービスを作成しました。
* Private Link サービスの仮想ネットワークとプライベート エンドポイントを作成しました。

Azure プライベート エンドポイントについてさらに学習するには、次の記事に進んでください。
> [!div class="nextstepaction"]
> [クイックスタート: Azure portal を使用してプライベート エンドポイントを作成する](create-private-endpoint-portal.md)