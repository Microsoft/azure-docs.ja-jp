---
title: Azure Monitor メトリックス エクスプローラー
description: Azure Monitor メトリックス エクスプローラーの新機能について説明します
author: vgorbenko
services: azure-monitor
ms.service: azure-monitor
ms.topic: conceptual
ms.date: 09/17/2017
ms.author: vitaly.gorbenko
ms.component: metrics
ms.openlocfilehash: a2611f89d9eef1ec6bac34389fa4db833aecc087
ms.sourcegitcommit: 1b8665f1fff36a13af0cbc4c399c16f62e9884f3
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/11/2018
ms.locfileid: "35264090"
---
# <a name="azure-monitor-metrics-explorer"></a>Azure Monitor メトリックス エクスプローラー

ここでは、現在パブリック プレビュー段階である次世代の Azure Monitor のメトリック グラフ化エクスペリエンスについて説明します。 新しいエクスペリエンスでは、多次元メトリックと次元のない基本的なメトリックの両方に対するグラフのレンダリングをサポートします。 複数の種類のリソース、複数のリソース グループ、およびサブスクリプションのメトリックを重ね合わせたグラフを描画できます。 グループ化とディメンション フィルターを適用することで、多次元メトリックのグラフをカスタマイズできます。 カスタマイズしたグラフを含む任意のグラフをダッシュボードにピン留めできます。

ディメンションのない基本的なメトリックのみをサポートする古いエクスペリエンスの情報については、「[Microsoft Azure のメトリックの概要](https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-overview-metrics)」の「ポータルを使用してメトリックにアクセスする」セクションを参照してください。

## <a name="what-is-azure-monitor-metrics-explorer"></a>Azure Monitor メトリックス エクスプローラーとは

Azure Monitor メトリックス エクスプローラーは、グラフの描画、傾向の視覚的な相関付け、およびメトリック内の値の急上昇と急降下をしらべることができる Microsoft Azure ポータルのコンポーネントです。 メトリックス エクスプローラーは、Azure でホストされているか Azure Monitor サービスによって監視されているアプリケーションとインフラストラクチャのさまざまなパフォーマンスと可用性の問題を調査するための重要な出発点です。 

## <a name="what-are-metrics-in-azure"></a>Azure におけるメトリックとは

Microsoft Azure におけるメトリックは、時間をかけて収集して保存された一連の測定値とカウントです。 標準 ("プラットフォーム") メトリックとカスタム メトリックがあります。 標準メトリックは、Azure プラットフォーム自体によって提供されます。 標準メトリックは、Azure リソースの状態と使用状況の統計を反映します。 一方、カスタム メトリックは、アプリケーションが[カスタム イベント用の Application Insights API](https://docs.microsoft.com/azure/application-insights/app-insights-api-custom-events-metrics) を使用して、Azure に送信します。 カスタム メトリックは、他のアプリケーション固有のメトリックと共に Application Insights リソース内に格納されます。

## <a name="what-are-multi-dimensional-metrics"></a>多次元メトリックとは

Azure の多数の リソースが、多次元メトリックを公開するようになりました。 これらのメトリックは、1 つまたは複数の名前付きディメンションの複数の値を追跡します。 たとえば、"使用可能なディスク領域" メトリックは、"C:"、"D:" という値がある "ドライブ" と呼ばれるディメンションを持つことができ、これらの値を使用して、すべてのドライブまたは個別のドライブで使用可能なディスク領域を表示できます。 

次の例は、"ネットワーク スループット" という名前の仮のメトリック用の 2 つのデータセットを示しています。 最初のデータセットにはディメンションがありません。 2 番目のデータセットは、"IP アドレス" と "方向" という 2 つのディメンションの値を示しています。

### <a name="network-throughput"></a>ネットワーク スループット
(このメトリックにはディメンションがありません)

 |Timestamp        | メトリック値 | 
   | ------------- |:-------------| 
   | 8/9/2017 8:14 | 1,331.8 Kbps | 
   | 8/9/2017 8:15 | 1,141.4 Kbps |
   | 8/9/2017 8:16 | 1,110.2 Kbps |

このディメンションのないメトリックは、「特定の時点でのネットワークのスループットは?」のような基本的な質問にのみ答えることができます。

### <a name="network-throughput--two-dimensions-ip-and-direction"></a>ネットワーク スループット + 2 つのディメンション ("IP" と "方向")

| Timestamp          | ディメンション "IP" | ディメンション "方向" | メトリック値| 
   | ------------- |:-----------------|:------------------- |:-----------|  
   | 8/9/2017 8:14 | IP="192.168.5.2" | 方向 = "送信"    | 646.5 Kbps |
   | 8/9/2017 8:14 | IP="192.168.5.2" | 方向 = "受信" | 420.1 Kbps |
   | 8/9/2017 8:14 | IP="10.24.2.15"  | 方向 = "送信"    | 150.0 Kbps | 
   | 8/9/2017 8:14 | IP="10.24.2.15"  | 方向 = "受信" | 115.2 Kbps |
   | 8/9/2017 8:15 | IP="192.168.5.2" | 方向 = "送信"    | 515.2 Kbps |
   | 8/9/2017 8:15 | IP="192.168.5.2" | 方向 = "受信" | 371.1 Kbps |
   | 8/9/2017 8:15 | IP="10.24.2.15"  | 方向 = "送信"    | 155.0 Kbps |
   | 8/9/2017 8:15 | IP="10.24.2.15"  | 方向 = "受信" | 100.1 Kbps |

このメトリックは、「各 IP アドレスのネットワーク スループットは?」 や 「データの送信量と受信量?」といった質問に応えることができます。 多次元メトリックは、ディメンションを持たないメトリックに比べ、分析と診断に使用できる多数の値を提供します。 

## <a name="how-do-i-create-a-new-chart"></a>新しいグラフの作成方法

   > [!NOTE]
   > 古いメトリック エクスペリエンスの機能の一部は、新しいメトリックス エクスプローラーではまだ使用できません。 新しいエクスペリエンスのプレビュー中は、Azure Monitor の古い (ディメンションがない) メトリック ビューを引き続き使用できます。 

1. Azure ポータルを開きます
2. 新しい **[監視]** タブに移動し、その下にある **[メトリック]** を選択します。

   ![メトリック (プレビュー) の画像](./media/monitoring-metric-charts/001.png)

3. **メトリック セレクター**が自動的に開きます。 関連付けられているメトリックを表示するには、一覧からリソースを選択します。 一覧には、メトリックがあるリソースのみが表示されます。

   ![メトリック (プレビュー) の画像](./media/monitoring-metric-charts/002.png)

   > [!NOTE]
   >1 つ以上の Azure サブスクリプションがある場合、メトリックス エクスプローラーには、[ポータルの設定] -> [サブスクリプションでフィルター] の一覧で選択されているすべてのサブスクリプションのリソースが表示されます。 これを変更するには、画面上部にある [ポータルの設定] 歯車アイコンをクリックし、使用するサブスクリプションを選択します。

4. 一部のリソースの種類 (ストレージ アカウントと Virtual Machines) では、メトリックを選択する前に **[サブサービス]** を選択する必要があります。 各サブサービスには、そのサブサービスのみに関連付けられ、他のサブサービスには関連付けられていない独自のメトリック セットがあります。

   たとえば、Azure Storage には、"BLOB"、"ファイル"、"キュー"、および "テーブル" というサブサービスのメトリックがあり、これらは、すべてがストレージ アカウントの一部です。 ただし、"キュー メッセージの数" メトリックは、もちろん "キュー" サブサービスに適用され、それ以外のストレージ アカウントのサブサービスには適用されません。

   ![メトリック (プレビュー) の画像](./media/monitoring-metric-charts/003.png)

5. 一覧からメトリックを選択します。 メトリックの名前の一部がわかっている場合は、入力を開始して、使用可能なメトリックのフィルター処理された一覧を表示できます。

   ![メトリック (プレビュー) の画像](./media/monitoring-metric-charts/004.png)

6. メトリックを選択すると、選択したメトリックの既定の集計でグラフが表示されます。 この時点で、**メトリック セレクター**の外側をクリックするだけで、セレクターを閉じることができます。 必要に応じて、グラフを異なる集計に切り替えることもできます。 一部のメトリックでは、集計の切り替えによって、グラフに表示する値を選択できます。 たとえば、平均値、最小値、および最大値の間で切り替えることができます。 

7. [メトリックの追加] アイコン ![メトリック アイコン](./media/monitoring-metric-charts/icon001.png) をクリックして手順 3 ～ 6 を繰り返すことで、同じグラフにさらにメトリックを追加できます。

   > [!NOTE]
   > 通常は、単位が異なるメトリック ("ミリ秒" と "キロバイト") やスケールが大幅に異なるメトリックを 1 つのグラフには表示しません。 代わりに、複数のグラフを使用することを検討してください。 メトリックス エクスプローラーで複数のグラフを作成するには、[グラフの追加] ボタンをクリックします。

## <a name="how-do-i-apply-filters-to-the-charts"></a>グラフにフィルターを適用する方法

ディメンションがあるメトリックを表示しているグラフには、フィルターを適用できます。 たとえば、"トランザクション数" メトリックには "応答の種類" というディメンションがあります。このディメンションは、トランザクションからの応答が成功したか失敗したかを示します。このディメンションでフィルター処理すると、成功した (または失敗した) トランザクションのみが折れ線グラフで表示されます。 

### <a name="to-add-a-filter"></a>フィルターを追加するには:

1. グラフの上にある [フィルターの追加] アイコン ![フィルター アイコン](./media/monitoring-metric-charts/icon002.png) をクリックします。

2. フィルター処理するディメンション (プロパティ) を選択します。

   ![メトリックの画像](./media/monitoring-metric-charts/006.png)

3. グラフを描画するときに含めるディメンションの値を選択します (この例では、成功したストレージ トランザクションを除外しています)。

   ![メトリックの画像](./media/monitoring-metric-charts/007.png)

4. フィルターの値を選択したら、フィルター セレクターの外側をクリックして、セレクターを閉じます。 これで、グラフには、失敗したストレージ トランザクションの数が表示されます。

   ![メトリックの画像](./media/monitoring-metric-charts/008.png)

5. 手順 1 ～ 4 を繰り返して、同じグラフに複数のフィルターを適用できます。

## <a name="how-do-i-segment-a-chart"></a>グラフをセグメント化する方法

メトリックをディメンションによって分割し、メトリックの異なるセグメントの比較を視覚化して、ディメンションの値が異常なセグメントを識別できます。 

### <a name="to-segment-a-chart"></a>グラフをセグメント化するには:

1. グラフの上の [グループ化の追加] アイコン  ![メトリックの画像](./media/monitoring-metric-charts/icon003.png) をクリックします。
 
   > [!NOTE]
   > 複数のフィルターを設定できますが、1 つのグラフには 1 つのグループ化のみを設定できます。

2. グラフをセグメント化するディメンションを選択します。 

   ![メトリックの画像](./media/monitoring-metric-charts/010.png)

   これで、グラフには、それぞれがディメンションのセグメントである複数の線が表示されます。

   ![メトリックの画像](./media/monitoring-metric-charts/012.png)

3. **グループ セレクター**の外側のクリックして、セレクターを閉じます。

   > [!NOTE]
   > シナリオとは無関係のセグメントを非表示にしてグラフを読みやすくするには、同じディメンションでフィルター処理とグループ化の両方を使用します。

## <a name="how-do-i-pin-charts-to-dashboards"></a>ダッシュボードにグラフをピン留めする方法

グラフを構成した後、他の監視テレメトリと関連して再び表示したり、チームと共有したりできるように、グラフをダッシュボードに追加できます。 

構成したグラフをダッシュボードにピン留めするには:

グラフを構成した後、グラフの右上隅にある **[Chart Actions]\(グラフの操作\)** メニューをクリックし、**[ダッシュボードに固定]** をクリックします。

   ![メトリックの画像](./media/monitoring-metric-charts/013.png)

## <a name="next-steps"></a>次の手順

  [カスタム KPI ダッシュボードの作成](https://docs.microsoft.com/azure/application-insights/app-insights-tutorial-dashboards)に関する記事で、メトリックを使用した実用的なダッシュボードを作成するためのベスト プラクティスを確認します。
