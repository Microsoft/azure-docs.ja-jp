---
title: Azure Cosmos DB での要求ユニットとスループット
description: Azure Cosmos DB で要求ユニットの要件を指定したり、推定したりする方法について説明します。
author: rimman
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 10/30/2018
ms.author: rimman
ms.openlocfilehash: dd9fb81b37627518af1375aa9876e6c509b917c9
ms.sourcegitcommit: 8330a262abaddaafd4acb04016b68486fba5835b
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/04/2019
ms.locfileid: "54033929"
---
# <a name="request-units-in-azure-cosmos-db"></a>Azure Cosmos DB の要求ユニット

Azure Cosmos DB では、プロビジョニングするスループットおよび消費するストレージに対して時間単位で支払います。 Azure Cosmos データベースで常に、Azure Cosmos DB の SLA 以上を満たすための十分なシステム リソースを確実に使用できるようにするには、スループットをプロビジョニングする必要があります。

Azure Cosmos DB では、さまざまな API (SQL、MongoDB、Cassandra、Gremlin、およびテーブル) がサポートされています。 各 API には、単純なポイント読み取り/書き込みから複雑なクエリまでの、独自の一連のデータベース操作があります。 各データベース操作は、それらの操作の複雑さに応じてシステム リソースを消費します。  すべてのデータベース操作のコストは Azure Cosmos DB によって正規化され、要求ユニット (RU) として表されます。 1 KB のアイテムの読み取りにかかるコストは 1 要求ユニット (1 RU) で、1 GB のストレージを使用するために必要な最小の RU は 40 です。 その他のすべてのデータベース操作にも、RU としてのコストが同様に割り当てられます。 Azure Cosmos コンテナーを操作するために使用している API やデータベース操作 (書き込み、読み取り、クエリ) には関係なく、コストは常に RU として測定されます。

RU/秒は、スループットのための通貨と考えることができます。 RU/秒は、Azure Cosmos DB によってサポートされるデータベース操作を実行するために必要な CPU、IOPS、メモリなどのシステム リソースを抽象化する、速度ベースの通貨です。 次の図は、さまざまなデータベース操作によって消費される要求ユニットを示しています。

![データベース操作による要求ユニットの消費](./media/request-units/request-units.png)

容量を管理および計画するために、Azure Cosmos DB では、特定のデータセットに対する特定のデータベース操作の RU の数が決定的であることが確認されます。 応答ヘッダーを検証することによって、すべてのデータベース操作によって消費される RU の数を追跡できます。 要求ユニット使用量に影響を与える要因とアプリケーションのスループット要件を理解したら、費用対効果の高い方法でアプリケーションを実行できます。

課金は時間単位ですが、アプリケーションの RU の数は秒単位でプロビジョニングします (増分は 100 RU/秒)。 アプリケーション用にプロビジョニングされたスループットをスケーリングするには、プログラムまたは Azure Portal を使用して、いつでも RU の数を (100 RU の増分または減分で) 増やしたり減らしたりできます。

次の 2 つの個別の細分性でスループットをプロビジョニングできます。 

* **コンテナー**。 詳しくは、[Azure Cosmos コンテナーのスループットをプロビジョニングする方法](how-to-provision-container-throughput.md)に関するページをご覧ください。
* **データベース**。 詳しくは、[Azure Cosmos データベースのスループットをプロビジョニングする方法](how-to-provision-database-throughput.md)に関するページをご覧ください。

## <a name="request-unit-considerations"></a>要求ユニットの考慮事項

プロビジョニングする RU 数/秒を推定するときは、次の要因を考慮することが重要です。

* **アイテムのサイズ** - アイテムのサイズが増加すると、そのアイテムの読み取りまたは書き込みのために消費される RU の数も増加します。

* **アイテムのインデックス作成** - 既定では、各アイテムに自動的にインデックスが作成されます。 コンテナー内の一部のアイテムにインデックスを作成しないように選択すると、消費される要求ユニットは少なくなります。

* **アイテム プロパティの数** - すべてのプロパティで既定のインデックス作成を実行した場合、アイテム プロパティの数が増加すると、アイテムを書き込むために消費される RU の数が増加します。

* **インデックス付きプロパティ** - 各コンテナーのインデックス ポリシーによって、既定でインデックスが作成されるプロパティが決定されます。 インデックス付きプロパティの数を制限することによって、書き込み操作のための要求ユニットの消費を削減できます。

* **データの一貫性** - 強力な有界整合性制約の整合性レベルでは、他の緩和された整合性レベルの場合と比べて、読み取り操作の実行中に約 2 倍の RU が消費されます。

* **クエリのパターン** - クエリの複雑さは、操作のために消費される要求ユニットの数に影響を与えます。 クエリの結果の数、述語の数、述語の性質、ユーザー定義関数の数、ソース データのサイズ、結果セットのサイズ、およびプロジェクションはクエリ操作のコストに影響を与えます。 Azure Cosmos DB では、同じデータに対する同じクエリが、繰り返しの実行で常に同じ数の RU を要することが保証されます。

* **スクリプトの使用** - クエリと同様に、ストアド プロシージャとトリガーは、実行される操作の複雑さに基づいて RU を消費します。 アプリケーションを開発する場合は、要求使用量ヘッダーを調べて、各操作で消費される要求ユニット量をより深く理解してください。

## <a name="next-steps"></a>次の手順

* [Azure Cosmos のコンテナーとデータベースのスループットのプロビジョニング](set-throughput.md)の詳細を確認する
* [論理パーティション](partition-data.md)の詳細を確認する
* [プロビジョニング スループットのグローバルなスケーリング](scaling-throughput.md)の詳細を確認する
* [Azure Cosmos コンテナーのスループットをプロビジョニングする方法](how-to-provision-container-throughput.md)について学習する
* [Azure Cosmos データベースのスループットをプロビジョニングする方法](how-to-provision-database-throughput.md)について学習する
