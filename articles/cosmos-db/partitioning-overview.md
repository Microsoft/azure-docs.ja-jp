---
title: Azure Cosmos DB でのパーティション分割
description: Azure Cosmos DB でのパーティション分割の概要。
ms.author: rimman
author: rimman
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 07/23/2019
ms.openlocfilehash: 1bfa7104425b5013f9cdf36ff3c1dd88107d3ec7
ms.sourcegitcommit: c72ddb56b5657b2adeb3c4608c3d4c56e3421f2c
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/24/2019
ms.locfileid: "68467855"
---
# <a name="partitioning-in-azure-cosmos-db"></a>Azure Cosmos DB でのパーティション分割

Azure Cosmos DB では、パーティション分割を使用して、データベースの個別のコンテナーをスケーリングし、アプリケーションのパフォーマンスのニーズを満たします。 パーティション分割では、コンテナー内の項目が、"*論理パーティション*" と呼ばれる特定のサブセットに分割されます。 論理パーティションは、コンテナー内の各項目に関連付けられている "*パーティション キー*" の値に基づいて形成されます。 1 つの論理パーティション内のすべての項目のパーティション キーの値は同じです。

たとえば、あるコンテナーに項目が保持されているとします。 各項目の `UserID` プロパティには一意の値があります。 `UserID` がそのコンテナー内の項目のパーティション キーであり、1,000 個の一意の `UserID` 値がある場合、1,000 個の論理パーティションがそのコンテナー内に作成されます。

項目の論理パーティションを決めるパーティション キーに加えて、コンテナー内の各項目には "*項目 ID*" (論理パーティション内で一意) があります。 パーティション キーと項目 ID を組み合わせて、項目の "*インデックス*" が作成されます。インデックスによって、項目が一意に識別されます。

[パーティション キーを選択する](partitioning-overview.md#choose-partitionkey)ことは、アプリケーションのパフォーマンスに影響する重要な決定事項です。

## <a name="managing-logical-partitions"></a>論理パーティションの管理

Azure Cosmos DB では、論理パーティションの物理パーティションへの配置が透過的かつ自動的に管理され、コンテナーのスケーラビリティとパフォーマンスのニーズが効率的に満たされます。 アプリケーションのスループットとストレージの要件が上がると、Azure Cosmos DB は論理パーティションを移動し、より多くのサーバーに負荷を自動的に分散します。 

Azure Cosmos DB は、ハッシュベースのパーティション分割を使用して、論理パーティションを物理パーティションに分散します。 Azure Cosmos DB では、項目のパーティション キー値をハッシュします。 ハッシュの結果で、物理パーティションが決定します。 次に、Azure Cosmos DB が物理パーティションに対し、パーティション キー ハッシュのキー空間を均等に割り当てます。

1 つの論理パーティション内のデータにアクセスするクエリでは、複数のパーティションにアクセスするクエリよりもコスト効率が高くなります。 ストアド プロシージャまたはトリガー内のトランザクションは、1 つの論理パーティション内の項目に対してのみ使用できます。

Azure Cosmos DB でパーティションを管理する方法の詳細については、[論理パーティション](partition-data.md)に関するページを参照してください。 (アプリケーションをビルドまたは実行するために内部の詳細を理解する必要はありませんが、興味がある方のためにここに追加されています。)

## <a id="choose-partitionkey"></a>パーティション キーを使用する場合

パーティション キーを選択するための優れたガイダンスを次に示します。

* 1 つの論理パーティションでは、ストレージの上限は 10 GB です。  

* Azure Cosmos コンテナーの最小スループットは、400 要求ユニット/秒 (RU/秒) です。 同じパーティション キーへの要求は、パーティションに割り当てられているスループットを超えることはできません。 割り当て済みのスループットを要求が超えている場合、要求ではレートが制限されます。 そのため、アプリケーション内の "ホット スポット" にならないパーティション キーを選択することが重要です。

* さまざまな値とアクセス パターンがあり、それが論理パーティション間で均等に分散されるパーティション キーを選択します。 このことで、コンテナー内のデータとアクティビティが一連の論理パーティションに分散するため、データ ストレージとスループットのリソースをその論理パーティション全体に分散できるようになります。

* すべてのパーティションと時間で均等にワークロードが分散されるパーティション キーを選択します。 パーティション キーの選択により、複数のパーティションに項目を分散してスケーラビリティを達成するという目標に対して、効率的なパーティションのクエリとトランザクションの必要性のバランスを取る必要があります。

* パーティション キーの候補には、クエリ内でフィルターとして頻繁に出現するプロパティが含まれる場合があります。 フィルターの述語にパーティション キーを含めることで、クエリ呼び出しを効率的にルーティングできます。

## <a name="next-steps"></a>次の手順

* [Azure Cosmos DB でのパーティション分割と水平スケーリング](partition-data.md)について理解します。
* [Azure Cosmos DB におけるスループットのプロビジョニング](request-units.md)について理解します。
* [Azure Cosmos DB の世界規模での分散](distribute-data-globally.md)について理解します。
