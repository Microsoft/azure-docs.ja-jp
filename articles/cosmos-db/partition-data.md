---
title: Azure Cosmos DB でのパーティション分割と水平スケーリング
description: Azure Cosmos DB でのパーティション分割のしくみ、パーティション分割とパーティション キーを構成する方法、アプリケーションに適したパーティション キーを選択する方法について説明します。
author: aliuy
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 10/30/2018
ms.author: andrl
ms.openlocfilehash: 38f587fc24478beff3ab236207de3ed8a892c915
ms.sourcegitcommit: da69285e86d23c471838b5242d4bdca512e73853
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/03/2019
ms.locfileid: "53998950"
---
# <a name="partitioning-and-horizontal-scaling-in-azure-cosmos-db"></a>Azure Cosmos DB でのパーティション分割と水平スケーリング

この記事では、Azure Cosmos DB における物理パーティションと論理パーティションのほか、スケーリングとパーティション分割のベスト プラクティスについて説明します。 

## <a name="logical-partitions"></a>論理パーティション

論理パーティションは、同じパーティション キーを持つ一連のアイテムで構成されます。 たとえば、すべてのアイテムに `City` プロパティが含まれているコンテナーを考えてみると、`City` は、コンテナーのパーティション キーとして使用できます。 `City` に特定の値 ("London"、"Paris"、"NYC" など) が指定されているアイテムのグループは、個別の論理パーティションを形成します。

Azure Cosmos DB では、コンテナーがスケーラビリティの基本単位です。 コンテナーに追加されたデータと、コンテナーに対してプロビジョニングしたスループットは、一連の論理パーティション全体で自動的に (水平方向に) パーティション分割されます。 これらは、Cosmos コンテナーに指定したパーティション キーに基づいてパーティション分割されます。 詳細については、[Cosmos コンテナーにパーティション キーを指定する方法](how-to-create-container.md)に関する記事を参照してください。

論理パーティションでは、データベース トランザクションのスコープを定義します。 論理パーティション内のアイテムは、スナップショット分離が指定されたトランザクションを使用して更新することができます。

新しいアイテムがコンテナーに追加されたときや、コンテナーに対してプロビジョニングされたスループットが増加した場合は、新しい論理パーティションがシステムによって透過的に作成されます。

## <a name="physical-partitions"></a>物理パーティション

Cosmos コンテナーは、多数の論理パーティション全体にデータとスループットを分散することでスケーリングされます。 内部的には、1 つ以上の論理パーティションが、レプリカ セットとも呼ばれる一連のレプリカで構成される**パーティション**にマップされます。 各レプリカ セットは、Cosmos データベース エンジンのインスタンスをホストします。 レプリカ セットにより、物理パーティション内に格納されたデータの耐久性、高可用性、一貫性が確保されます。 物理パーティションでは、固定された最大量のストレージと RU がサポートされます。 物理パーティションを構成する各レプリカは、ストレージ クォータを継承します。 さらに、物理パーティションのすべてのレプリカは、物理パーティションに割り当てられたスループットを一元的にサポートします。 次の図は、グローバルに分散されている物理パーティションに論理パーティションがどのようにマップされているかを示しています。

![Azure Cosmos DB のパーティション分割](./media/partition-data/logical-partitions.png)

コンテナーに対してプロビジョニングされたスループットは、物理パーティション間で均等に分割されます。 そのため、スループット要求を均等に分散しないパーティション キーの仕様により、"ホット" パーティションが作成される可能性があります。 ホット パーティションによって、レート制限が発生し、プロビジョニングされたスループットを効率的に使用できなくなる可能性があります。

論理パーティションとは異なり、物理パーティションはシステムの内部実装です。 それらのサイズ、配置、数や、論理パーティションと物理パーティション間のマッピングを制御することはできません。 ただし、適切なパーティション キーを選択することによって、論理パーティションの数、データとスループットの分散を制御することができます。

## <a name="next-steps"></a>次の手順

この記事では、Azure Cosmos DB におけるデータのパーティション分割の概要と、スケーリングとパーティション分割に関するベスト プラクティスについて説明しました。 

* [Azure Cosmos DB におけるスループットのプロビジョニング](request-units.md)について理解します
* [Azure Cosmos DB の世界規模での分散](distribute-data-globally.md)について理解します。
* [パーティション キーの選択](partitioning-overview.md#choose-partitionkey)について学習する
* [Cosmos コンテナーのスループットをプロビジョニングする方法](how-to-provision-container-throughput.md)について学習する
* [Cosmos データベースのスループットをプロビジョニングする方法](how-to-provision-database-throughput.md)について学習する
