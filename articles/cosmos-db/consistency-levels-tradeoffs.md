---
title: Azure Cosmos DB のさまざまな整合性レベルでの可用性およびパフォーマンスのトレードオフ
description: Azure Cosmos DB のさまざまな整合性レベルでの可用性およびパフォーマンスのトレードオフ。
author: rimman
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 04/08/2019
ms.author: rimman
ms.reviewer: sngun
ms.openlocfilehash: a76e277bf56861bcaefb5bf7f8b3b3bc03ad1164
ms.sourcegitcommit: 62d3a040280e83946d1a9548f352da83ef852085
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/08/2019
ms.locfileid: "59266428"
---
# <a name="consistency-availability-and-performance-tradeoffs"></a>整合性、可用性、パフォーマンスのトレードオフ 

高可用性、短い待機時間、またはその両方のためにレプリケーションに依存している分散型データベースでは、トレードオフを考慮する必要があります。 読み取りの整合性と、可用性、待機時間、およびスループットとのトレードオフです。

Azure Cosmos DB では、幅広い選択肢を利用できるデータ整合性に対応しています。 このアプローチには、厳密で最終的な整合性という 2 つの極端な方法よりも多くの選択肢があります。 整合性の程度に応じて明確に定義された 5 種類のモデルから選択することができます。 最強から最弱の順に、次のモデルがあります。

- *Strong*
- *Bounded staleness*
- *Session*
- *一貫性のあるプレフィックス*
- *Eventual*

いずれのモデルでも、可用性とパフォーマンスのトレードオフが提供され、包括的な SLA によって裏付けられています。

## <a name="consistency-levels-and-latency"></a>整合性レベルと待機時間

すべての整合性レベルの読み取り待機時間は 99 パーセンタイルで 10 ミリ秒未満となるように常に保証されています。 この読み取り待機時間は、SLA によってサポートされます。 平均読み取り待機時間は、(50 パーセンタイルで) 通常 2 ミリ秒以下です。 複数のリージョンにまたがり、厳密な整合性で構成されている Azure Cosmos アカウントは、この保証の例外です。

すべての整合性レベルの書き込み待機時間は 99 パーセンタイルで 10 ミリ秒未満となるように常に保証されています。 この書き込み待機時間は、SLA によってサポートされます。 平均書き込み待機時間は、(50 パーセンタイルで) 通常 5 ミリ秒以下です。

複数のリージョンによる厳密整合性で構成された Azure Cosmos アカウントの場合、書き込み待機時間は、99 パーセンタイルで 2 つの最も遠いリージョンの間のラウンドトリップ時間 (RTT) の 2 倍 + 10 ミリ秒未満となるように保証されています。

正確な RTT 待機時間は、光の速さで通信する距離と Azure ネットワーク トポロジによって決まります。 Azure ネットワークでは、任意の 2 つの Azure リージョン間の RTT に対して待機時間の SLA は提供されません。 Azure Cosmos アカウントの場合、レプリケーションの待機時間は Azure portal に表示されます。 Azure portal を使用する (メトリック ブレードに移動する) と、自分の Azure Cosmos アカウントに関連付けられている多様なリージョン間のレプリケーションの待機時間を監視できます。

## <a name="consistency-levels-and-throughput"></a>整合性レベルとスループット

- 要求ユニットの数が同じである場合、"セッション"、"一貫性のあるプレフィックス"、"最終的" の整合性レベルでは、"厳密" および "有界整合性制約" の場合と比べて約 2 倍の読み取りスループットを発揮します。

- 書き込み操作の種類 (挿入、置換、アップサート、削除) が指定された場合、要求ユニットに対するスループットはすべての整合性レベルで同じです。

## <a id="rto"></a>整合性レベルとデータ持続性

グローバルに分散されるデータベース環境内では、リージョン全体にわたる停止が発生した場合の整合性レベルとデータ持続性の間には、直接的な関係があります。 ビジネス継続性計画を開発するときは、破壊的なイベントが発生してから、アプリケーションが完全に復旧するまでの最大許容時間について理解する必要があります。 アプリケーションを完全に復旧するために必要な時間は、**目標復旧時間** (**RTO**) と呼ばれます。 さらに、破壊的なイベントの発生後、復旧中にアプリケーションが損失を許容できる新しいデータ更新の最大期間についても理解する必要があります。 損失を許容できる更新の期間は、**目標復旧時点** (**RPO**) と呼ばれます。

次のテーブルは、リージョン全体の停止が発生した場合の整合性モデルとデータ持続性の間の関係を定義しています。 分散型システムでは、強力な整合性を備えていても、CAP 定理のために、RPO と RTO が 0 の分散型データベースを持つことは不可能である点に注意することが重要です。 理由の詳細については、「[Azure Cosmos DB の整合性レベル](consistency-levels.md)」を参照してください。

|**リージョン**|**レプリケーション モード**|**整合性レベル**|**RPO**|**RTO**|
|---------|---------|---------|---------|---------|
|1|シングルマスターまたはマルチマスター|任意の整合性レベル|240 分未満|1 週間未満|
|>1|シングルマスター|セッション、一貫性のあるプレフィックス、最終的|15 分未満|15 分未満|
|>1|シングルマスター|Bounded Staleness|*K* & *T*|15 分未満|
|>1|マルチマスター|セッション、一貫性のあるプレフィックス、最終的|15 分未満|0|
|>1|マルチマスター|Bounded Staleness|*K* & *T*|0|
|>1|シングルマスターまたはマルチマスター|Strong|0|15 分未満|

*K* = 項目の *"K"* バージョン (更新) 数。

*T* = 前回の更新以降の期間 *"T"*。

## <a name="next-steps"></a>次の手順

分散システムでのグローバル分散および一般的な整合性のトレードオフについて学習します。 次の記事を参照してください。

- [Consistency tradeoffs in modern distributed database systems design (先進的な分散データベース システム設計における整合性のトレードオフ)](https://www.computer.org/csdl/magazine/co/2012/02/mco2012020037/13rRUxjyX7k)
- [高可用性](high-availability.md)
- [Azure Cosmos DB の SLA](https://azure.microsoft.com/support/legal/sla/cosmos-db/v1_2/)
