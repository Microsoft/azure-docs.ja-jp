---
title: Azure Cosmos DB での読み取りと書き込みのコストの最適化
description: この記事では、データに対して読み取りおよび書き込み操作を実行する際に Azure Cosmos DB のコストを削減する方法について説明します。
author: markjbrown
ms.author: mjbrown
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 07/24/2020
ms.openlocfilehash: 38084bf30df2a597e7a7bc46ba4c52cf371c3c7e
ms.sourcegitcommit: a76ff927bd57d2fcc122fa36f7cb21eb22154cfa
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/28/2020
ms.locfileid: "87318251"
---
# <a name="optimize-reads-and-writes-cost-in-azure-cosmos-db"></a>Azure Cosmos DB の読み取りと書き込みのコストの最適化

この記事では、Azure Cosmos DB からデータを読み取りおよび書き込みするために必要なコストを計算する方法について説明します。 読み取り操作には、[ポイント読み取りとクエリ](sql-query-getting-started.md)が含まれます。 書き込み操作には、アイテムの挿入、置換、削除、upsert が含まれます。  

## <a name="cost-of-reads-and-writes"></a>読み取りと書き込みのコスト

Azure Cosmos DB では、プロビジョニング済みスループット モデルを使用して、スループットと待機時間の観点から予測可能なパフォーマンスを保証します。 プロビジョニング済みスループットは、1 秒あたりの[要求ユニット](request-units.md) (RU/秒) で表されます。 要求ユニット (RU) は、要求を実行するために必要な CPU、メモリ、IO などのコンピューティング リソースを介した論理抽象化です。 プロビジョニング済みスループット (RU) は確保され、ご使用のコンテナーまたはデータベース専用として、予測可能なスループットおよび待機時間を提供します。 プロビジョニング済みスループットにより、Azure Cosmos DB は予測可能で一貫したパフォーマンスを提供でき、どのような規模でも待機時間の短縮と高可用性が保証されます。 要求ユニットは、アプリケーションに必要なリソースの数に関する推論を簡素化する、正規化された通貨を表します。

読み取りと書き込みの間の要求ユニットの区別について考慮する必要はありません。 要求ユニットの統一された通貨モデルは、読み取りと書き込みの両方に対して同じスループット容量を相互に使用できることで、効率性を実現します。 次の表では、RU/秒の観点から、1 KB -100 KB のサイズのアイテムのポイント読み取りと書き込みのコストを示します。

|**アイテムのサイズ**  |**1 つのポイント読み取りのコスト** |**1 件の書き込みのコスト**|
|---------|---------|---------|
|1 KB |1 RU |5 RU |
|100 KB |10 RU |50 RU |

サイズが 1 KB のアイテムのポイント読み取りを行うには、1 RU のコストがかかります。 1 KB のアイテムを書き込むには、5 RU のコストがかかります。 読み取りと書き込みのコストは、既定のセッションである[一貫性レベル](consistency-levels.md)を使用する場合に適用されます。  RU に関する考慮事項には、アイテムのサイズ、プロパティの数、データの整合性、インデックス付きプロパティ、インデックス作成、クエリのパターンなどがあります。

[ポイント読み取り](sql-query-getting-started.md)の場合は、クエリよりも RU のコストが大幅に低くなります。 クエリとは異なり、ポイント読み取りでは、クエリ エンジンを使用してデータにアクセスする必要がなく、RU を節約できます。 クエリ RU の料金は、クエリの複雑さと、クエリ エンジンで読み込む必要があるアイテムの数によって異なります。

## <a name="optimize-the-cost-of-writes-and-reads"></a>書き込みと読み取りのコストを最適化する

書き込み操作を実行するときは、1 秒あたりに必要な書き込みの数をサポートするために十分な容量をプロビジョニングする必要があります。 書き込みの実行前に SDK、ポータル、CLI を使用してプロビジョニング済みスループットを増大させ、書き込みの完了後にスループットを減少させることができます。 書き込み期間中のスループットは、指定されたデータに必要な最小スループットと、他のワークロードが実行されていないと仮定した場合に挿入ワークロードに必要なスループットです。

クエリ/読み取り/更新/削除など、他のワークロードを同時に実行している場合は、これらの操作に必要な要求ユニットもさらに追加する必要があります。 書き込み操作のレートが制限されている場合は、Azure Cosmos DB SDK を使用して再試行/バックオフ ポリシーをカスタマイズできます。 たとえば、レートが制限される要求がわずかな割合になるまで負荷を増加させることができます。 レート制限が発生した場合、クライアント アプリケーションは、指定された再試行間隔中、レートが制限された要求でバックオフする必要があります。 書き込みを再試行する前に、次の再試行までに最小限の時間間隔が必要です。 再試行ポリシーのサポートは、SQL .NET、Java、Node.js、Python SDK、およびサポートされているすべてのバージョンの .NET Core SDK に含まれます。

また、[Azure Data Factory](../data-factory/connector-azure-cosmos-db.md) を使用して、Azure Cosmos DB にデータを一括挿入したり、サポートされているソース データ ストアから Azure Cosmos DB にデータをコピーしたりできます。 Azure Data Factory は、データを書き込むときに最適なパフォーマンスを提供できるよう、Azure Cosmos DB Bulk API とネイティブに統合されています。

## <a name="next-steps"></a>次のステップ

次は、先に進み、以下の各記事で Azure Cosmos DB でのコストの最適化の詳細について学習することができます。

* [開発とテストのための最適化](optimize-dev-test.md)の詳細について学習します
* [Azure Cosmos DB の課金内容の確認](understand-your-bill.md)の詳細について学習します
* [スループット コストの最適化](optimize-cost-throughput.md)の詳細について学習します
* [ストレージ コストの最適化](optimize-cost-storage.md)の詳細について学習します
* [クエリ コストの最適化](optimize-cost-queries.md)の詳細について学習します
* [複数リージョンの Azure Cosmos アカウント コストの最適化](optimize-cost-regions.md)の詳細について学習します
