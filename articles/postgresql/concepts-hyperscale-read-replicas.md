---
title: 読み取りレプリカ - Azure Database for PostgreSQL - Hyperscale (Citus)
description: この記事では、Azure Database for PostgreSQL (Hyperscale (Citus)) の読み取りレプリカ機能について説明します。
author: jonels-msft
ms.author: jonels
ms.service: postgresql
ms.topic: conceptual
ms.date: 04/07/2021
ms.openlocfilehash: cf8c64bf3858f0d3b7d633b94bc7302fbe563f87
ms.sourcegitcommit: 6ed3928efe4734513bad388737dd6d27c4c602fd
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/07/2021
ms.locfileid: "107023851"
---
# <a name="read-replicas-in-azure-database-for-postgresql---hyperscale-citus"></a>Azure Database for PostgreSQL (Hyperscale (Citus)) の読み取りレプリカ

> [!IMPORTANT]
> Hyperscale (Citus) の読み取りレプリカは、現在プレビュー段階です。 このプレビュー バージョンはサービス レベル アグリーメントなしで提供されています。運用環境のワークロードに使用することはお勧めできません。 特定の機能はサポート対象ではなく、機能が制限されることがあります。
>
> その他の新機能については、[Hyperscale (Citus) のプレビュー機能](hyperscale-preview-features.md)に関するページで全一覧をご覧いただけます。

読み取りレプリカ機能を使用すると、Hyperscale (Citus) サーバー グループから、読み取り専用サーバー グループにデータをレプリケートできます。 レプリカは、PostgreSQL の物理的なレプリケーション テクノロジを使用して **非同期的に** 更新されます。 プライマリ サーバーから、無数のレプリカにレプリケートできます。

レプリカは、通常の Hyperscale (Citus) サーバー グループと同様に管理する新しいサーバー グループです。 読み取りレプリカごとに、仮想コアおよびストレージのプロビジョニング済みコンピューティング (GB/月) に対して課金されます。

[レプリカを作成して管理する](howto-hyperscale-read-replicas-portal.md)方法を参照してください。

## <a name="when-to-use-a-read-replica"></a>読み取りレプリカを使用する場合

読み取りレプリカ機能は、読み取り集中型ワークロードのパフォーマンスとスケールの向上に役立ちます。 書き込みワークロードをプライマリに振り向けながら、読み取りワークロードはレプリカに分離することができます。

BI ワークロードおよび分析ワークロードでレポート用のデータ ソースとして使用するのが、読み取りレプリカの一般的なシナリオです。

レプリカは読み取り専用であるため、プライマリへの書き込み容量の負担を直接減らすことにはなりません。

### <a name="considerations"></a>考慮事項

この機能は、レプリケーション ラグが許容されるシナリオを対象とし、クエリのオフロードに適しています。 レプリカ データが最新の状態であることが求められる同期レプリケーションのシナリオには適していません。 プライマリとレプリカの間には測定可能な遅延が発生します。 遅延は、ワークロード、およびプライマリとレプリカの間の待機時間によっては、数分または数時間に及ぶこともあります。  レプリカ上のデータは、最終的にプライマリ上のデータと整合します。 この機能は、この遅延に対応できるワークロードに使用してください。 

## <a name="create-a-replica"></a>レプリカの作成

レプリカ作成ワークフローを開始すると、空の Hyperscale (Citus) サーバー グループが作成されます。 新しいグループには、プライマリ サーバー グループ上にあったデータが設定されます。 作成時間は、プライマリ上のデータ量と、最後の週次完全バックアップからの経過時間に依存します。 時間の範囲は、数分から数時間になる可能性があります。

読み取りレプリカ機能では、PostgreSQL の (論理レプリケーションではなく) 物理レプリケーションが使用されます。 既定のモードは、レプリケーション スロットを使用したストリーミング レプリケーションです。
必要に応じて、遅れを取り戻すためにログ配布が使用されます。

[Azure portal で読み取りレプリカを作成する](howto-hyperscale-read-replicas-portal.md)方法を確認してください。

## <a name="connect-to-a-replica"></a>レプリカへの接続

作成されたレプリカでは、プライマリ サーバー グループのファイアウォール規則は継承されません。 これらの規則は、レプリカに対して個別に設定する必要があります。

レプリカの管理者 ("citus") アカウントは、プライマリ サーバー グループから継承されます。
すべてのユーザー アカウントが、読み取りレプリカにレプリケートされます。 プライマリ サーバー上で使用可能なユーザー アカウントを使って読み取りレプリカにのみ接続できます。

通常の Hyperscale (Citus) サーバー グループの場合と同じように、ホスト名と有効なユーザー アカウントを使用してレプリカのコーディネーター ノードに接続できます。
管理ユーザー名が **citus** で **my replica** という名前のサーバーの場合は、次の psql を使用してレプリカのコーディネーター ノードに接続できます。

```bash
psql -h c.myreplica.postgres.database.azure.com -U citus@myreplica -d postgres
```

メッセージが表示されたら、ユーザー アカウントのパスワードを入力します。

## <a name="considerations"></a>考慮事項

このセクションでは、読み取りレプリカ機能に関する考慮事項をまとめています。

### <a name="new-replicas"></a>新しいレプリカ

読み取りレプリカは、新しい Hyperscale (Citus) サーバー グループとして作成されます。 既存のサーバー グループをレプリカにすることはできません。 別の読み取りレプリカのレプリカを作成することはできません。

### <a name="replica-configuration"></a>レプリカ構成

レプリカは、プライマリと同じコンピューティング、ストレージ、およびワーカー ノードの設定を使用して作成されます。 レプリカの作成後、ストレージやバックアップの保有期間など、いくつかの設定を変更できます。 レプリカでは、ストレージのサイズ、ワーカー ノードの数など、その他の設定を変更することはできません。

必ず、プライマリから到着した変更を保持するのに十分な能力を持つレプリカを確保するようにしてください。 たとえば、コンピューティング能力をプライマリでアップスケールしている場合は、必ず、レプリカでもアップスケールしてください。

ファイアウォール規則およびパラメーター設定は、レプリカの作成時や作成後に、プライマリ サーバーからレプリカに継承されることはありません。

### <a name="regions"></a>リージョン

Hyperscale (Citus) サーバーグループでは、同一リージョンのレプリケーションのみがサポートされます。

## <a name="next-steps"></a>次のステップ

* [Azure portal で読み取りレプリカを作成および管理する](howto-hyperscale-read-replicas-portal.md)方法を確認する。
