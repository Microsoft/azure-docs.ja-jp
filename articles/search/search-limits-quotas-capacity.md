---
title: レベルおよび SKU のサービスの制限 - Azure Search
description: 容量計画で使用されるサービス上限と、Azure Search の要求および応答の上限について説明します。
author: HeidiSteen
manager: nitinme
services: search
ms.service: search
ms.topic: conceptual
ms.date: 10/03/2019
ms.author: heidist
ms.openlocfilehash: 2d3b74476def5bdf46a6292996f0af9162b20b43
ms.sourcegitcommit: 4f7dce56b6e3e3c901ce91115e0c8b7aab26fb72
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/04/2019
ms.locfileid: "71947775"
---
# <a name="service-limits-in-azure-search"></a>Azure Search サービスの制限
インデックス、ドキュメント、およびその他のオブジェクトのストレージ、ワークロード、数量の上限は、[Azure Search](search-create-service-portal.md) を **Free**、**Basic**、**Standard**、または**ストレージ最適化**の価格レベルのいずれでプロビジョニングするかによって異なります。

+ **Free** は、Azure サブスクリプションに付属しているマルチテナント共有サービスです。 インデックス作成とクエリの要求は、他のテナントで使用されているレプリカおよびパーティションで実行されます。

+ **Basic** では、小規模な運用ワークロードに対して専用のコンピューティング リソースが提供されますが、一部のネットワーク インフラストラクチャは他のテナントと共有されます。

+ **Standard** は、すべてのレベルでさらに多くのストレージや処理能力を持つ専用マシン上で実行されます。 Standard には 4 つのレベル(S1、S2、S3、S3 HD) があります。

+ **ストレージ最適化**は、**Standard** よりも多くの合計ストレージ、ストレージ帯域幅、およびメモリを備えた専用マシンで実行されます。 ストレージ最適化は 2 つのレベルがあります: L1 および L2

> [!NOTE]
> 7 月 1 日時点で、すべてのレベルは、ストレージ最適化レベルを含め、一般的に利用できます。 すべての価格は、[価格の詳細](https://azure.microsoft.com/pricing/details/search/)に関するページを参照してください。

  S3 高密度 (S3 HD) は、特定のワークロード ([マルチテナント](search-modeling-multitenant-saas-applications.md)と大量の小さなインデックス (インデックスあたり 100 万ドキュメント、サービスあたり 3000 インデックス)) 向けに設計されています。 このレベルでは、[インデクサー機能](search-indexer-overview.md)は用意されていません。 S3 HD では、データ インジェストがプッシュ アプローチを活用することで、API 呼び出しを使って、ソースからインデックスにデータをプッシュする必要があります。 

> [!NOTE]
> サービスは特定のレベルでプロビジョニングされます。 レベルを移動して容量を増やすには、新しいサービスをプロビジョニングする必要があります (インプレース アップグレードはありません)。 詳細については、[SKU または価格レベルの選択](search-sku-tier.md)に関するページをご覧ください。 プロビジョニングしたサービス内での容量調整の詳細については、[クエリとインデックスのワークロードに応じたリソース レベルのスケール](search-capacity-planning.md)に関するページをご覧ください。
>

## <a name="subscription-limits"></a>サブスクリプションの制限
[!INCLUDE [azure-search-limits-per-subscription](../../includes/azure-search-limits-per-subscription.md)]

## <a name="storage-limits"></a>ストレージの制限
[!INCLUDE [azure-search-limits-per-service](../../includes/azure-search-limits-per-service.md)]

<a name="index-limits"></a>

## <a name="index-limits"></a>インデックスの制限

| リソース | 無料 | Basic&nbsp;<sup>1</sup>  | S1 | S2 | S3 | S3&nbsp;HD | L1 | L2 |
| -------- | ---- | ------------------- | --- | --- | --- | --- | --- | --- |
| 最大インデックス |3 |5 または 15 |50 |200 |200 |パーティションあたり 1,000、またはサービスあたり 3,000 |10 |10 |
| インデックスあたりの単純型フィールドの最大数 |1000 |100 |1000 |1000 |1000 |1000 |1000 |1000 |
| インデックスあたりの複合コレクション フィールドの最大数 |40 |40 |40 |40 |40 |40 |40 |40 |
| ドキュメントあたりの複合コレクション全体での最大要素数 |3000 |3000 |3000 |3000 |3000 |3000 |3000 |3000 |
| 複合フィールドの最大深度 |10 |10 |10 |10 |10 |10 |10 |10 |
| インデックスあたりの最大[サジェスター](https://docs.microsoft.com/rest/api/searchservice/suggesters) |1 |1 |1 |1 |1 |1 |1 |1 |
| インデックスあたりの最大[スコアリング プロファイル](https://docs.microsoft.com/rest/api/searchservice/add-scoring-profiles-to-a-search-index) |100 |100 |100 |100 |100 |100 |100 |100 |
| プロファイルあたりの最大関数 |8 |8 |8 |8 |8 |8 |8 |8 |

<sup>1</sup> 2017 年 12 月より前に作成された Basic サービスは、インデックスでの制限が低くなっています (15 ではなく 5)。 Basic レベルにのみ下限 (インデックスあたり 100 フィールド) があります。

<a name="document-limits"></a>

## <a name="document-limits"></a>ドキュメントの制限 

2018 年 10 月現在、いずれのリージョンにおいても、課金対象レベル (Basic、S1、S2、S3、S3 HD) で作成された新しいサービスに関して、ドキュメントの制限はありません<sup>1</sup>。 2017 年の 11 月または 12 月 以降、ドキュメント数はほとんどのリージョンで無制限ですが、5 つのリージョンについては、それ以降もドキュメントの制限が課されていました。 検索サービスを作成した時と場所によっては、実行しているサービスに、今もドキュメントの制限が課されている可能性があります。

使用しているサービスにドキュメントの制限があるかどうかを確かめるには、そのサービスの概要ページで使用状況タイルを確認します。 ドキュメント数は、無制限であるか、レベルに基づいて制限が適用されます。

  ![使用状況タイル](media/search-limits-quotas-capacity/portal-usage-tile.png)

<sup>1</sup> SKU 固有のドキュメント制限はありませんが、すべてのインデックスは、サービスの安定性を確保するために、引き続き最大の安全制限の対象となります。 この制限は、Lucene に由来します。 各 Azure Search ドキュメントは、1 つ以上の Lucene ドキュメントとして、内部的にインデックスが付けられます。 Azure Search ドキュメントあたりの Lucene ドキュメントの数は、複合コレクション フィールド内の要素の合計数によって異なります。 各要素は、個別の Lucene ドキュメントとして、インデックスが付けられます。 たとえば、複合コレクション フィールドに 3 つの要素があるドキュメントでは、ドキュメント自体に対して 1 個、要素に対して 3 個、合計 4 個の Lucene ドキュメントとしてインデックスが付けられます。 Lucene ドキュメントの最大数は、インデックスあたり約 250 億です。

### <a name="regions-previously-having-document-limits"></a>過去にドキュメントの制限があったリージョン

ドキュメントの制限があることをポータルが示している場合、ご利用のサービスは 2017 年末の前に作成されたか、容量の小さなクラスターを使用して Azure Search サービスをホストしているデータ センターで作成されたものです。

+ オーストラリア東部
+ 東アジア
+ インド中部
+ 西日本
+ 米国中西部

ドキュメントの制限の対象となるサービスについては、次の上限が適用されます。

|  無料 | Basic | S1 | S2 | S3 | S3&nbsp;HD |
|-------|-------|----|----|----|-------|
|  10,000 |100 万&nbsp; |パーティションあたり 1,500 万、またはサービスあたり 1 億 8,000 万 |パーティションあたり 6,000 万、またはサービスあたり 7 億 2,000 万 |パーティションあたり 1 億 2,000 万、またはサービスあたり 14 億 |インデックスあたり 100 万、またはパーティションあたり 2 億 |

サービスの制限に達して、それ以上利用できない状況になった場合は、新しいサービスを作成したうえで、すべてのコンテンツをそのサービスに再発行してください。 新しいハードウェアに対して暗黙的かつシームレスにサービスを再プロビジョニングする機構はありません。

> [!Note] 
> 2017 年末以降に作成された S3 High Density サービスについては、パーティションあたり 200 万ドキュメントという制限はなくなりました。ただし、インデックスあたり 100万ドキュメントという制限は残ります。


### <a name="document-size-limits-per-api-call"></a>API 呼び出しごとのドキュメント サイズの制限

インデックス API を呼び出すときのドキュメント サイズの上限は約 16 メガバイトです。

ドキュメント サイズとは、実際にはインデックス API の要求本文のサイズに対する制限を意味します。 複数のドキュメントのバッチを一度にインデックス API に渡すことができるため、このサイズの制限は、現実的には、バッチ内のドキュメント数に左右されます。 バッチ内のドキュメントが 1 つの場合、最大ドキュメント サイズは JSON 形式で 16 MB です。

ドキュメント サイズを抑えるには、クエリ不可能なデータを要求から忘れずに除外してください。 イメージとその他のバイナリ データは直接クエリできないため、インデックスには格納しないでください。 クエリ不可能なデータを検索結果に含めるには、リソースの URL 参照を格納する検索不可能なフィールドを定義してください。

## <a name="indexer-limits"></a>インデクサー制限

サービスに全体としてのバランスと安定性を提供するために、最大実行時間が設けられていますが、より大規模なデータ セットでは、許可されている最大値よりも長いインデックス作成時間が必要になることがあります。 インデックス作成ジョブが最大許容時間内で完了できない場合は、スケジュールで実行してください。 スケジューラはインデックスの状態を追跡します。 スケジュールされたインデックス作成ジョブが何らかの理由で中断された場合、インデクサーは、次のスケジュールされた実行時に最後の終了状態を選択できます。


| リソース | Free&nbsp;<sup>1</sup> | Basic&nbsp;<sup>2</sup>| S1 | S2 | S3 | S3&nbsp;HD&nbsp;<sup>3</sup>|L1 |L2 |
| -------- | ----------------- | ----------------- | --- | --- | --- | --- | --- | --- |
| 最大インデクサー |3 |5 または 15|50 |200 |200 |該当なし |10 |10 |
| 最大データソース |3 |5 または 15 |50 |200 |200 |該当なし |10 |10 |
| 最大スキルセット <sup>4</sup> |3 |5 または 15 |50 |200 |200 |該当なし |10 |10 |
| 呼び出しあたりの最大インデックス作成負荷 |10,000 ドキュメント |最大ドキュメントによってのみ制限 |最大ドキュメントによってのみ制限 |最大ドキュメントによってのみ制限 |最大ドキュメントによってのみ制限 |該当なし |制限なし |制限なし |
| 最小限のスケジュール | 5 分 |5 分 |5 分 |5 分 |5 分 |5 分 |5 分 | 5 分 |
| 最大実行時間 <sup>5</sup> | 1 ～ 3 分 |24 時間 |24 時間 |24 時間 |24 時間 |該当なし  |24 時間 |24 時間 |
| コグニティブ検索スキルセットまたはイメージの分析による blob のインデックス作成の最大実行時間 <sup>5</sup> | 3 から 10 分 |2 時間 |2 時間 |2 時間 |2 時間 |該当なし  |2 時間 |2 時間 |
| BLOB インデクサー: BLOB の最大サイズ、MB |16 |16 |128 |256 |256 |該当なし  |256 |256 |
| BLOB インデクサー: BLOB から抽出されたコンテンツの最大文字数 |32,000 |64,000 |400万&nbsp; |400万&nbsp; |400万&nbsp; |該当なし |400万&nbsp; |400万&nbsp; |

<sup>1</sup> Free サービスのインデクサーの最大実行時間は、BLOB ソースの場合は 3 分、その他のすべてのデータ ソースの場合は 1 分です。 Cognitive Services に呼び出しを行う AI インデックスについては、トランザクションが強化パイプラインを正常に通過するドキュメントとして定義された場合、無料のサービスは 1 日あたり 20 個の無料トランザクションに制限されます。

<sup>2</sup> 2017 年 12 月より前に作成された Basic サービスは、インデクサー、データ ソース、およびスキルセットでの制限が低くなっています (15 ではなく 5)。

<sup>3</sup> S3 HD サービスには、インデクサー サポートが含まれません。

<sup>4</sup> スキルセットあたり最大 30 スキル。

<sup>5</sup> コグニティブ検索ワークロードと Azure BLOB のインデックス作成の画像の分析の実行時間は、通常のテキストのインデックス作成よりも短くなります。 イメージの分析および自然言語処理は、コンピューティングを集中的に使用し、使用可能な処理能力を大量に消費します。 実行時間が短縮され、キュー内の他のジョブに実行の機会が与えられます。  

## <a name="synonym-limits"></a>シノニムの制限

シノニム マップの最大許容数は、価格レベルによって異なります。 各規則には最大 20 個の拡張を設定できます。ここでの拡張とは同義語です。 たとえば、"cat" の場合、"kitty"、"feline"、および "felis" (ネコ属) との関連は、3 つの拡張としてカウントされます。

| リソース | 無料 | Basic | S1 | S2 | S3 | S3-HD |L1 | L2 |
| -------- | -----|------ |----|----|----|-------|---|----|
| シノニムマップの最大数 |3 |3|5 |10 |20 |20 | 10 | 10 |
| マップごとの規則の最大数 |5000 |20000|20000 |20000 |20000 |20000 | 20000 | 20000  |

## <a name="queries-per-second-qps"></a>秒間クエリ (QPS)

QPS の見積もりは、すべての顧客ごとに個別に開発する必要があります。 インデックスのサイズと複雑さ、クエリのサイズと複雑さ、およびトラフィックの量が QPS を決定する主な要因です。 このような要因が不明な場合は、意義のある見積もりを用意する方法はありません。

見積もりは、専用リソース (Basic および Standard レベル) 上で実行されるサービスに基づいて計算される場合、予測可能性がより高くなります。 より多くのパラメーターを制御できるため、さらに厳密に QPS を見積もることができます。 見積もりを行う方法のガイダンスについては、[Azure Search のパフォーマンスと最適化](search-performance-optimization.md)に関する記事を参照してください。

ストレージ最適化レベルでは、Standard レベルよりもクエリ スループットが低く、待ち時間が長くなります。  ユーザーが体験するクエリ パフォーマンスを予測する方法は、Standard レベルと同じです。

## <a name="data-limits-cognitive-search"></a>データの制限 (コグニティブ検索)

[エンティティ認識](cognitive-search-skill-entity-recognition.md)、[キー フレーズ抽出](cognitive-search-skill-keyphrases.md)、[センチメント分析](cognitive-search-skill-sentiment.md)、および[言語検出](cognitive-search-skill-language-detection.md)の Text Analytics リソースに対して呼び出しを行う[コグニティブ検索パイプライン](cognitive-search-concept-intro.md)は、データの制限を受ける可能性があります。 レコードの最大サイズは、[`String.Length`](https://docs.microsoft.com/dotnet/api/system.string.length) によって測定されるため、50,000 文字にする必要があります。 データをセンチメント アナライザーに送信する前に分割する必要がある場合は、[テキスト分割スキル](cognitive-search-skill-textsplit.md)を使用します。

## <a name="throttling-limits"></a>スロットルの制限

システムがピーク時の容量に近づくにつれて、検索クエリとインデックス作成要求が調整されます。 スロットルの動作は API によって異なります。 クエリ API (検索/提案/オートコンプリート) とインデックス作成 API は、サービスの負荷に基づいて動的に調整されます。 インデックス API には、静的な要求レート制限があります。 

インデックスに関連する操作の静的なレート要求の制限:

+ インデックスの一覧取得 (GET /indexes):1 秒あたり 5 件 (検索単位あたり)
+ インデックスの取得 (GET /indexes/myindex):1 秒あたり 10 件 (検索単位あたり)
+ インデックスの作成 (POST /indexes):1 分あたり 12 件 (検索単位あたり)
+ インデックスの作成または更新 (PUT /indexes/myindex):1 秒あたり 6 件 (検索単位あたり)
+ インデックスの削除 (DELETE /indexes/myindex):1 分あたり 12 件 (検索単位あたり) 

## <a name="api-request-limits"></a>API 要求の制限
* 要求あたりの最大値: 16 MB<sup>1</sup>
* URL の最大長: 8 KB
* インデックスののアップロード、マージ、または削除のバッチあたりの最大ドキュメント数: 1,000
* $orderby 句の最大フィールド数: 32
* 検索用語の最大サイズ: UTF-8 でエンコードされたテキストの 32,766 バイト (32 KB - 2 バイト)

<sup>1</sup> Azure Search では、要求の本文は上限 16 MB に左右され、それ以外では理論的制限によって制約されない個々のフィールドまたはコレクションのコンテンツに実際的な制限が課せられます (フィールドの構成と制約の詳細については、[サポートされているデータ型](https://docs.microsoft.com/rest/api/searchservice/supported-data-types)に関するページをご覧ください)。

## <a name="api-response-limits"></a>API 応答の制限
* 検索結果のページごとに返される最大ドキュメント数: 1,000
* 検索候補 API 要求ごとに返される最大検索候補数: 100

## <a name="api-key-limits"></a>API キーの制限
API キーは、サービスの認証に使用されます。 次の 2 つの種類があります。 管理者キーは、要求ヘッダーで指定され、サービスに完全な読み取り/書き込みアクセス権を付与します。 クエリ キーは、読み取り専用で、URL で指定され、通常はクライアント アプリケーションに配布されます。

* サービスあたりの最大管理キー数: 2
* サービスあたりの最大クエリ キー数: 50
