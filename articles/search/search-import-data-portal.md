---
title: Azure portal を使用して検索インデックスにデータをインポートする - Azure Search
description: Azure portal でデータのインポート ウィザードを使用して、Cosmos DB、Blob Storage、Table Storage、SQL Database、Azure VM 上の SQL Server から Azure データをクロールします。
author: HeidiSteen
manager: nitinme
services: search
ms.service: search
ms.topic: conceptual
ms.date: 05/02/2019
ms.author: heidist
ms.custom: seodec2018
ms.openlocfilehash: e784cbf351bd062712e0fd66332799907a3bcae8
ms.sourcegitcommit: bb8e9f22db4b6f848c7db0ebdfc10e547779cccc
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/20/2019
ms.locfileid: "69648247"
---
# <a name="import-data-wizard-for-azure-search"></a>Azure Search のデータのインポート ウィザード

Azure Portal では、データをインデックスに読み込む**データのインポート** ウィザードが Azure Search ダッシュボードに用意されています。 ウィザードでは、バックグラウンドで*データ ソース*、*インデックス*、および*インデクサー*を構成して起動し、次のようなインデックス作成プロセスのいくつかの手順を自動化します。 

* 同じ Azure サブスクリプションで外部のデータ ソースに接続します。
* 必要に応じて、非構造化データからテキストを抽出するための光学式文字認識または自然言語処理を統合します。
* データのサンプリングと外部データ ソースのメタデータに基づいてインデックスを生成します。
* JSON ドキュメントをシリアル化してインデックスに読み込み、検索可能なコンテンツのデータ ソースをクロールします。

ウィザードでは定義済みのインデックスに接続したり、既存のインデクサーを実行したりすることはできませんが、ウィザード内で、必要な構造や動作をサポートするように新しいインデックスまたはインデクサーを構成することができます。

Azure Search を初めて使用する場合は、 [ポータル ツールを使用するインポート、インデックス作成、クエリの実行に関するクイック スタート](search-get-started-portal.md)をステップ実行し、**データのインポート**および組み込みの real estate サンプル データ セットを使用して、インポートとインデックス作成を試してください。

## <a name="start-importing-data"></a>データのインポートを開始する

このセクションでは、ウィザードの起動方法について説明し、各手順の概要を示します。

1. [Azure portal](https://portal.azure.com) でダッシュボードから検索サービス ページを開くか、サービスの一覧で[ご自分のサービスを見つけ](https://ms.portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Search%2FsearchServices)ます。

2. 上部にあるサービスの概要ページで、 **[データのインポート]** をクリックします。

   ![ポータルの [データのインポート] コマンド](./media/search-import-data-portal/import-data-cmd2.png "データのインポート ウィザードを起動する")

   > [!NOTE]
   > **[データのインポート]** は、Azure Cosmos DB、Azure SQL Database、Azure Blob Storage を含む、他の Azure サービスから起動できます。 サービスの概要ページの左側にあるナビゲーション ウィンドウで、 **[Azure Search の追加]** を見つけます。

3. ウィザードが開き、 **[データへの接続]** が表示されます。ここで、このインポートで使用する外部データ ソースを選択することができます。 この手順について知っておく必要がある点がいくつかあるため、必ず、「[データ ソースの入力](#data-source-inputs)」セクションで詳細を確認してください。

   ![ポータルのデータのインポート ウィザード](./media/search-import-data-portal/import-data-wizard-startup.png "Azure Search のデータのインポート ウィザード")

4. 次は、 **[認知検索を追加します (省略可能)]** です。イメージ ファイルのテキストの光学式文字認識 (OCR)、または非構造化データに対するテキスト分析を含める場合に使用します。 Cognitive Services の AI アルゴリズムは、このタスクのために取り込まれます。 この手順は次の 2 つの部分に分かれています。
  
   まず、Azure Search スキルセットに [Cognitive Services リソースをアタッチします](cognitive-search-attach-cognitive-services.md)。
  
   次に、スキルセットに含める AI エンリッチメントを選びます。 チュートリアルのデモについては、こちらの[クイック スタート](cognitive-search-quickstart-blob.md)を参照してください。

   データをインポートするだけの場合は、この手順をスキップし、インデックス定義に直接進みます。

5. 次は、 **[ターゲット インデックスのカスタマイズ]** です。ここでは、ウィザードに表示されるインデックス スキーマを受け入れるか変更できます。 ウィザードでは、データをサンプリングし、外部データ ソースからメタデータを読み取ることで、フィールドとデータ型を推測します。

   フィールドごとに、[インデックス属性を確認](#index-definition)し、特定の動作を有効にします。 属性を選択しないと、インデックスは使用できません。 

6. 次は、このウィザードの製品である、 **[インデクサーの作成]** です。 インデクサーはクローラーであり、外部の Azure データ ソースから検索可能なデータとメタデータを抽出します。 データ ソースを選択し、スキルセット (省略可能) とインデックスをアタッチし、ウィザードの各手順を進んで、インデクサーを構成しました。

   そのインデクサーに名前を付け、 **[送信]** をクリックしてインポート プロセスを開始します。 

ポータルで、 **[インデクサー]** リストのインデクサーをクリックすることで、インデックス作成を監視することができきます。 ドキュメントが読み込まれると、定義したインデックスのドキュメント数が増えます。 ポータル ページで最新の更新プログラムを取得するまで、数分かかる場合があります。

最初のドキュメントが読み込まれるとすぐに、インデックスのクエリを実行する準備ができます。 このタスクで [Search エクスプローラー](search-explorer.md)を使用することができます。

<a name="data-source-inputs"></a>

## <a name="data-source-inputs"></a>データ ソースの入力

**データのインポート** ウィザードでは、外部データ ソースに接続情報を指定することで、永続的なデータ ソース オブジェクトを作成します。 データ ソース オブジェクトは[インデクサー](search-indexer-overview.md)専用で、次のデータ ソースに作成できます。 

* [Azure SQL](search-howto-connecting-azure-sql-database-to-azure-search-using-indexers.md)
* [Azure Cosmos DB](search-howto-index-cosmosdb.md)
* [Azure Blob Storage](search-howto-indexing-azure-blob-storage.md)
* [Azure Table Storage](search-howto-indexing-azure-tables.md) ([コグニティブ検索](cognitive-search-concept-intro.md)パイプラインではサポートされません)

インポート元として指定できるのは、単一のテーブル、データベース ビュー、または同等のデータ構造体のみですが、構造体には、階層または入れ子になったのサブ構造体を含めることができます。 詳細については、[複合型のモデル化の方法に関するページ](search-howto-complex-data-types.md)を参照してください。

ウィザードを実行する前に、このデータ構造を作成し、コンテンツを含める必要があります。 空のデータ ソースに対して**データのインポート** ウィザードを実行しないでください。

|  選択肢番号 | 説明 |
| ---------- | ----------- |
| **既存のデータ ソース** |Search サービスに定義済みのインデクサーが既にある場合は、別のインポート用に既存のデータ ソース定義を選択できます。 Azure Search では、データ ソース オブジェクトはインデクサーでのみ使用されます。 データ ソース オブジェクトは、プログラムで、または**データのインポート** ウィザードを使用して作成することができます。|
| **サンプル**| Azure Search では無料のグローバル Azure SQL データベースをホストします。このデータベースを使用して、Azure Search でのインポートやクエリ要求の詳細を確認することができます。 「[クイック スタート:ポータル ツールを使用したインポート、インデックス作成、およびクエリの実行に関するクイック スタート](search-get-started-portal.md)を参照してください。 |
| **Azure SQL Database** |サービス名、読み取り権限を持つデータベース ユーザーの資格情報、データベース名は、このページで、または ADO.NET 接続文字列を使用して指定できます。 接続文字列のオプションを選択して、プロパティを表示またはカスタマイズします。 <br/><br/>行セットを提供するテーブルまたはビューは、このページで指定する必要があります。 このオプションは接続に成功すると表示され、ドロップダウン リストから選択できます。 |
| **Azure VM 上の SQL Server** |接続文字列として、完全修飾サービス名、ユーザー ID とパスワード、データベースを指定します。 このデータ ソースを使用するには、接続を暗号化する証明書をローカル ストアにあらかじめインストールしておく必要があります。 手順については、[Azure Search への SQL VM 接続](search-howto-connecting-azure-sql-iaas-to-azure-search-using-indexers.md)に関する記事をご覧ください。 <br/><br/>行セットを提供するテーブルまたはビューは、このページで指定する必要があります。 このオプションは接続に成功すると表示され、ドロップダウン リストから選択できます。 |
| **Cosmos DB** |要件には、アカウント、データベース、コレクションが含まれます。 コレクション内のすべてのドキュメントはインデックスに含まれます。 行セットをフラット化またはフィルター処理するクエリを定義することも、クエリを空白のままにすることもできます。 このウィザードでは、クエリは必要はありません。|
| **Azure Blob Storage** |要件には、ストレージ アカウントとコンテナーが含まれます。 BLOB 名がグループ化のために仮想名前付け規則に従っている場合は、必要に応じて、コンテナーの下のフォルダーとして名前の仮想ディレクトリの部分を指定できます。 詳しくは、[Blob Storage のインデックス作成](search-howto-indexing-azure-blob-storage.md)に関する記事をご覧ください。 |
| **Azure Table Storage** |要件には、ストレージ アカウントとテーブル名が含まれます。 必要に応じて、クエリを指定してテーブルのサブセットを取得できます。 詳しくは、[Table Storage のインデックス作成](search-howto-indexing-azure-tables.md)に関する記事をご覧ください。 |


<a name="index-definition"></a>

## <a name="index-attributes"></a>インデックスの属性

**データのインポート** ウィザードではインデックスが生成され、入力データ ソースから取得されるドキュメントが取り込まれます。 

関数インデックスについては、以下の要素が定義されていることを確認します。

1. 1 つのフィールドを**キー**としてマークする必要があります。このキーは、各ドキュメントを一意に識別するために使用されます。 **キー**は *Edm.string* である必要があります。 

   フィールドの値に空白またはダッシュが含まれている場合は、**インデクサーの作成**手順の **[詳細オプション]** で **[Base-64 エンコード キー]** オプションを設定し、これらの文字の検証チェックを抑制する必要があります。

1. 各フィールドのインデックス属性を設定します。 属性を選択しない場合、必須のキー フィールドを除き、インデックスは本質的に空となります。 少なくとも、各フィールドには以下の属性の 1 つ以上を選択してください。
   
   + **Retrievable** の場合、検索結果にフィールドが返されます。 検索結果にコンテンツを提供するすべてのフィールドに、この属性が必要です。 このフィールドを設定しても、インデックス サイズに大きな影響はありません。
   + **Filterable** は、フィルター式でフィールドを参照できるようにします。 **$filter** 式で使用されるすべてのフィールドに、この属性が必要です。 このフィルター式は完全一致用です。 テキスト文字列はそのまま残るため、逐語的なコンテンツに対応するには、追加のストレージが必要です。
   + **Searchable** では、全文検索が有効になります。 自由形式のクエリまたはクエリ式で使用されるすべてのフィールドに、この属性が必要です。 **Searchable** としてマークしたフィールドごとに、逆インデックスが作成されます。

1. 必要に応じて、以下の属性を設定します。

   + **Sortable** は、並べ替えでフィールドを使用できるようにします。 **$Orderby** 式で使用されるすべてのフィールドに、この属性が必要です。
   + **Facetable** は、ファセット ナビゲーションにフィールドを使用できるようにします。 **Filterable** としてもマークされているフィールドのみを、**Facetable** としてマークできます。

1. 言語拡張インデックス作成とクエリの実行が必要な場合は、**アナライザー**を設定します。 既定値は*標準 Lucene* ですが、不規則名詞や動詞形式の解決など、高度な字句処理のために Microsoft のアナライザーを使用する必要がある場合は、*Microsoft の英語*を選択できます。

   + **Searchable** を選択して、**アナライザー** リストを有効にします。
   + リストに示されるアナライザーを選択します。 
   
   現時点では、言語アナライザーのみを指定できます。 カスタム アナライザーや、キーワード、パターンなどの非言語アナライザーを使用する場合は、コードが必要になります。 アナライザーの詳細については、[複数言語のドキュメント用のインデックス作成](search-language-support.md)に関するページを参照してください。

1. **[提案者]** チェック ボックスをオンにし、選択したフィールドで先行入力クエリ候補を有効にします。


## <a name="next-steps"></a>次の手順
インデクサーの詳細については、次のリンク先を参照してください。

* [Azure SQL Database のインデックス作成](search-howto-connecting-azure-sql-database-to-azure-search-using-indexers.md)
* [Azure Cosmos DB のインデックス作成](search-howto-index-cosmosdb.md)
* [Blob Storage のインデックス作成](search-howto-indexing-azure-blob-storage.md)
* [Table Storage のインデックス作成](search-howto-indexing-azure-tables.md)