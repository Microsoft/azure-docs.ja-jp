---
title: Azure Load Balancer ポータルの設定
description: Azure Load Balancer ポータルの設定の学習を始める
services: load-balancer
documentationcenter: na
author: asudbring
ms.service: load-balancer
ms.devlang: NA
ms.topic: how-to
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/8/2020
ms.author: allensu
ms.openlocfilehash: e1080aea12e70f4312fbee07b063d5a5cfbd1201
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/29/2021
ms.locfileid: "89596222"
---
# <a name="azure-load-balancer-portal-settings"></a>Azure Load Balancer ポータルの設定

Azure Load Balancer を作成するときに、この記事の情報は、個々の設定と適切な構成について詳しく知るのに役立ちます。

## <a name="create-load-balancer"></a>ロード バランサーの作成

Azure Load Balancer は、バックエンド プール内の VM インスタンス間にトラフィックを分散させるネットワーク ロード バランサーです。

### <a name="basics"></a>基本

ロード バランサー ポータルの作成ページの **[基本]** タブには、次の情報が表示されます。



| 設定 |  詳細 |
| ---------- | ---------- |
| サブスクリプション  | サブスクリプションを選択します。 この選択は、ロード バランサーをデプロイするサブスクリプションです。 |
| Resource group | **[新規作成]** を選択し、テキスト ボックスにリソース グループの名前を入力します。 既存のリソース グループが作成されている場合は、それを選択します。 |
| 名前 | この設定は、ご使用の Azure Load Balancer の名前です。 |
| Region | ロード バランサーをデプロイする Azure リージョンを選択します。 |
| 種類 | ロード バランサーには次の 2 種類があります。 </br> **内部 (プライベート)** </br> **パブリック (外部)**</br> 内部ロードバランサー (ILB) によって、プライベート IP アドレスを介してバックエンド プール メンバーにトラフィックがルーティングされます。</br> パブリック ロード バランサーにより、クライアントからの要求がインターネット経由でバックエンド プールに送信されます。</br> ロード バランサーの種類の詳細については、[こちら](components.md#frontend-ip-configuration-)を参照してください。|
| SKU  | **[Standard]** を選択します。 </br> ロード バランサーには、次の 2 つの SKU があります。**Basic** と **Standard**。 </br> Basic は機能が限られています。 </br> 運用環境のワークロードには **Standard** をお勧めします。 </br> SKU の詳細については、[こちら](skus.md)を参照してください。 |

種類に **[パブリック]** を選択した場合は、次の情報が表示されます。

| 設定 |  詳細 |
| ---------- | ---------- |
| パブリック IP アドレス | **[新規作成]** を選択して、パブリック ロード バランサーのパブリック IP アドレスを作成します。 </br> パブリック IP が既にある場合は、 **[既存のものを使用]** を選択します。  |
| パブリック IP アドレス名 | パブリック IP アドレスの名前。|
| パブリック IP アドレスの SKU | パブリック IP アドレスには、次の 2 つの SKU があります。**Basic** と **Standard**。 </br> Basic では、ゾーンの回復性とゾーンの属性がサポートされていません。 </br> 運用環境のワークロードには **Standard** をお勧めします。 </br> ロード バランサーとパブリック IP アドレスの SKU は **一致している必要があります**。 |
| 割り当て | Standard には **[静的]** が自動的に選択されます。 </br> Basic のパブリック IP には、次の 2 種類があります。 **[動的]** と **[静的]** 。 </br> 動的パブリック IP アドレスは、作成されるまで割り当てられません。 </br> リソースが削除されると、IP が失われる可能性があります。 </br> 静的 IP アドレスをお勧めします。 |
| 可用性ゾーン | 回復性があるロード バランサーを作成するには、 **[ゾーン冗長]** を選択します。 </br> ゾーン間ロード バランサーを作成するには、**1**、**2**、**3** の中から特定のゾーンを選択します。 </br> Standard ロード ランサーとパブリック IP により、ゾーンがサポートされています。 </br> ロード バランサーと可用性ゾーンの詳細については、[こちら](load-balancer-standard-availability-zones.md)を参照してください。 </br> Basic にはゾーンの選択は表示されません。 Basic Load Balancer では、ゾーンがサポートされていません。 |
| パブリック IPv6 アドレスを追加する | ロード バランサーによって、フロントエンドの **IPv6** アドレスがサポートされています。 </br> ロード バランサーと IPv6 の詳細については、[こちら](load-balancer-ipv6-overview.md)を参照してください。
| ルーティング設定 | **[Microsoft ネットワーク]** を選択します。 </br> Microsoft ネットワークは、トラフィックが Microsoft グローバル ネットワーク経由でルーティングされることを意味します。 </br> インターネットは、トラフィックがインターネット サービス プロバイダー ネットワーク経由でルーティングされることを意味します。 </br> ルーティング設定の詳細については、[こちら](../virtual-network/routing-preference-overview.md)を参照してください。|

:::image type="content" source="./media/manage/create-public-load-balancer-basics.png" alt-text="ロード バランサー (パブリック) を作成する。" border="true":::

[種類] に **[内部]** 選択した場合は、次の情報が表示されます。

| 設定 |  詳細 |
| ---------- | ---------- |
| 仮想ネットワーク | 内部ロード バランサーを含める仮想ネットワーク。 </br> 内部ロード バランサー用に選択したプライベート フロントエンド IP アドレスは、この仮想ネットワークからのものになります。 |
| IP アドレスの割り当て | 選択肢は **[静的]** または **[動的]** です。 </br> [静的] を選択すると、IP は変更されません。 動的 IP は変わる可能性があります。 |
| 可用性ゾーン | 次のようなオプションがあります。 </br> **ゾーン冗長** </br> **ゾーン 1** </br> **ゾーン 2** </br> **ゾーン 3** </br> 可用性ゾーンの障害に対して高可用性と回復力を備えたロード バランサーを作成するには、 **[ゾーン冗長]** IP を選択します。 |

:::image type="content" source="./media/manage/create-internal-load-balancer-basics.png" alt-text="ロード バランサー (内部) の作成。" border="true":::

## <a name="frontend-ip-configuration"></a>フロントエンド IP の構成

Azure Load Balancer の IP アドレスです。 クライアントにとっての接続点となります。 

1 つまたは複数のフロントエンド IP 構成を持つことができます。 上記の「基本」セクションを完了している場合は、ロード バランサーのフロントエンドが既に作成されています。 

フロントエンド IP 構成をロード バランサーに追加する場合は、Azure portal でロード バランサーにアクセスし、 **[フロントエンド IP 構成]** を選択してから、 **[+ 追加]** を選択します。

| 設定 |  詳細 |
| ---------- | ---------- |
| 名前 | フロントエンド IP 構成の名前。 |
| IP バージョン | フロントエンドに必要な IP アドレスのバージョン。 </br> ロード バランサーにより、IPv4 と IPv6 の両方のフロントエンド IP 構成がサポートされています。 |
| IP の種類 | IP の種類により、1 つの IP アドレスが、フロントエンドに関連付けられているか、IP プレフィックスを使用して IP アドレスの範囲に関連付けられているかが決定されます。 </br> [パブリック IP プレフィックス](../virtual-network/public-ip-address-prefix.md)は、同じエンドポイントに繰り返し接続する必要がある場合に役立ちます。 プレフィックスによって、SNAT ポートの問題を支援するための十分なポートが提供されます。 |
| パブリック IP アドレス (上記のプレフィックスを選択した場合はプレフィックス) | ロード バランサー フロントエンドの新しいパブリック IP (またはプレフィックス) を選択または作成します。 |

:::image type="content" source="./media/manage/frontend.png" alt-text="フロントエンド IP 構成の作成ページ。" border="true":::

## <a name="backend-pools"></a>バックエンド プール

バックエンド アドレス プールには、バックエンド プール内の仮想ネットワーク インターフェイスの IP アドレスが含まれます。 

ロード バランサーにバックエンド プールを追加する場合は、Azure portal でロード バランサーにアクセスし、 **[バックエンド プール]** を選択してから、 **[+ 追加]** を選択します。

| 設定 | 詳細 |
| ---------- |  ---------- |
| 名前 | バックエンド プールの名前。 |
| 仮想ネットワーク | バックエンド インスタンスが存在する仮想ネットワーク。 |
| IP バージョン | 選択肢は **[IPv4]** または **[IPv6]** です。 |

Azure Load Balancer のバックエンド プールに、仮想マシンまたは仮想マシン スケール セットを追加できます。 まず、仮想マシンまたは仮想マシン スケール セットを作成します。 次に、それらをポータルのロード バランサーに追加します。

:::image type="content" source="./media/manage/backend.png" alt-text="バックエンド プールの作成ページ。" border="true":::

## <a name="health-probes"></a>正常性プローブ

正常性プローブは、バックエンド VM またはインスタンスの状態を監視するために使用されます。 正常性プローブの状態によって、正常性チェックに基づいて新しい接続がインスタンスに送信されるタイミングが決定されます。 

ロード バランサーに正常性プローブを追加する場合は、Azure portal でロード バランサーにアクセスし、 **[正常性プローブ]** を選択してから、 **[+ 追加]** を選択します。

| 設定 | 詳細 |
| ---------- | ---------- |
| 名前 | 正常性プローブの名前。 |
| Protocol | 選択したプロトコルによって、バックエンド インスタンスが正常かどうかを判断するために使用されるチェックの種類が決まります。 </br> 次のようなオプションがあります。 </br> **TCP** </br> **HTTPS** </br> **HTTP** </br> 確実に適切なプロトコルを使用してください。 この選択は、アプリケーションの性質によって異なります。 </br> 正常性プローブの構成とプローブの応答によって、新しいフローを受信するバックエンド プール インスタンスが決まります。 </br> 正常性プローブを使用して、バックエンド エンドポイント上のアプリケーションの障害を検出することができます。 </br> 正常性プローブの詳細については、[こちら](load-balancer-custom-probe-overview.md)を参照してください。 |
| Port | 正常性プローブの宛先ポート。 </br> この設定は、インスタンスの正常性を判断するために正常性プローブによって使用されるバックエンド インスタンスのポートです。 |
| Interval | プローブの試行の間隔を示す秒数。 </br> この間隔によって、正常性プローブがバックエンド インスタンスに接続を試行する頻度が決まります。 </br> 5 を選択した場合、2 番目のプローブ試行は 5 秒後に実行されます。 |
| 異常のしきい値 | VM が異常であると見なされるまでに、プローブが連続して失敗する回数。</br> 2 を選択した場合、2 回連続して失敗した後は、新しいフローがこのバックエンド インスタンスに設定されなくなります。 |

:::image type="content" source="./media/manage/health-probe.png" alt-text="正常性プローブの追加。" border="true":::

## <a name="load-balancing-rules"></a>負荷分散規則

受信トラフィックをバックエンド プール内のすべてのインスタンスに分散させる方法を定義します。 負荷分散規則により、フロントエンドの特定の IP 構成およびポートがバックエンドの複数の IP アドレスおよびポートにマップされます。

ご使用のロード バランサーにロード バランサー規則を追加する場合は、Azure portal でロード バランサーにアクセスし、 **[ロード バランサー規則]** を選択してから、 **[+ 追加]** を選択します。
    
| 設定 | 詳細 |
| ---------- | ---------- |
| 名前 | ロード バランサー規則の名前。 |
| IP バージョン | 選択肢は **[IPv4]** または **[IPv6]** です。  |
| フロントエンド IP アドレス | フロントエンド IP アドレスを選択します。 </br> ロード バランサー規則を関連付けるロード バランサーのフロントエンド IP アドレス。|
| Protocol | Azure Load Balancer は、レイヤー 4 のネットワーク ロード バランサーです。 </br> オプションは次のとおりです。 **[TCP]** または **[UDP]** 。 |
| Port | この設定は、この負荷分散規則に基づいてトラフィックを分散させるフロントエンド IP に関連付けられているポートです。 |
| バックエンド ポート | この設定は、ロード バランサーがトラフィックの送信先とするバックエンド プール内のインスタンスのポートです。 この設定は、フロントエンド ポートと同じにすることも、アプリケーションの柔軟性が必要な場合は異なるものにすることもできます。 |
| バックエンド プール | このロード バランサー規則を適用するバックエンド プール。 |
| 正常性プローブ | バックエンド プール内のインスタンスの状態を確認するために作成した正常性プローブ。 </br> 正常なインスタンスだけが新しいトラフィックを受信します。 |
| セッション永続化 |  次のようなオプションがあります。 </br> **なし** </br> **クライアント IP** </br> **クライアント IP とプロトコル**</br> </br> クライアントからバックエンド プール内の同じ仮想マシンへのトラフィックを維持します。 このトラフィックは、セッションの間、維持されます。 </br> **[なし]** : 同じクライアントからの連続した要求が、任意の仮想マシンによって処理できることを指定します。 </br> **[クライアント IP]** : 同じクライアント IP アドレスからの連続する要求が、同じ仮想マシンによって処理されることを指定します。 </br> **[クライアント IP とプロトコル]** : 同じクライアント IP アドレスとプロトコルからの連続する要求が、同じ仮想マシンによって処理されることを確保します。 </br> 分散モードの詳細については、[こちら](load-balancer-distribution-mode.md)を参照してください。 |
| アイドル タイムアウト (分) | キープアライブ メッセージの送信をクライアントに依存せずに、**TCP** 接続または **HTTP** 接続を開いたままにします。 |  
| TCP リセット | 接続がアイドル状態になったときに、より予測可能なアプリケーション動作を作成するのに役立てるため、ロード バランサーによって **TCP リセット** を送信することができます。 </br> TCP リセットについての詳細については、[こちら](load-balancer-tcp-reset.md)を参照してください。|
| フローティング IP | フローティング IP は、**Direct Server Return (DSR)** と呼ばれるものの一部に対する Azure の用語です。 </br> DSR は次の 2 つの部分から構成されます。 <br> 1.フロー トポロジ </br> 2.プラットフォーム レベルの IP アドレス マッピング スキーム。 </br></br> Azure Load Balancer は、フローティング IP が有効かどうかにかかわらず、常に DSR フロー トポロジで動作します。 </br> この動作は、フローの送信部分は常に起点に直接フローするように正しく書き換えられることを意味します。 </br> フローティング IP がない場合、従来の負荷分散 IP アドレス マッピング スキームである VM インスタンスの IP が Azure によって公開されます。 </br> フローティング IP を有効にすると、IP アドレス マッピングがロード バランサーのフロントエンド IP に変更され、柔軟性が向上します。 </br> 詳細については、「[Azure Load Balancer の複数のフロントエンド](load-balancer-multivip-overview.md)」を参照してください。|
| 暗黙的なアウトバウンド規則の作成 | このため、 **[いいえ]** を選択します。 </br> 既定値: **disableOutboundSnat = false**  </br> この場合、送信は同じフロントエンド IP を介して行われます。 </br></br> **disableOutboundSnat = true** </br>この場合、送信にはアウトバウンド規則が必要です。 |

:::image type="content" source="./media/manage/load-balancing-rule.png" alt-text="負荷分散規則の追加。" border="true":::

## <a name="inbound-nat-rules"></a>受信 NAT のルール

インバウンド NAT 規則によって、フロントエンド IP アドレスとポートの組み合わせに送信された受信トラフィックが転送されます。 

トラフィックは、バックエンド プール内の特定の仮想マシンまたはインスタンスに送信されます。 ポート フォワーディングも、負荷分散と同じハッシュベースの分散によって実行されます。

シナリオで、バックエンド プール内の VM インスタンスを分離するためにリモート デスクトップ プロトコル (RDP) または Secure Shell (SSH) セッションが必要な場合、 複数の内部エンドポイントを、同じフロントエンド IP アドレスのポートにマッピングできます。 

フロントエンド IP アドレスを使用すると、ジャンプ ボックスを追加しなくても VM をリモート管理できます。

インバウンド NAT 規則をロード バランサーに追加する場合は、Azure portal でロード バランサーにアクセスし、 **[インバウンド NAT 規則]** を選択してから、 **[+ 追加]** を選択します。

| 設定 | 詳細 |
| ---------- | ---------- |
| 名前 | インバウンド NAT 規則の名前 |
| フロントエンド IP アドレス | フロントエンド IP アドレスを選択します。 </br> インバウンド NAT 規則を関連付けるロード バランサーのフロントエンド IP アドレス。 |
| IP バージョン | 選択肢は [IPv4] と [IPv6] です。 |
| サービス | Azure Load Balancer 実行するサービスの種類。 </br> ここで選択すると、ポート情報が適切に更新されます。 |
| Protocol | Azure Load Balancer は、レイヤー 4 のネットワーク ロード バランサーです。 </br> オプションは次のとおりです。[TCP] または [UDP]。 |
| アイドル タイムアウト (分) | キープアライブ メッセージの送信をクライアントに依存せずに、TCP 接続または HTTP 接続を開いたままにします。 |
| TCP リセット | 接続がアイドル状態になったときに、より予測可能なアプリケーション動作を作成するのに役立てるため、ロード バランサーによって TCP リセットを送信することができます。 </br> TCP リセットについての詳細については、[こちら](load-balancer-tcp-reset.md)を参照してください。 |
| Port | この設定は、このインバウンド NAT 規則に基づいてトラフィックを分散させるフロントエンド IP に関連付けられているポートです。 |
| ターゲット仮想マシン | この規則を関連付けるバックエンド プールの仮想マシン部分。 |
| ポートのマッピング | この設定は、既定値のままにすることも、アプリケーションの設定に基づいてカスタマイズすることもできます。 |

:::image type="content" source="./media/manage/inbound-nat-rule.png" alt-text="インバウンド NAT 規則の追加。" border="true":::

## <a name="outbound-rules"></a>アウトバウンド規則

ロードバランサーのアウトバウンド規則では、バックエンド プール内の VM 用に送信 SNAT を構成します。

アウトバウンド規則をロード バランサーに追加する場合は、Azure portal でロード バランサーにアクセスし、 **[アウトバウンド規則]** を選択してから、 **[+ 追加]** を選択します。

| 設定 | 詳細 |
| ------- | ------ |
| 名前 | アウトバウンド規則の名前。 |
| フロントエンド IP アドレス | フロントエンド IP アドレスを選択します。 </br> アウトバウンド規則を関連付けるロード バランサーのフロントエンド IP アドレス。 |
| Protocol | Azure Load Balancer は、レイヤー 4 のネットワーク ロード バランサーです。 </br> オプションは次のとおりです。 **[すべて]** 、 **[TCP]** 、または **[UDP]** 。 |
| アイドル タイムアウト (分) | キープアライブ メッセージの送信をクライアントに依存せずに、**TCP** 接続または **HTTP** 接続を開いたままにします。 |
| TCP リセット | 接続がアイドル状態になったときに、より予測可能なアプリケーション動作を作成するのに役立てるため、ロード バランサーによって **TCP リセット** を送信することができます。 </br> TCP リセットについての詳細については、[こちら](load-balancer-tcp-reset.md)を参照してください。 |
| バックエンド プール | このアウトバウンド規則を適用するバックエンド プール。 |

### <a name="port-allocation"></a>ポートの割り当て

| 設定 | 詳細 |
| ------- | ------ |
| ポートの割り当て | **[送信ポートの数を手動で選択する]** を選択することをお勧めします|

### <a name="outbound-ports"></a>送信ポート

| 設定 | 詳細 |
| ------- | ------ |
| 選択基準 | **[インスタンスごとのポート]** を選択します |
| インスタンスあたりのポート数 | 「**10,000**」と入力します。 |

:::image type="content" source="./media/manage/outbound-rule.png" alt-text="インバウンド アウトバウンド規則の追加。" border="true":::

## <a name="next-steps"></a>次の手順

この記事では、Azure portal での Azure Load Balancer に対するさまざまな用語と設定について説明しました。

* Azure Load Balancer についてさらに詳しく[学習する](./load-balancer-overview.md)。
* Azure Load Balancer に関して[よく寄せられる質問](./load-balancer-faqs.md)。