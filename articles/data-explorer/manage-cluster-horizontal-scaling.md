---
title: Azure Data Explorer クラスターのスケールアウト
description: この記事では、変化する需要に基づいて、Azure Data Explorer クラスターをスケールアウトおよびスケールインする手順について説明します。
author: orspod
ms.author: orspodek
ms.reviewer: mblythe
ms.service: data-explorer
ms.topic: conceptual
ms.date: 06/30/2019
ms.openlocfilehash: 29bfcc42462a667850f0b2e1bbda3d29cd1597ab
ms.sourcegitcommit: 1e347ed89854dca2a6180106228bfafadc07c6e5
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/05/2019
ms.locfileid: "67571265"
---
# <a name="manage-cluster-horizontal-scaling-to-accommodate-changing-demand"></a>需要の変化に対応するためにクラスターの水平スケーリングを管理する

クラスターのサイズを適切に設定することは、Azure データ エクスプローラーのパフォーマンスにとって重要なことです。 しかし、クラスターに対する需要を絶対の精度で予測することはできません。 静的クラスター サイズは過少使用や過剰使用につながる可能性があります。いずれも理想的ではありません。

変化する需要に合わせて容量を追加および削除して、クラスターを*スケーリング*することをお勧めします。 スケーリングには 2 つのワークフローがあります。 
* 水平スケーリング (スケールアウトとスケールインともいう)。
* 垂直スケーリング (スケールアップとスケールダウンともいう)。

この記事では、水平スケーリングのワークフローについて説明します。

水平スケーリングでは、事前に定義されたルールとスケジュールに基づいて、インスタンス数を自動的にスケーリングすることができます。 以下の記事の説明に従って、Azure portal でのクラスターの自動スケーリング設定を指定します。

## <a name="steps-to-configure-horizontal-scaling"></a>水平スケーリングの構成手順

Azure portal で、Data Explorer クラスター リソースに移動します。 **[設定]** という見出しの下にある **[スケール アウト]** を選択します。 

必要な自動スケーリング方法を選択します: **[手動スケール]** 、 **[Optimized autoscale]\(最適化された自動スケーリング\)** または **[Custom autoscale]\(カスタム自動スケーリング\)** 。

### <a name="manual-scale"></a>手動でのスケーリング

手動スケールは、クラスターの作成時の既定の設定です。 これは、クラスターに、自動的には変更されない静的なクラスターの容量があることを意味します。 静的な容量はバーを使用して選択することができ、これは、次回、クラスターのスケールアウト設定を変更するまで変更されません。

   ![手動スケール方法](media/manage-cluster-horizontal-scaling/manual-scale-method.png)

### <a name="optimized-autoscale"></a>最適化された自動スケーリング

最適化された自動スケーリングは、推奨される自動スケーリング方法です。 最適化された自動スケーリングの構成手順:

1. [Optimized autoscale]\(最適化された自動スケーリング\) オプションを選択し、クラスターのインスタンス量に対する下限と上限を選択すると、自動スケーリングはこれらの制限の間で行われます。
2. [保存] をクリックします。

   ![最適化された自動スケーリング方法](media/manage-cluster-horizontal-scaling/optimized-autoscale-method.png)

[保存] をクリックした後、最適化された自動スケーリング メカニズムが作動し始め、そのアクションがクラスターのアクティビティ ログに表示されます。 この自動スケーリング方法では、クラスターのパフォーマンスとコストが最適化されます。クラスターが過小使用の状態になり始めると、スケールインされ、パフォーマンスは同じままで、コストが低くなります。クラスターが過大使用の状態になり始めると、スケールアウトされ、パフォーマンスは確実に良くなります

### <a name="custom-autoscale"></a>カスタム自動スケーリング

カスタム自動スケーリング方法では、指定したメトリックに基づいて、クラスターを動的にスケーリングできます。 次の図は、カスタム自動スケーリングを構成するフローと手順を示しています。 図の下に詳細情報があります。

1. **[自動スケール設定の名前]** で、*スケールアウト: キャッシュ使用率* などの名前を指定します。 

   ![スケール ルール](media/manage-cluster-horizontal-scaling/custom-autoscale-method.png)

2. **[スケール モード]** には、 **[メトリックに基づいてスケーリングする]** を選択します。 このモードは、動的スケーリングを提供します。 また、 **[特定のインスタンス数にスケーリングする]** も選択できます。

3. **[+ ルールの追加]** を選択します。

4. 右側の **[スケール ルール]** セクションで、各設定の値を指定します。

    **条件**

    | Setting | 説明と値 |
    | --- | --- |
    | **時間の集計** | **[平均]** など、集計条件を選択します。 |
    | **メトリック名** | **[キャッシュ使用率]** など、スケール操作のベースとするメトリックを選択します。 |
    | **時間グレインの統計** | **[平均]** 、 **[最小]** 、 **[最大]** 、 **[合計]** から選択します。 |
    | **演算子** | **[次の値以上]** など、適切なオプションを選択します。 |
    | **しきい値** | 適切な値を選択します。 たとえば、キャッシュ使用率の場合、80% が適切な開始点です。 |
    | **期間 (分)** | システムでメトリックを計算する際にさかのぼって確認する適切な期間を選択します。 既定値の 10 分から始めます。 |
    |  |  |

    **アクション**

    | Setting | 説明と値 |
    | --- | --- |
    | **操作** | スケールインまたはスケール アウトする適切なオプションを選択します。 |
    | **インスタンス数** | メトリック条件が満たされたときに追加または削除するノードまたはインスタンスの数を選択します。 |
    | **クール ダウン (分)** | スケール操作の間の待機する適切な時間間隔を選択します。 既定値の 5 分から始めます。 |
    |  |  |

5. **[追加]** を選択します。

6. 左側の **[インスタンスの制限]** セクションで、各設定の値を指定します。

    | Setting | 説明と値 |
    | --- | --- |
    | **最小** | インスタンス数の下限。使用率に関係なく、クラスターはこの数未満にスケールしません。 |
    | **[最大]** | インスタンス数の上限。使用率に関係なく、クラスターはこの数を超えてスケールしません。 |
    | **既定値** | 既定のインスタンス数。 この設定は、リソース メトリックの読み取りで問題がある場合に使用されます。 |
    |  |  |

7. **[保存]** を選択します。

これで、Azure データ エクスプローラー クラスターのスケールアウト操作が構成されました。 スケールイン操作には別のルールを追加します。 クラスターのスケーリングに関する問題が発生したときにサポートが必要な場合は、Azure portal で[サポート要求を開いてください](https://portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade/overview)。

## <a name="next-steps"></a>次の手順

* [メトリックを使用した Azure Data Explorer のパフォーマンス、正常性、および使用状況の監視](using-metrics.md)
* クラスターの適切なサイズ設定を行うために、[クラスターの垂直スケーリングを管理](manage-cluster-vertical-scaling.md)する。
