---
title: Azure File Sync エージェントのリリース ノート | Microsoft Docs
description: Azure File Sync エージェントのリリース ノート。
services: storage
author: wmgries
ms.service: storage
ms.topic: article
ms.date: 12/10/2018
ms.author: wgries
ms.component: files
ms.openlocfilehash: 87e6f2c956766011adef23ce9a8565625483a244
ms.sourcegitcommit: c94cf3840db42f099b4dc858cd0c77c4e3e4c436
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/19/2018
ms.locfileid: "53635546"
---
# <a name="release-notes-for-the-azure-file-sync-agent"></a>Azure File Sync エージェントのリリース ノート
Azure ファイル同期を使用すると、オンプレミスのファイル サーバーの柔軟性、パフォーマンス、互換性を損なわずに Azure Files で組織のファイル共有を一元化できます。 お使いの Windows Server のインストール済み環境が、Azure ファイル共有の高速キャッシュに生まれ変わります。 SMB、NFS、FTPS など、Windows Server 上で利用できるあらゆるプロトコルを使用して、データにローカルにアクセスできます。 キャッシュは、世界中にいくつでも必要に応じて設置することができます。

この記事では、サポートされているバージョンの Azure File Sync エージェントのリリース ノートについて取り上げます。

## <a name="supported-versions"></a>サポートされているバージョン
Azure File Sync エージェントでサポートされるバージョンは次のとおりです。

| マイルストーン | エージェントのバージョン番号 | リリース日 | Status |
|----|----------------------|--------------|------------------|
| 12 月の更新プログラム ロールアップ - [KB4459990](https://support.microsoft.com/help/4459990)| 4.2.0.0 | 2018 年 12 月 10 日 | サポートされています (推奨されるバージョン) |
| 12 月の更新プログラム ロールアップ | 4.1.0.0 | 2018 年 12 月 4 日 | サポートされています |
| V4 リリース | 4.0.1.0 | 2018 年 11 月 13 日 | サポートされています |
| 9 月の更新プログラム ロールアップ | 3.3.0.0 | 2018 年 9 月 24 日 | サポートされています |
| 8 月の更新プログラム ロールアップ | 3.2.0.0 | 2018 年 8 月 15 日 | サポートされています |
| 一般公開 | 3.1.0.0 | 2018 年 7 月 19 日 | サポートされています |
| 6 月の更新プログラム ロールアップ | 3.0.13.0 | 2018 年 6 月 29 日 | サポートされていません - エージェント バージョンは 2018 年 10 月 1 日に有効期限が切れました |
| 更新 2 | 3.0.12.0 | 2018 年 5 月 22 日 | サポートされていません - エージェント バージョンは 2018 年 10 月 1 日に有効期限が切れました |
| 4 月の更新プログラム ロールアップ | 2.3.0.0 | 2018 年 5 月 8 日 | サポートされていません - エージェント バージョンは 2018 年 10 月 1 日に有効期限が切れました |
| 3 月の更新プログラム ロールアップ | 2.2.0.0 | 2018 年 3 月 12 日 | サポートされていません - エージェント バージョンは 2018 年 10 月 1 日に有効期限が切れました |
| 2 月の更新プログラム ロールアップ | 2.1.0.0 | 2018 年 2 月 28 日 | サポートされていません - エージェント バージョンは 2018 年 10 月 1 日に有効期限が切れました |
| 更新 1 | 2.0.11.0 | 2018 年 2 月 8 日 | サポートされていません - エージェント バージョンは 2018 年 10 月 1 日に有効期限が切れました |
| 1 月の更新プログラム ロールアップ | 1.4.0.0 | 2018 年 1 月 8 日 | サポートされていません - エージェント バージョンは 2018 年 10 月 1 日に有効期限が切れました |
| 11 月の更新プログラム ロールアップ | 1.3.0.0 | 2017 年 11 月 30 日 | サポートされていません - エージェント バージョンは 2018 年 10 月 1 日に有効期限が切れました |
| 10 月の更新プログラム ロールアップ | 1.2.0.0 | 2017 年 10 月 31 日 | サポートされていません - エージェント バージョンは 2018 年 10 月 1 日に有効期限が切れました |
| 初期プレビュー リリース | 1.1.0.0 | 2017 年 9 月 26 日 | サポートされていません - エージェント バージョンは 2018 年 10 月 1 日に有効期限が切れました |

### <a name="azure-file-sync-agent-update-policy"></a>Azure ファイル同期エージェントの更新ポリシー
[!INCLUDE [storage-sync-files-agent-update-policy](../../../includes/storage-sync-files-agent-update-policy.md)]

## <a name="agent-version-4200"></a>エージェント バージョン 4.2.0.0
次のリリース ノートは、2018 年 12 月 10 日にリリースされた Azure File Sync エージェントのバージョン 4.2.0.0 を対象としています。 バージョン 4.0.1.0 に関して記載されているリリース ノートへの追記となります。

このリリースで修正された問題は、以下のとおりです。  
- VSS スナップショットが作成されるときに停止エラー 0x3B または停止エラー 0x1E が発生することがある。  
- クラウドを使った階層化が有効になっているとメモリ リークが生じることがある。  

## <a name="agent-version-4100"></a>エージェント バージョン 4.1.0.0
次のリリース ノートは、2018 年 12 月 4 日にリリースされた Azure File Sync エージェントのバージョン 4.1.0.0 を対象としています。 バージョン 4.0.1.0 に関して記載されているリリース ノートへの追記となります。

このリリースで修正された問題は、以下のとおりです。  
- クラウドを使った階層化で生じたメモリ リークにより、サーバーが無応答状態になることがある。  
- エージェントのインストールが次のエラーで失敗する: エラー 1921。 サービス 'Storage Sync Agent' (FileSyncSvc) を停止できません。  システム サービスを停止するのに十分な特権があることを確認してください。  
- メモリ使用量が大きいと、ストレージ同期エージェント (FileSyncSvc) サービスがクラッシュすることがあります。  
- クラウドを使った階層化と同期に関して、さまざまな点で信頼性が向上しています。

## <a name="agent-version-4010"></a>エージェント バージョン 4.0.1.0
次のリリース ノートは、2018 年 11 月 13 日にリリースされた Azure File Sync エージェントのバージョン 4.0.1.0 を対象としています。

### <a name="evaluation-tool"></a>評価ツール
Azure File Sync をデプロイする前に、Azure File Sync 評価ツールを使用して、お使いのシステムと互換性があるかどうかを評価する必要があります。 このツールは Azure PowerShell コマンドレットであり、サポートされていない文字やサポートされていない OS バージョンなど、ファイル システムとデータセットに関する潜在的な問題をチェックします。 インストールおよび使用手順については、計画ガイドの「[評価ツール](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#evaluation-tool)」セクションを参照してください。 

### <a name="agent-installation-and-server-configuration"></a>エージェントのインストールとサーバー構成
Windows Server で Azure File Sync エージェントをインストールして構成する方法の詳細については、「[Planning for an Azure File Sync deployment (Azure File Sync のデプロイの計画)](storage-sync-files-planning.md)」および [Azure File Sync をデプロイする方法](storage-sync-files-deployment-guide.md)に関するページを参照してください。

- エージェント インストール パッケージは、引き上げられた (管理者) 特権でインストールする必要があります。
- Windows Server Core または Nano Server のデプロイ オプションでは、エージェントはサポートされません。
- このエージェントがサポートされるのは、Windows Server 2016 と Windows Server 2012 R2 のみです
- エージェントには、少なくとも 2 GiB のメモリが必要です。 動的メモリを有効にした仮想マシンでサーバーが実行されている場合は、2048 MiB 以上のメモリで VM を構成する必要があります。
- Storage Sync Agent (FileSyncSvc) サービスは、システム ボリューム情報 (SVI) ディレクトリが圧縮されているボリュームに配置されたサーバーのエンドポイントをサポートしません。 この構成は、予期しない結果になります。
- VSS スナップショットが作成されるときに停止エラー 0x3B または停止エラー 0x1E が発生することがあります。

### <a name="interoperability"></a>相互運用性
- 階層化されたファイルにアクセスするウイルス対策やバックアップなどのアプリケーションは、オフライン属性を考慮してそれらのファイルのコンテンツの読み取りをスキップする場合を除き、望ましくない再呼び出しを行う可能性があります。 詳細については、「[Troubleshoot Azure File Sync (Azure File Sync のトラブルシューティング)](storage-sync-files-troubleshoot.md)」を参照してください。
- ファイル スクリーンによってファイルがブロックされた場合、File Server Resource Manager (FSRM) ファイル スクリーンが頻繁に同期エラーを引き起こす可能性があります。
- Azure File Sync エージェントがインストールされているサーバー上での sysprep の実行はサポートされていません。予期しない結果になる可能性があります。 Azure File Sync エージェントは、サーバー イメージの展開と sysprep ミニ セットアップの完了後にインストールされます。
- データ重複除去とクラウドの階層化は、同じボリューム上ではサポートされません。

### <a name="sync-limitations"></a>同期の制限事項
次の項目は同期されませんが、システムの残りの部分は引き続き正常に動作します。
- サポートされていない文字を含むファイル。 サポートされていない文字の一覧については、[トラブルシューティング ガイド](storage-sync-files-troubleshoot.md#handling-unsupported-characters)のページを参照してください。
- 末尾がピリオドのファイルまたはディレクトリ。
- 2,048 文字を超えるパス。
- 2 KB を超えるセキュリティ記述子の随意アクセス制御リスト (DACL) 部分  (この問題が該当するのは、1 つの項目に対するアクセス制御エントリ (ACE) が約 40 個を超える場合のみです)。
- 監査に使用されるセキュリティ記述子のシステム アクセス制御リスト (SACL) 部分。
- 拡張属性。
- 代替データ ストリーム。
- 再解析ポイント。
- ハード リンク。
- 圧縮がサーバー ファイルに設定されている場合、変更が他のエンドポイントからそのファイルに同期されるときに、圧縮は保持されません。
- サービスがデータを読み取ることを妨げる、EFS (またはその他のユーザー モードの暗号化) で暗号化されたファイル。

    > [!Note]  
    > 転送中のデータは、Azure File Sync によって常に暗号化されます。 データは常に暗号化されて Azure に保存されます。
 
### <a name="server-endpoint"></a>サーバー エンドポイント
- サーバー エンドポイントは、NTFS ボリューム上にのみ作成できます。 ReFS、FAT、FAT32 などのファイル システムは、現在 Azure File Sync でサポートされていません。
- サーバーのエンドポイントを削除する前にファイルが再呼び出しされない場合、階層化ファイルはアクセスできなくなります。 ファイルへのアクセスを復元するには、サーバー エンドポイントを再作成します。 サーバー エンドポイントが削除されてから 30 日間が経過した場合、またはクラウド エンドポイントが削除された場合は、再呼び出しされなかった階層化ファイルは使用できなくなります。
- システム ボリュームでは、クラウドの階層化はサポートされていません。 システム ボリュームにサーバー エンドポイントを作成するには、サーバー エンドポイントを作成するときにクラウドの階層化を無効にします。
- フェールオーバー クラスタリングは、クラスター化ディスクでのみサポートされ、クラスターの共有ボリューム (CSV) ではサポートされません。
- サーバー エンドポイントを入れ子にすることはできません。 同じボリューム上に、別のエンドポイントと並列に共存させることはできます。
- サーバー エンドポイントの場所内に OS またはアプリケーションのページング ファイルを格納しないでください。
- サーバーの名前を変更した場合、ポータル内のサーバー名は更新されません。 ポータル内のサーバー名を更新するには、サーバーをいったん登録解除してから再登録します。

### <a name="cloud-endpoint"></a>クラウド エンドポイント
- Azure File Sync は、Azure ファイル共有に対する直接的な変更をサポートします。 ただし、Azure ファイル共有に対して行われた変更は、まず Azure File Sync の変更検出ジョブによって認識される必要があります。 クラウド エンドポイントに対する変更検出ジョブは、24 時間に 1 回起動されます。 さらに、REST プロトコルで Azure ファイル共有に対して行われた変更は、SMB の最終更新時刻を更新するものではなく、同期による変更とは見なされません。
- ストレージ同期サービスやストレージ アカウントは、既存の Azure AD テナント内の別のリソース グループまたはサブスクリプションに移動できます。 ストレージ アカウントを移動する場合は、そのストレージ アカウントにハイブリッド ファイル同期サービス アクセス権を付与する必要があります (「[Azure File Sync がストレージ アカウントへのアクセス権を持っていることを確認します](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)」を参照してください)。

    > [!Note]  
    > Azure File Sync では、別の Azure AD テナントへのサブスクリプションの移動がサポートされません。

### <a name="cloud-tiering"></a>クラウドの階層化
- 日付ベースのクラウド階層化ポリシー設定は、指定された日数以内にアクセスされた場合にキャッシュする必要があるファイルの指定に使用されます。 詳細については、「[クラウドの階層化の概要](https://docs.microsoft.com/azure/storage/files/storage-sync-cloud-tiering#afs-force-tiering)」を参照してください。
- 階層化されたファイルが Robocopy を使用して別の場所にコピーされた場合、その結果のファイルは階層化されません。 誤ってオフライン属性が Robocopy によるコピー操作の対象となり、オフライン属性が設定される場合があります。
- robocopy を使用してファイルをコピーする場合は、/MIR オプションを使用してファイルのタイムスタンプを保存します。 これにより、必ず最近アクセスされたファイルより先に、古いファイルが階層化されます。
- SMB クライアントからファイルのプロパティを表示するとき、SMB によるファイルのメタデータのキャッシュが原因で、オフライン属性が正しく設定されていないように見えることがあります。

## <a name="agent-version-3300"></a>エージェント バージョン 3.3.0.0
次のリリース ノートは、2018 年 9 月 24 日にリリースされた Azure File Sync エージェントのバージョン 3.3.0.0 を対象としています。 バージョン 3.1.0.0 に関して記載されているリリース ノートへの追記となります。

このリリースで修正された問題は、以下のとおりです。
- Azure File Sync エージェントをバージョン 3.1 または 3.2 にアップグレードすると、登録済みサーバーの状態が "オフラインのようです" になる。
- パスの長いファイルが原因で、ストレージ同期エージェント (FileSyncSvc) サービスがクラッシュする。
- 次のエラーでサーバーの登録が失敗する: "ファイルまたはアセンブリ Kailani.Afs.StorageSyncProtocol.V3 を読み込めませんでした"

## <a name="agent-version-3200"></a>エージェント バージョン 3.2.0.0
次のリリース ノートは、2018 年 8 月 15 日にリリースされた Azure File Sync エージェントのバージョン 3.2.0.0 を対象としています。 バージョン 3.1.0.0 に関して記載されているリリース ノートへの追記となります。

このリリースでは、以下の修正が行われています。
- メモリ リークのためにメモリ不足エラー (0x8007000e) で同期が失敗する

## <a name="agent-version-3100"></a>エージェント バージョン 3.1.0.0
次のリリース ノートは、(2018 年 7 月 19 日にリリースされた) Azure File Sync エージェントのバージョン 3.1.0.0 を対象としています。

### <a name="evaluation-tool"></a>評価ツール
Azure File Sync をデプロイする前に、Azure File Sync 評価ツールを使用して、お使いのシステムと互換性があるかどうかを評価する必要があります。 このツールは Azure PowerShell コマンドレットであり、サポートされていない文字やサポートされていない OS バージョンなど、ファイル システムとデータセットに関する潜在的な問題をチェックします。 インストールおよび使用手順については、計画ガイドの「[評価ツール](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#evaluation-tool)」セクションを参照してください。 

### <a name="agent-installation-and-server-configuration"></a>エージェントのインストールとサーバー構成
Windows Server で Azure File Sync エージェントをインストールして構成する方法の詳細については、「[Planning for an Azure File Sync deployment (Azure File Sync のデプロイの計画)](storage-sync-files-planning.md)」および [Azure File Sync をデプロイする方法](storage-sync-files-deployment-guide.md)に関するページを参照してください。

- エージェント インストール パッケージは、引き上げられた (管理者) 特権でインストールする必要があります。
- Windows Server Core または Nano Server のデプロイ オプションでは、エージェントはサポートされません。
- このエージェントがサポートされるのは、Windows Server 2016 と Windows Server 2012 R2 のみです
- エージェントには、少なくとも 2 GB の物理メモリが必要です。
- Storage Sync Agent (FileSyncSvc) サービスは、システム ボリューム情報 (SVI) ディレクトリが圧縮されているボリュームに配置されたサーバーのエンドポイントをサポートしません。 この構成は、予期しない結果になります。

### <a name="interoperability"></a>相互運用性
- 階層化されたファイルにアクセスするウイルス対策やバックアップなどのアプリケーションは、オフライン属性を考慮してそれらのファイルのコンテンツの読み取りをスキップする場合を除き、望ましくない再呼び出しを行う可能性があります。 詳細については、「[Troubleshoot Azure File Sync (Azure File Sync のトラブルシューティング)](storage-sync-files-troubleshoot.md)」を参照してください。
- ファイル サーバー リソース マネージャー (FSRM) などのファイル スクリーンは使用しないでください。 ファイル スクリーンによってファイルがブロックされ、同期エラーが頻繁に発生する可能性があります。
- Azure File Sync エージェントがインストールされているサーバー上での sysprep の実行はサポートされていません。予期しない結果になる可能性があります。 エージェントのインストールとサーバーの登録は、サーバー イメージの展開と sysprep ミニ セットアップの完了後に行われます。
- データ重複除去とクラウドの階層化は、同じボリューム上ではサポートされません。

### <a name="sync-limitations"></a>同期の制限事項
次の項目は同期されませんが、システムの残りの部分は引き続き正常に動作します。
- 2,048 文字を超えるパス。
- 2 KB を超えるセキュリティ記述子の随意アクセス制御リスト (DACL) 部分  (この問題が該当するのは、1 つの項目に対するアクセス制御エントリ (ACE) が約 40 個を超える場合のみです)。
- 監査に使用されるセキュリティ記述子のシステム アクセス制御リスト (SACL) 部分。
- 拡張属性。
- 代替データ ストリーム。
- 再解析ポイント。
- ハード リンク。
- 圧縮がサーバー ファイルに設定されている場合、変更が他のエンドポイントからそのファイルに同期されるときに、圧縮は保持されません。
- サービスがデータを読み取ることを妨げる、EFS (またはその他のユーザー モードの暗号化) で暗号化されたファイル。

    > [!Note]  
    > 転送中のデータは、Azure File Sync によって常に暗号化されます。 データは常に暗号化されて Azure に保存されます。
 
### <a name="server-endpoint"></a>サーバー エンドポイント
- サーバー エンドポイントは、NTFS ボリューム上にのみ作成できます。 ReFS、FAT、FAT32 などのファイル システムは、現在 Azure File Sync でサポートされていません。
- サーバーのエンドポイントを削除する前にファイルが再呼び出しされない場合、階層化されたファイルは使用できなくなります。
- システム ボリュームでは、クラウドの階層化はサポートされていません。 システム ボリュームにサーバー エンドポイントを作成するには、サーバー エンドポイントを作成するときにクラウドの階層化を無効にします。
- フェールオーバー クラスタリングは、クラスター化ディスクでのみサポートされ、クラスターの共有ボリューム (CSV) ではサポートされません。
- サーバー エンドポイントを入れ子にすることはできません。 同じボリューム上に、別のエンドポイントと並列に共存させることはできます。
- サーバー エンドポイント内に OS またはアプリケーションのページング ファイルを格納しないでください。
- サーバーの名前を変更した場合、ポータル内のサーバー名は更新されません。 ポータル内のサーバー名を更新するには、サーバーをいったん登録解除してから再登録します。

### <a name="cloud-endpoint"></a>クラウド エンドポイント
- Azure File Sync は、Azure ファイル共有に対する直接的な変更をサポートします。 ただし、Azure ファイル共有に対して行われた変更は、まず Azure File Sync の変更検出ジョブによって認識される必要があります。 クラウド エンドポイントに対する変更検出ジョブは、24 時間に 1 回起動されます。 さらに、REST プロトコルで Azure ファイル共有に対して行われた変更は、SMB の最終更新時刻を更新するものではなく、同期による変更とは見なされません。
- ストレージ同期サービスやストレージ アカウントは、既存の Azure AD テナント内の別のリソース グループまたはサブスクリプションに移動できます。 ストレージ アカウントを移動する場合は、そのストレージ アカウントにハイブリッド ファイル同期サービス アクセス権を付与する必要があります (「[Azure File Sync がストレージ アカウントへのアクセス権を持っていることを確認します](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)」を参照してください)。

    > [!Note]  
    > Azure File Sync では、別の Azure AD テナントへのサブスクリプションの移動がサポートされません。

### <a name="cloud-tiering"></a>クラウドの階層化
- 階層化されたファイルが Robocopy を使用して別の場所にコピーされた場合、その結果のファイルは階層化されません。 誤ってオフライン属性が Robocopy によるコピー操作の対象となり、オフライン属性が設定される場合があります。
- SMB クライアントからファイルのプロパティを表示するとき、SMB によるファイルのメタデータのキャッシュが原因で、オフライン属性が正しく設定されていないように見えることがあります。
