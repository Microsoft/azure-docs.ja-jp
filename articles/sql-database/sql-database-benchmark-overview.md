---
title: "Azure SQL Database ベンチマークの概要"
description: "このトピックでは、Azure SQL Database のパフォーマンス測定で使用される Azure SQL Database ベンチマークについて説明します。"
services: sql-database
documentationcenter: na
author: jan-eng
manager: jhubbard
editor: monicar
ms.assetid: e26f8a66-2c12-49d7-8297-45b4d48a5c01
ms.service: sql-database
ms.custom: overview
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 06/21/2016
ms.author: janeng
translationtype: Human Translation
ms.sourcegitcommit: 2681dd3792a351fecc0c72eb7fe546113a451d24
ms.openlocfilehash: 7b9b222be1a131d2a80d37404cbdd309b61785f3
ms.lasthandoff: 01/13/2017


---
# <a name="azure-sql-database-benchmark-overview"></a>Azure SQL Database ベンチマークの概要
## <a name="overview"></a>概要
Microsoft Azure SQL Database は、3 つの [サービス階層](sql-database-service-tiers.md) と複数のパフォーマンス レベルを提供します。 パフォーマンス レベルごとに提供されるリソースのセット ("能力") が増加し、スループットが段階的に高くなるように設計されています。

各パフォーマンス レベルの能力を上げたときにデータベース パフォーマンスがどのくらい向上するかを数値化できることが重要です。 そのため、マイクロソフトは Azure SQL Database ベンチマーク (ASDB) を開発しました。 このベンチマークでは、すべての OLTP ワークロードに見られるさまざまな基本操作を実行します。 各パフォーマンス レベルで実行しているデータベースで達成されるスループットを測定します。

各サービス階層とパフォーマンス レベルのリソースと能力は、[データベース トランザクション単位 (DTU)](sql-database-what-is-a-dtu.md) で表されます。 DTU は、各パフォーマンス レベルが提供する CPU、メモリ、および読み書きレートを組み合わせた測定に基づいて、パフォーマンス レベルの相対能力を表す方法を提供します。 データベースの DTU 評価の&2; 倍は、データベース能力の&2; 倍と同等です。 このベンチマークを使って、データベースに提供されるリソースに比例してデータベース サイズ、ユーザー数、トランザクション レートを増やしながら、実際のデータベース操作を実行することによって、各パフォーマンス レベルで提供される上昇する能力のデータベース パフォーマンスに対する影響を評価できます。

Basic サービス階層は&1; 時間あたりのトランザクション数、Standard サービス階層は&1; 分あたりのトランザクション数、Premium サービス階層は&1; 秒間のトランザクション数をそれぞれ使用してスループットを表すことにより、各サービス階層の潜在的パフォーマンスをアプリケーションの要件にすばやく関連付けることが容易になります。

## <a name="correlating-benchmark-results-to-real-world-database-performance"></a>実際のデータベース パフォーマンスへのベンチマーク結果の関連付け
他のベンチマークと同様に、ASDB は単なる典型値であり、指標である点を理解しておくことが重要です。 ベンチマーク アプリケーションで達成されるトランザクション率は、他のアプリケーションで達成されるトランザクション率と同じにはなりません。 ベンチマークは、さまざまなテーブルやデータの種類を含むスキーマに対して実行されるさまざまなトランザクションの種類のコレクションで構成されます。 ベンチマークはすべての OLTP ワークロードに共通する同じ基本操作を実行しますが、特定のクラスのデータベースまたはアプリケーションを表すものではありません。 このベンチマークの目的は、パフォーマンス レベルをスケール アップまたはスケール ダウンしたときに予想されるデータベースの相対的なパフォーマンスの適切なガイドを提供することです。 実際には、データベースのサイズと複雑さはさまざまであり、さまざまなワークロードが発生するため、対応方法も変わります。 たとえば、IO の利用が多いアプリケーションでは IO しきい値に達するまでの時間が短くなったり、CPU の使用量が多いアプリケーションでは CPU の上限に達するまでの時間が短くなったりすることがあります。 負荷が増えている状況で、特定のデータベースがベンチマークと同様に拡張する保証はありません。

ベンチマークとその方法について、以下でさらに詳細に説明します。

## <a name="benchmark-summary"></a>ベンチマークの概要
ASDB は、オンライン トランザクション処理 (OLTP) ワークロードで最も頻繁に発生するさまざまな基本的データベース操作のパフォーマンスを測定します。 ベンチマークはクラウド コンピューティングを考慮して設計されていますが、データベース スキーマ、データの設定、およびトランザクションは、OLTP ワークロードでよく使用される基本的な要素を広く表すように設計されています。

## <a name="schema"></a>スキーマ
スキーマは、広範な操作をサポートするのに十分な多様さと複雑さを備えるように設計されています。 ベンチマークは、6 個のテーブルで構成されるデータベースに対して実行されます。 テーブルは、固定サイズ、スケーリング、拡大という&3; つのカテゴリに分類されます。 2 個の固定サイズ テーブル、3 個のスケーリング テーブル、1 個の拡大テーブルがあります。 固定サイズ テーブルには一定の数の行が含まれます。 スケーリング テーブルにはデータベースのパフォーマンスに比例する基数がありますが、ベンチマークの途中で変化することはありません。 拡大テーブルのサイズは初期状態の負荷ではスケーリング テーブルと同じように設定されますが、ベンチマークの実行中に行が挿入および削除されることによって基数が変化します。

スキーマには、整数、数値、文字、日時など、さまざまなデータ型が含まれています。 スキーマにはプライマリ キーとセカンダリ キーが含まれますが、外部キーは含まれません。つまり、テーブルの間に参照整合性制約はありません。

データ生成プログラムによって、初期データベースのデータが生成されます。 さまざまな方法で整数データと数値データが生成されます。 場合によっては、値はある範囲にランダムに分散されます。 それ以外の場合は、値のセットの順序がランダムに変更されて、一定の分散が維持されます。 テキスト フィールドは単語の重み付けされたリストから生成され、現実に近いデータが作成されます。

データベースのサイズは "スケール係数" に基づいて設定されます。 スケール係数 (SF と略記) により、スケーリング テーブルと拡大テーブルの基数が決まります。 「ユーザーとペーシング」で後述するように、データベース サイズ、ユーザー数、最大パフォーマンスはすべて、相互に比例して拡大します。

## <a name="transactions"></a>トランザクション
ワークロードは、次の表で示すように、9 種類のトランザクションで構成されます。 各トランザクションは、データベース エンジンおよびシステム ハードウェアの特定のシステム特性セットが強調され、他のトランザクションとの違いがはっきりわかるように設計されています。 この方法では、異なるコンポーネントのパフォーマンス全体に対する影響を簡単に評価できます。 たとえば、トランザクション "読み取り (高負荷)" では、ディスクからの読み取り操作が大量に生成されます。

| トランザクションの種類 | 説明 |
| --- | --- |
| 読み取り (低負荷) |SELECT、メモリ内、読み取りのみ |
| 読み取り (中負荷) |SELECT、ほぼメモリ内、読み取りのみ |
| 読み取り (高負荷) |SELECT、ほぼメモリ外、読み取りのみ |
| 更新 (低負荷) |UPDATE、メモリ内、読み書き |
| 更新 (高負荷) |UPDATE、ほぼメモリ外、読み書き |
| 挿入 (低負荷) |INSERT、メモリ内、読み書き |
| 挿入 (高負荷) |INSERT、ほぼメモリ外、読み書き |
| 削除 |DELETE、メモリ内とメモリ外の混合、読み書き |
| CPU (高負荷) |SELECT、メモリ内、比較的大きい CPU 負荷、読み取りのみ |

## <a name="workload-mix"></a>ワークロード ミックス
トランザクションは、次の表のような全体的混合比率で重み付けされた分布からランダムに選択されます。 全体として読み取り/書き込みの比率は約 2:1 になります。

| トランザクションの種類 | 混合の割合 |
| --- | --- |
| 読み取り (低負荷) |35 |
| 読み取り (中負荷) |20 |
| 読み取り (高負荷) |5 |
| 更新 (低負荷) |20 |
| 更新 (高負荷) |3 |
| 挿入 (低負荷) |3 |
| 挿入 (高負荷) |2 |
| 削除 |2 |
| CPU (高負荷) |10 |

## <a name="users-and-pacing"></a>ユーザーとペーシング
ベンチマークのワークロードは、一連の接続に対してトランザクションを発行して一定数の同時ユーザーの動作をシミュレートするツールによってもたらされます。 すべての接続とトランザクションはコンピューターによって生成されますが、わかりやすくするため、ここではこれらの接続のことを "ユーザー" と呼びます。 各ユーザーは他のすべてのユーザーとは独立して動作しますが、すべてのユーザーは以下に示すような同じ手順のサイクルを実行します。

1. データベース接続を確立します。
2. 終了を通知されるまで繰り返します。
   * ランダムにトランザクションを選択します (重み付けされた分布から)。
   * 選択されたトランザクションを実行して応答時間を測定します。
   * ペーシング遅延だけ待機します。
3. データベース接続を閉じます。
4. 終了します。

ペーシング遅延 (手順 2c) はランダムに選択されますが、分布の平均は 1.0 秒になります。 したがって、平均すると、各ユーザーが&1; 秒間に生成するトランザクションは多くても&1; つです。

## <a name="scaling-rules"></a>スケーリング ルール
ユーザーの数は、データベースのサイズ (スケール係数単位での) によって決まります。 5 スケール係数単位ごとに&1; 人のユーザーがいます。 ペーシング遅延のため、平均すると、1 人のユーザーが&1; 秒間に生成するトランザクションは多くても&1; つです。

たとえば、スケール係数が 500 (SF=500) のデータベースの場合、ユーザー数は 100 で、最高 100 TPS を実現できます。 TPS 率を高くするには、ユーザー数を増やし、データベースを大きくする必要があります。

次の表では、各サービス階層およびパフォーマンス レベルで実際に保持されるユーザーの数を示します。

| サービス階層 (パフォーマンス レベル) | ユーザー | データベース サイズ |
| --- | --- | --- |
| 基本 |5 |720 MB |
| Standard (S0) |10 |1 GB |
| Standard (S1) |20 |2.1 GB |
| Standard (S2) |50 |7.1 GB |
| Premium (P1) |100 |14 GB |
| Premium (P2) |200 |28 GB |
| Premium (P6/P3) |800 |114 GB |

## <a name="measurement-duration"></a>測定期間
有効なベンチマーク実行のためには、少なくとも&1; 時間は安定状態で測定を行う必要があります。

## <a name="metrics"></a>メトリック
ベンチマークでの重要なメトリックは、スループットと応答時間です。

* スループットはベンチマークにおける基本的なパフォーマンス尺度です。 スループットは、単位時間あたりのすべてのトランザクション タイプのトランザクション数で表されます。
* 応答時間は、パフォーマンスの予測可能性の尺度です。 応答時間の制約はサービスのクラスによって異なり、次に示すように、サービス クラスが高いほど応答時間の要件は厳しくなります。

| サービスのクラス | スループットの測定 | 応答時間の要件 |
| --- | --- | --- |
| プレミアム |1 秒あたりのトランザクション数 |0.5 秒で第 95 百分位数 |
| 標準 |1 分あたりのトランザクション数 |1.0 秒で第 90 百分位数 |
| 基本 |1 時間あたりのトランザクション数 |2.0 秒で第 80 百分位数 |

## <a name="conclusion"></a>まとめ
Azure SQL Database ベンチマークは、利用可能なサービス階層とパフォーマンス レベルの範囲で実行する Azure SQL Database の相対的なパフォーマンスを測定します。 ベンチマークでは、オンライン トランザクション処理 (OLTP) のワークロードで最も頻繁に発生する基本的なデータベース操作を混合したものが実行されます。 ベンチマークでの、実際のパフォーマンスを測定することによる、パフォーマンス レベルを変更したときのスループットに対する影響の評価は、各レベルによって提供される CPU 速度、メモリ サイズ、IOPS などのリソースを単に一覧表記する場合より意味のあるものです。 今後も引き続き、ベンチマークの範囲を広げ、提供されるデータを拡張していく予定です。

## <a name="resources"></a>リソース
[SQL Database の概要](sql-database-technical-overview.md)

[サービス プランとパフォーマンス レベル](sql-database-service-tiers.md)

[Azure SQL Database performance guidance for single databases (データベースが&1; 台の場合の Azure SQL Database のパフォーマンス ガイダンス)](sql-database-performance-guidance.md)

