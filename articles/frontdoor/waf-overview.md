---
title: Azure Front Door 用の Azure Web アプリケーション ファイアウォールとは (プレビュー)
description: Azure Front Door Service 用の Azure Web アプリケーション ファイアウォールによって、Web アプリケーションが悪意のある攻撃からどのように保護されるのかを説明します。
services: frontdoor
documentationcenter: ''
author: KumudD
ms.service: frontdoor
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 04/02/2019
ms.author: kumud;tyao
ms.openlocfilehash: 17cf6629aca6c73bc96e4cf0c172a2e87a7aafb8
ms.sourcegitcommit: c174d408a5522b58160e17a87d2b6ef4482a6694
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/18/2019
ms.locfileid: "59799169"
---
# <a name="what-is-azure-web-application-firewall-for-azure-front-door-preview"></a>Azure Front Door 用の Azure Web アプリケーション ファイアウォールとは (プレビュー)

Azure Web アプリケーション ファイアウォール (WAF) (プレビュー) では、Azure Front Door を使用してグローバルに提供される Web アプリケーションに対する一元的な保護が提供されます。 Web サービスを一般的な悪用や脆弱性から保護し、規制の遵守に役立つだけでなく、ユーザーに対するサービスの高可用性を維持するように、設計および運用されています。

> [!IMPORTANT]
> Azure Front Door 用の Azure Web アプリケーション ファイアウォール (WAF) は、現在パブリック プレビューです。
> このプレビュー バージョンはサービス レベル アグリーメントなしで提供されています。運用環境のワークロードに使用することはお勧めできません。 特定の機能はサポート対象ではなく、機能が制限されることがあります。 詳しくは、[Microsoft Azure プレビューの追加使用条件](https://azure.microsoft.com/support/legal/preview-supplemental-terms/)に関するページをご覧ください。

Web アプリケーションは、サービス拒否攻撃、SQL インジェクション攻撃、クロス サイト スクリプティング攻撃など、ますます悪意のある攻撃の対象になりやすくなっています。 このような悪意のある攻撃により、サービスの停止やデータの損失が発生する可能性があり、Web アプリケーションの所有者にとって重大な脅威となります。

アプリケーション コードでこのような攻撃を防ぐことは困難な場合があり、厳格な保守、パッチの適用、アプリケーション トポロジの複数のレイヤーの監視が必要になることもあります。 Web アプリケーション ファイアウォールを一元化することで、セキュリティの管理がはるかに簡単になり、アプリケーション管理者にとっては侵入の脅威からより確実に保護されるようになります。 さらに、WAF のソリューションでは、個々の Web アプリケーションをセキュリティで保護するのではなく、1 か所に既知の脆弱性の修正プログラムを適用することで、さらに迅速にセキュリティの脅威に対応できます。

Front Door 用の WAF は、グローバルな一元的ソリューションです。 世界中の Azure ネットワーク エッジの場所に展開され、Front Door によって提供される WAF 対応の Web アプリケーションで受信されるすべての要求が、ネットワーク エッジで検査されます。 これにより、WAF は仮想ネットワークに入る前の攻撃ソースの近くで悪意のある攻撃を防ぐことができ、パフォーマンスを損なうことなく大規模でグローバルな保護を提供できます。 WAF のポリシーはサブスクリプション内の任意の Front Door プロファイルに簡単にリンクでき、新しいルールを数分で展開できるので、脅威のパターンの変化にすばやく対応できます。

![Azure Web アプリケーション ファイアウォール](./media/waf-overview/web-application-firewall-overview.png)

Azure WAF は、Application Gateway で有効にすることもできます。 詳しくは、[Web アプリケーション ファイアウォール](../application-gateway/waf-overview.md)に関する記事をご覧ください。

## <a name="waf-policy-and-rules"></a>WAF のポリシーと規則

WAF ポリシーを構成し、保護のためにそのポリシーを 1 つ以上の Front Door フロントエンドと関連付けることができます。 WAF ポリシーは、2 種類のセキュリティ規則で構成されます。
- お客様によって作成されたカスタム規則。
- Azure で管理される事前に構成された一連の規則のコレクションであるマネージド規則セット。 両方ともある場合は、マネージド規則セットの規則が実行される前に、カスタム規則が実行されます。 規則は、一致条件、優先順位、およびアクションで構成されます。 サポートされているアクションの種類は次のとおりです: 許可、ブロック、ログ、リダイレクト。 マネージド規則とカスタム規則を組み合わせることで、特定のアプリケーション保護要件を満たす完全にカスタマイズされたポリシーを作成することができます。

ポリシー内の規則は、優先順位の順序で実行されます。優先順位は、規則の実行順序を定義する一意の整数です。 整数値が小さいほど高い優先順位を表し、大きい整数値の規則より前に評価されます。 規則が一致すると、規則で定義されている対応するアクションが要求に対して適用されます。 このような一致が処理された後、優先順位の低い規則はそれ以上処理されません。

Front Door によって提供される Web アプリケーションには、一度に 1 つの WAF ポリシーだけを関連付けることができます。 ただし、Front Door の構成に WAF ポリシーを関連付けなくてもかまいません。 WAF ポリシーが存在する場合は、世界中のセキュリティ ポリシーで一貫性が保たれるよう、すべてのエッジの場所にポリシーがレプリケートされます。

## <a name="waf-modes"></a>WAF のモード

WAF ポリシーは、次の 2 つのモードで実行するように構成できます。

- **検出モード:** 検出モードで実行されている WAF では、監視以外の他のアクションは実施されず、要求とそれに一致した WAF ルールが WAF ログに記録されます。 Front Door に対して診断ログを有効にできます (Azure portal では、**[診断]** セクションで実現できます)。

- **防止モード:** 防止モードで実行するように構成された WAF では、要求が規則と一致すると指定されているアクションが実行され、一致が見つかった場合、それより優先順位が低い規則は評価されません。 一致した要求は、WAF ログにも記録されます。

## <a name="waf-actions"></a>WAF のアクション

WAF のお客様は、要求が規則の条件と一致したときに実行するアクションを 1 つ選択できます。
- "**許可:**"要求は WAF を通過し、バックエンドに転送されます。 それより優先順位の低い規則によって、この要求をブロックすることはできません。
- **ブロック:** 要求はブロックされ、WAF はバックエンドに要求を転送せず、クライアントに応答を送信します。
- **ログ:** 要求は WAF ログに記録され、WAF は優先順位の低い規則の評価を続行します。
- **リダイレクト:** WAF は、指定された URI に要求をリダイレクトします。 指定される URI は、ポリシー レベルの設定です。 いったん構成すると、**リダイレクト** アクションと一致するすべての要求が、その URI に送信されます。


## <a name="waf-rules"></a>WAF の規則

WAF ポリシーは、2 種類のセキュリティ規則で構成できます。お客様が作成するカスタム規則と、Azure によって管理される事前構成済みの規則のセットであるマネージド規則セットです。

### <a name="custom-authored-rules"></a>カスタム作成規則
お客様は、次のようにしてカスタム規則 WAF を構成できます。

- **IP 許可リストと禁止リスト:** クライアント IP アドレスのリストまたは IP アドレス範囲に基づいて Web アプリケーションへのアクセスを制御するカスタム規則を構成できます。 IPV4 と IPV6 の両方のアドレス タイプがサポートされています。 このリストを構成し、ソース IP アドレスがリストの IP アドレスと一致した要求を、許可またはブロックできます。

- **地理ベースのアクセス制御:** クライアントの IP アドレスに関連付けられている国番号に基づいて Web アプリケーションへのアクセスを制御するカスタム規則を構成できます。

- **HTTP パラメーター ベースのアクセス制御:** クエリ文字列、POST 引数、要求 URI、要求ヘッダー、要求本文など、HTTP/HTTPS 要求パラメーターに一致する文字列に基づくカスタム規則を構成することができます。

- **要求メソッド ベースのアクセス制御:** 要求の HTTP 要求メソッド (GET、PUT、HEAD など) に基づくカスタム規則を構成することができます。

- **サイズ制約:** クエリ文字列、URI、要求本文など、要求の特定の部分の長さに基づくカスタム規則を構成できます。

- **レート制限規則:** レート制御ルールでは、クライアント IP からの異常に多いトラフィックが制限されます。 1 分間に許可されるクライアント IP アドレスからの Web 要求の数に、しきい値を構成することができます。 これは、クライアントの IP アドレスからのすべての要求を許可またはブロックする点が、IP リストに基づく許可/禁止のカスタム規則と異なります。 レート制限を、HTTP(S) パラメーター一致などの他の一致条件と組み合わせて、さらにきめ細かく制御できます。


### <a name="azure-managed-rule-sets"></a>Azure で管理される規則セット

Azure で管理される規則セットでは、一般的なセキュリティ脅威のセットに対する保護をデプロイする簡単な方法が提供されます。 そのような規則セットが Azure によって管理されるので、新しい攻撃シグネチャから保護するために、必要に応じて規則が更新されます。 パブリック プレビューの Azure で管理される既定の規則セットには、次の脅威カテゴリに対する規則が含まれます。

- クロスサイト スクリプティング
- Java 攻撃
- ローカル ファイル インクルージョン
- PHP インジェクション攻撃
- リモート コマンド実行
- リモート ファイル インクルージョン
- セッション固定
- SQL インジェクションからの保護

既定の規則セットのバージョン番号は、新しい攻撃シグネチャが規則セットに追加されると増分されます。
WAF ポリシーの検出モードでは、既定の規則セットが既定で有効になります。 ご自分のアプリケーション要件に合わせて、既定の規則セット内の規則を個別に有効または無効にすることができます。 また、規則ごとに特定のアクション (許可/ブロック/リダイレクト/ログ) を設定することもできます。 既定のアクションはブロックです。 さらに、既定の規則セット内の事前構成済みの規則のいずれかをバイパスしたい場合は、同じ WAF ポリシーでカスタム規則を構成できます。
カスタム規則は常に、既定の規則セット内の規則が評価される前に適用されます。 要求がカスタム規則と一致した場合、対応する規則アクションが適用されて、要求はブロックされるか、またはバックエンドにパススルーされ、それ以上カスタム規則または既定の規則セット内の規則が呼び出されることはありません。 さらに、WAF ポリシーから既定の規則セットを削除することもできます。


## <a name="configuration"></a>構成
パブリック プレビューの間:
- すべての WAF 規則の種類の構成と展開は、REST API、Azure Resource Manager テンプレート、および Azure PowerShell を使用して、完全にサポートされます。
- Azure portal では、Azure で管理される既定の規則セットだけを構成または表示できます。

## <a name="monitoring"></a>監視

Front Door での WAF の監視は、Azure Monitor と統合されており、アラートを追跡し、トラフィックの傾向を簡単に監視できます。

## <a name="pricing"></a>価格

パブリック プレビュー中、Front Door 用の WAF に関連するすべての使用は無料で、課金は行われません。

## <a name="next-steps"></a>次の手順

- [フロント ドアの作成](quickstart-create-front-door.md)方法について学習します。

