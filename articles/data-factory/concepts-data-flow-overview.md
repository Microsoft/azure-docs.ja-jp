---
title: Azure Data Factory の Mapping Data Flow | Microsoft Docs
description: Azure Data Factory の Mapping Data Flow の概要
author: kromerm
ms.author: makromer
ms.reviewer: daperlov
ms.service: data-factory
ms.topic: conceptual
ms.date: 10/7/2019
ms.openlocfilehash: 8d0ad794caee8a06c8d403a981037d6560fb3f43
ms.sourcegitcommit: 11265f4ff9f8e727a0cbf2af20a8057f5923ccda
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/08/2019
ms.locfileid: "72030179"
---
# <a name="what-are-mapping-data-flows"></a>マッピング データ フローについて

Mapping Data Flows は、Azure Data Factory の視覚的に設計されたデータ変換です。 データ フローを使用すると、データ エンジニアは、コードを記述することなくグラフィカルなデータ変換ロジックを開発できます。 生成されたデータ フローは、スケールアウトされた Spark クラスターを使用して、Azure Data Factory パイプライン内でアクティビティとして実行されます。 データ フロー アクティビティは、既存の Data Factory スケジュール、制御、フロー、および監視機能を介して運用可能にすることができます。

Mapping Data Flows は、コーディングを必要としない、完全に視覚的なエクスペリエンスを提供します。 データ フローを実行クラスター上で実行することにより、データ処理がスケールアウトされます。 Azure Data Factory では、コード翻訳、パス最適化、およびデータ フローのジョブ実行のすべてが処理されます。

## <a name="getting-started"></a>使用の開始

データ フローを作成するには、[Factory Resources]\(Factory リソース\) の下にあるプラス記号をクリックします。 

![新しいデータ フロー](media/data-flow/newdataflow2.png "新しいデータ フロー")

これにより、変換ロジックを作成できるデータ フロー キャンバスに移動します。 [ソースの追加] ボックスをクリックすると、ソース変換の構成が開始します。 詳細は、[ソース変換](data-flow-source.md)に関するページを参照してください。

## <a name="data-flow-canvas"></a>データ フロー キャンバス

データ フロー キャンバスは、上部バー、グラフ、および構成パネルの 3 つの部分に分かれています。 

![Canvas](media/data-flow/canvas1.png "Canvas")

### <a name="graph"></a>Graph

グラフには変換ストリームが表示されます。 ここにはソース データが 1 つ以上のシンクに流れるときのソース データの系列が表示されます。 新しいソースを追加するには、[ソースの追加] ボックスをクリックします。 新しい変換を追加するには、既存の変換の右下にあるプラス記号をクリックします。

![Canvas](media/data-flow/canvas2.png "Canvas")

### <a name="configuration-panel"></a>構成パネル

構成パネルには、現在選択されている変換に固有の設定が表示され、変換が選択されていない場合はデータ フローが表示されます。 データ フロー全般の構成では、 **[General]\(全般\)** タブで名前および説明を編集したり、 **[Parameters]\(パラメーター\)** タブを使用してパラメーターを追加したりできます。詳しくは、「[Mapping Data Flow のパラメーター](parameters-data-flow.md)」を参照してください。

各変換には、少なくとも 4 つの構成タブがあります。

#### <a name="transformation-settings"></a>変換設定

各変換の構成ウィンドウの最初のタブには、その変換に固有の設定が含まれています。 詳しくは、各変換のドキュメント ページをご覧ください。

![[ソースの設定] タブ](media/data-flow/source1.png "[ソースの設定] タブ")

#### <a name="optimize"></a>最適化

_[最適化]_ タブには、パーティション分割を構成するためのオプション設定が含まれています。

![最適化](media/data-flow/optimize1.png "最適化")

既定の設定は、[Use current partitioning]\(現在のパーティション分割を使用\) で、この場合、Azure Data Factory では Spark 上で実行されているデータ フローにネイティブのパーティション構成が使用されます。 ほとんどのシナリオでは、この設定が推奨される方法です。

パーティション分割を調整したい場合もあります。 たとえば、変換をレイク内の 1 つのファイルに出力する場合は、シンク変換で [単一パーティション] を選択します。

パーティション構成の制御が必要になるもう 1 つのケースは、パフォーマンスを最適化する場合です。 パーティション分割を調整すると、全体的なデータ フローのパフォーマンスに好影響を与えることも、悪影響も与えることもある、各計算ノードへのデータの分散とデータの局所性の最適化を制御できます。 詳細については、[データ フローのパフォーマンス ガイド](concepts-data-flow-performance.md)に関するページを参照してください。

いずれかの変換でパーティション分割を変更する場合は、[最適化] タブをクリックし、[Set Partitioning]\(パーティションの設定\) ラジオ ボタンを選択します。 パーティション分割用の一連のオプションが表示されます。 パーティション分割の最適な方法は、データ ボリューム、候補キー、null 値、およびカーディナリティに応じて異なります。 ベスト プラクティスは、既定のパーティション分割から開始して、その後、別のパーティション分割のオプションを試す方法です。 パイプラインのデバッグ実行を使用してテストし、各変換グループの実行時間およびパーティションの使用状況を [Monitoring]\(監視\) ビューから確認することができます。 詳しくは、[データ フローの監視](concepts-data-flow-monitoring.md)に関するページを参照してください。

利用可能なパーティション分割オプションを以下に示します。

##### <a name="round-robin"></a>ラウンド ロビン 

ラウンド ロビンは、自動的に各パーティションにデータを均等に分散するシンプルなパーティションです。 堅固でスマートなパーティション分割戦略を実装するための適切な候補がないときは、ラウンド ロビンを使用します。 物理パーティションの数を設定できます。

##### <a name="hash"></a>Hash

Azure Data Factory は、同様の値を持つ行が同じパーティション内に分類されるように、列のハッシュを生成して統一されたパーティションを生成します。 [ハッシュ] オプションを使用するときは、可能なパーティションの傾斜についてテストします。 物理パーティションの数を設定できます。

##### <a name="dynamic-range"></a>動的範囲

動的範囲では、指定した列または式に基づく Spark の動的範囲が使用されます。 物理パーティションの数を設定できます。 

##### <a name="fixed-range"></a>固定範囲

パーティション分割されたデータ列内の値に対する固定の範囲を提供する式を作成します。 パーティションの傾斜を避けるため、このオプションを使用する際は、データについて十分に理解する必要があります。 式に入力する値は、パーティション関数の一部として使用されます。 物理パーティションの数を設定できます。

##### <a name="key"></a>Key

データのカーディナリティを十分に理解している場合は、キー パーティション分割が適切なパーティション戦略になるでしょう。 キー パーティション分割では、列内の一意の値ごとにパーティションが作成されます。 パーティションの数は、データ内の一意の値に基づくため、設定することはできません。

#### <a name="inspect"></a>検査

_[Inspect]\(検査\)_ タブには、変換するデータ ストリームのメタデータのビューが表示されます。 列数、変更された列、追加された列、データ型、列の順序、および列の参照を確認できます。 [Inspect]\(検査\) は、メタデータの読み取り専用ビューです。 [Inspect]\(検査\) ウィンドウでメタデータを表示するためにデバッグ モードを有効にする必要はありません。

![検査](media/data-flow/inspect1.png "検査")

変換を使ってデータの形状を変更すると、メタデータの変更が [Inspect]\(検査\) ウィンドウに反映されます。 ソースの変換に定義済みのスキーマがない場合、メタデータは [Inspect]\(検査\) ウィンドウに表示されません。 スキーマの誤差シナリオでは、メタデータがないことは一般的です。

#### <a name="data-preview"></a>データのプレビュー

デバッグ モードがオンの場合、 _[データのプレビュー]_ タブには、各変換のデータの対話型スナップショットが表示されます。 詳細については、[デバッグ モードでのデータのプレビュー](concepts-data-flow-debug-mode.md#data-preview)に関するページを参照してください。

### <a name="top-bar"></a>上部バー

上部バーには、保存や検証などのデータ フロー全体に影響を与えるアクションが含まれています。 **[グラフの表示]** および **[グラフの非表示]** ボタンを使用して、グラフと構成モードの間で切り替えを行うこともできます。

![グラフの非表示](media/data-flow/hideg.png "グラフの非表示")

グラフを非表示にした場合は、 **[前へ]** ボタンと **[次へ]** ボタンを使用して、変換ノード間を横方向に移動することができます。

![移動](media/data-flow/showhide.png "移動")

## <a name="next-steps"></a>次の手順

* [ソース変換](data-flow-source.md)を作成する方法について説明します
* データ フローを[デバッグ モード](concepts-data-flow-debug-mode.md)で構築する方法について説明します。
