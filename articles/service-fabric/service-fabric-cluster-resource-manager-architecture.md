---
title: "リソース マネージャー アーキテクチャ | Microsoft Docs"
description: "Service Fabric クラスター リソース マネージャーのアーキテクチャの概要。"
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 6c4421f9-834b-450c-939f-1cb4ff456b9b
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 01/05/2017
ms.author: masnider
translationtype: Human Translation
ms.sourcegitcommit: dafaf29b6827a6f1c043af3d6bfe62d480d31ad5
ms.openlocfilehash: 67f07bad8f6f89d9e5e68326f0cc194d920e841b
ms.lasthandoff: 01/07/2017


---
# <a name="cluster-resource-manager-architecture-overview"></a>クラスター リソース マネージャーのアーキテクチャの概要
Service Fabric クラスター リソース マネージャーには、クラスター内のリソースを管理するための情報がいくつか必要です。 現在存在しているサービスと、これらのサービスが現在 (または既定で) 消費しているリソースの量を把握している必要があります。 クラスター内で使用可能なリソースを追跡するには、クラスター内のノードの容量と、各ノードで消費されるリソースの量を把握する必要があります。 サービスのリソース消費量は時間の経過と共に変わりますし、サービスでは通常、複数のリソースが使用されます。 サービスによっては、実際の物理リソースと物理リソースの両方が計測されることもあります。 メモリやディスクの消費量など、物理的な指標が追跡されることもありますし、 さらに一般的な傾向として、論理的な指標 ("WorkQueueDepth" や "TotalRequests" など) が使用されることもあります。 論理および物理メトリックはいずれも、さまざまな種類の数多くのサービスで使用できる場合もあれば、少数のサービスでしか使用できない場合もあります。

## <a name="other-considerations"></a>その他の考慮事項
クラスターの所有者や運営者がサービスの作成者と異なる人物であることはよくあることです。また少なくとも、担当が違えば仕事内容も異なります。 たとえば、サービスの開発担当者は、リソースの観点から何が必要かを考えたり、各種コンポーネントをどのようにデプロイするのが理想的かを検討します。 しかし、そのサービスが本稼働になった後、ライブサイトでのインシデントに対応する担当者は、行う業務が違いますし、必要なツールも異なります。 また、以下に示すように、クラスターとサービスの構成はどちらも静的ではありません。

* クラスター内のノード数は増減する可能性があります
* サイズやタイプの異なるノードが追加されたり削除される可能性があります
* サービスの作成や削除が行われたり、望ましいリソース割り当てが変わる可能性があります
* クラスター内でアップグレードやその他の管理操作が展開され、エラーが発生する可能性があります。

## <a name="cluster-resource-manager-components-and-data-flow"></a>クラスター リソース マネージャーのコンポーネントとデータ フロー
クラスター リソース マネージャーでは、各サービスの要件と、それらのサービスを構成する各サービス オブジェクトのリソース消費量を追跡する必要があります。 これを達成するために、クラスター リソース マネージャーでは&2; つの概念的な構成要素が使用されます。各ノードで実行されるエージェントと、フォールト トレラント サービスです。 各ノード上のエージェントは、サービスから負荷レポートを読み込み、それらを集計して、定期的にレポートします。 クラスター リソース マネージャー サービスは、ローカル エージェントからの情報をすべて集計し、その最新の構成に基づいて状況に対応します。

次の図を見てみましょう。

<center>
![リソース バランサーのアーキテクチャ][Image1]
</center>

実行時には、さまざまな変更が生じる可能性があります。 たとえば、一部のサービスでリソース消費量が変わったり、一部のサービスでエラーが発生したり、クラスターでノードの追加や削除が発生することがあります。 ノード上の変更はすべて集計され、クラスター リソース マネージャー サービスに定期的に送信 (1、2) されます。そこで再度集計され、分析されて格納されます。 このサービスは数秒ごとに変更を確認し、何らかのアクションが必要かどうかを判断します (3)。 たとえば、クラスターに空のノードが追加されたことが検出された場合には、それらのノードに一部のサービスを移動するかどうかを決定したりします。 また、クラスター リソース マネージャーでは、特定のノードに過剰な負荷がかかっていたり、特定のサービスで障害が発生した (またはサービスが削除された) 場合に、別の場所のリソースを開放したりもします。

次の図を見て、次に何が起こるのかを考えてみましょう。 たとえば、変更が必要であるとクラスター リソース マネージャーが判断するとします。 その他のシステム サービス (具体的には Failover Manager) と調整を行い、必要な変更を行います。 その後、必要なコマンドが適切なノードに送信されます (4)。 この場合、リソース マネージャーがノード 5 に過剰な負荷がかかっていることに気付き、サービス B を N5 から N4 に移動することに決定したとします。 再構成後 (5)、クラスターは次のようになります。

<center>
![リソース バランサーのアーキテクチャ][Image2]
</center>

## <a name="next-steps"></a>次のステップ
* クラスター リソース マネージャーには、クラスターを記述するためのさまざまなオプションがあります。 オプションについて詳しくは、[Service Fabric クラスターの記述](service-fabric-cluster-resource-manager-cluster-description.md)に関する記事をご覧ください

[Image1]:./media/service-fabric-cluster-resource-manager-architecture/Service-Fabric-Resource-Manager-Architecture-Activity-1.png
[Image2]:./media/service-fabric-cluster-resource-manager-architecture/Service-Fabric-Resource-Manager-Architecture-Activity-2.png

