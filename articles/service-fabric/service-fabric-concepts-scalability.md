---
title: "Service Fabric サービスの拡張性 | Microsoft Docs"
description: "Service Fabric サービスの拡張方法を説明する"
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: ed324f23-242f-47b7-af1a-e55c839e7d5d
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 12/30/2016
ms.author: masnider
translationtype: Human Translation
ms.sourcegitcommit: dafaf29b6827a6f1c043af3d6bfe62d480d31ad5
ms.openlocfilehash: 52dcf341a34478bf4e800d8f1b9d44867b5feaf6


---
# <a name="scaling-service-fabric-applications"></a>Service Fabric アプリケーションのスケーリング
Azure Service Fabric では、クラスター内のすべてのノードでサービス、パーティション、およびレプリカを管理することにより、スケーラブルなアプリケーションを簡単に構築できます。 これにより、リソースを最大限活用できます。

Service Fabric アプリケーションの高い拡張性は、次の&2; つの方法で実現できます。

1. サービス パーティション レベルでのスケーリング
2. 指定したサービス インスタンス レベルでのスケーリング

## <a name="scaling-at-the-partition-level"></a>パーティション レベルでのスケーリング
Service Fabric はパーティション分割をサポートしています。 パーティション分割を使用すると、1 つ のサービスを複数の独立したパーティションに分割し、サービス全体の状態の一部を各パーティションに割り当てることができます。 「 [パーティション分割の概要](service-fabric-concepts-partitioning.md) 」では、サポートされているパーティション構成の種類に関する情報を提供します。 各パーティションのレプリカが、クラスター内のノードに分散します。 ここでは、範囲指定されたパーティション分割構成をあるサービスに使用し、低値キーを 0、高値キーを 99、パーティション数を 4 とした場合について考えてみましょう。 3 ノード クラスターでは、サービスを次に示すように、各ノード上のリソースを共有する&4; つのレプリカでレイアウトする可能性があります。

<center>
![3 つのノードでのパーティション レイアウト](./media/service-fabric-concepts-scalability/layout-three-nodes.png)
</center>

ノード数を増やすと、Service Fabric はレプリカの一部を空のノードに移動して、新しいノード上のリソースを利用できるようにします。 ノード数を&4; つに増やしたことで、このサービスでは (それぞれ別のパーティションに属する) 各ノードで&3; つのレプリカが実行されるようになり、リソースの使用率とパフォーマンスが改善されたました。

<center>
![4 つのノードでのパーティション レイアウト](./media/service-fabric-concepts-scalability/layout-four-nodes.png)
</center>

## <a name="scaling-at-the-service-name-level"></a>サービス名レベルでのスケーリング
サービス インスタンスとは、アプリケーション名とサービスの種類名の特定のインスタンスです (「 [Service Fabric アプリケーション ライフサイクル](service-fabric-application-lifecycle.md)」を参照)。 サービスの作成時に使用するパーティション構成を指定します (「 [Service Fabric サービスのパーティション分割](service-fabric-concepts-partitioning.md)」を参照)。

スケーリングの最初のレベルは、サービス名です。 古いサービス インスタンスの負荷が高くなってきたら、さまざまなレベルのパーティション分割を必要に応じて使用し、サービスのインスタンスを作成できます。 これにより、新しいサービス コンシューマーは、ビジー状態のサービス インスタンスよりも、ビジー状態でないものを使用することができます。

処理容量を増やすための&1; つの方法として、新しいパーティション構成を使用した新規のサービス インスタンスを作成するという方法があります。 ただし、これを行うと管理の複雑さが増します。 別名で作成したそのサービスをいつどのように使用するのかを、使用元のすべてのクライアントに把握させる必要があるからです。 代替策として、各要求を処理するサービスとパーティションを、管理サービスや中継サービスに決定させるという方法もあります。

### <a name="example-scenario-embedded-dates"></a>シナリオの例: 埋め込みの日付
可能性のあるシナリオの&1; つとして、サービス名の一部としての日付の情報を使用する場合があります。 たとえば、2013 年に参加したすべての顧客に対して特定の名前のサービス インスタンスを使用し、2014 年に参加した顧客に対して別の名前のサービス インスタンスを使用できます。 この名前付けスキームでは、日付に応じてプログラムによって名前を増やすことができます (2014 年の方法では、2014 年のサービス インスタンスを要求に応じて作成できます)。

ただし、この方法は、Service Fabric の知識の範囲外にあるアプリケーション固有の名前付け情報を使用するクライアントに基づきます。

* *名前付けの規則を使用する*: 2013 年のアプリケーション運用時に、fabric:/app/service2013 という 1 つのサービスを作成します。 2013 年の第 2 四半期に近づくと、fabric:/app/service2014 という別のサービスを作成します。 これらの両方のサービスは、同じサービス型です。 この方法では、クライアントは、年に基づいて適切なサービス名を構築するロジックを使用する必要があります。
* *検索サービスを使用する*: 別のパターンでは、必要なキーに対してサービス名を提供できるようにするセカンダリ参照サービスを提供します。 新しいサービス インスタンスは、参照サービスによって作成できます。 参照サービス自体では、アプリケーション データは保持せず、作成するサービス名についてのデータのみ保持します。 そのため、上記の年ベースの例では、クライアントは最初に参照サービスに問い合わせて、特定の年のデータを処理するサービスの名前を確認します。 次に、クライアントはそのサービス名を使用して、実際の操作を実行します。 最初の参照の結果は、キャッシュすることができます。

## <a name="putting-it-all-together"></a>まとめ
それでは、ここまでに説明した内容を、別のシナリオを使ってまとめてみてみましょう。

次の例について考えてみてください: あなたは、名前情報や連絡先情報を保持できる、アドレス帳のサービスを構築しようとしているとします。 ユーザー数がどれくらいになるかや、 各ユーザーの連絡先がどれくらいになるのかなど、 サービスの立ち上げにあたって必要な情報をすべて確認することは、非常に大変です。 パーティション数を間違ったりすると、後でスケーリングの問題が生じる可能性があります。 だからと言って、すべてのユーザーに&1; つのパーティション構成を当てはめるのは合理的ではありません。

このような場合には、次のパターンを検討しましょう:
1. すべてのユーザーにあらかじめパーティション構成を選択するのではなく、"マネージャー サービス" を構築するのです。
2. このマネージャー サービスの役割は、サービスへのサインアップ時に顧客情報を確認することです。 その後、その情報を基に、_その顧客専用_のサービスとして、_実際の_連絡先保存サービスのインスタンスを作成します。 この種の動的なサービス作成パターンには、さまざまな利点があります。

    * すべてのユーザーについて、適切なパーティション数を事前に推測する必要がありません
    * それぞれの顧客に専用のサービス コピーが作成されるので、データのセグメント化が効率化されます
    * 顧客サービスごとに異なる構成を適用できるので、予想されるスケールに基づいて、パーティションやレプリカの数を調整できます。
      * たとえば、"Gold" レベルの料金を支払った顧客について、レプリカ数やパーティション数を増やすこともできます
      * また、提供された情報で、必要な連絡先の数が "Small" と指定されていた場合には、パーティション数を少なくすることもできます。
    * 顧客がサインアップする前に、多数のサービス インスタンスやレプリカを実行する必要がありません
    * 顧客がサービスの利用をやめる際は、作成したサービスをマネージャーで削除するだけなので、サービスの情報削除も簡単です。

## <a name="next-steps"></a>次のステップ
Service Fabric の概念について詳しくは、次の記事をご覧ください。

* [Service Fabric サービスの可用性](service-fabric-availability-services.md)
* [Service Fabric サービスのパーティション分割](service-fabric-concepts-partitioning.md)
* [状態の定義と管理](service-fabric-concepts-state.md)



<!--HONumber=Jan17_HO1-->


