---
title: チュートリアル - ユーザー フローを作成する - Azure Active Directory B2C
description: Azure Active Directory B2C 内のアプリケーションに対するサインアップ、サインイン、およびユーザー プロファイルの編集を実行できるようにするユーザー フローの Azure portal での作成方法について説明します。
services: active-directory-b2c
author: mmacy
manager: celestedg
ms.service: active-directory
ms.workload: identity
ms.topic: article
ms.date: 06/07/2019
ms.author: marsma
ms.subservice: B2C
ms.openlocfilehash: 111196388d0e17ecde8a2055959f2f573e43ade8
ms.sourcegitcommit: 41ca82b5f95d2e07b0c7f9025b912daf0ab21909
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/13/2019
ms.locfileid: "67056358"
---
# <a name="tutorial-create-user-flows-in-azure-active-directory-b2c"></a>チュートリアル:Azure Active Directory B2C 内にユーザー フローを作成する

お使いのアプリケーションに、ユーザーによるサインアップ、サインイン、プロファイル管理を可能にする[ユーザー フロー](active-directory-b2c-reference-policies.md)を設定できます。 Azure Active Directory (Azure AD) B2C テナント内にさまざまな種類のユーザー フローを複数作成し、それらを必要に応じてアプリケーションで使用できます。 ユーザー フローは、アプリケーション間で再利用することができます。

この記事では、次のことについて説明します。

> [!div class="checklist"]
> * サインアップとサインイン ユーザー フローを作成する
> * プロファイル編集ユーザー フローを作成する
> * パスワードのリセット ユーザー フローを作成する

このチュートリアルでは、Azure portal を使用して、いくつかの推奨されるユーザー フローを作成する方法について説明します。 アプリケーションにリソース所有者のパスワード資格情報 (ROPC) フローを設定する方法に関する情報をお探しの場合は、「[Azure AD B2C でリソース所有者のパスワード資格情報フローを構成する](configure-ropc.md)」を参照してください。

Azure サブスクリプションをお持ちでない場合は、開始する前に [無料アカウント](https://azure.microsoft.com/free/?WT.mc_id=A261C142F) を作成してください。

## <a name="prerequisites"></a>前提条件

作成するユーザー フローの一部となる[アプリケーションを登録](tutorial-register-applications.md)します。

## <a name="create-a-sign-up-and-sign-in-user-flow"></a>サインアップとサインイン ユーザー フローを作成する

サインアップとサインイン ユーザー フローは、サインアップ エクスペリエンスとサインイン エクスペリエンスの両方を 1 つの構成で処理します。 アプリケーションのユーザーは、状況に応じて正しいパスに誘導されます。

1. [Azure Portal](https://portal.azure.com) にサインインします。
1. お使いの Azure AD B2C テナントを含むディレクトリを使用していることを確認してください。確認のために、トップ メニューにある **[ディレクトリとサブスクリプション フィルター]** をクリックして、お使いのテナントを含むディレクトリを選択します。

    ![サブスクリプション ディレクトリに切り替える](./media/tutorial-create-user-flows/switch-directories.PNG)

1. Azure portal の左上隅にある **[すべてのサービス]** を選択してから、 **[Azure AD B2C]** を検索して選択します。
1. 左側のメニューで、 **[ポリシー]** の下の **[ユーザー フロー (ポリシー)]** を選択し、 **[新しいユーザー フロー]** を選択します。

    ![新しいユーザー フローを選択する](./media/tutorial-create-user-flows/signup-signin-user-flow.png)

1. **[推奨]** タブで **[サインアップとサインイン]** ユーザー フローを選択します。

    ![サインアップとサインイン ユーザー フローを選択する](./media/tutorial-create-user-flows/signup-signin-type.png)

1. ユーザー フローの **[名前]** を入力します。 たとえば、「*signupsignin1*」と入力します。
1. **[ID プロバイダー]** の **[電子メールのサインアップ]** を選択します。

    ![フローのプロパティを設定する](./media/tutorial-create-user-flows/signup-signin-properties.png)

1. **[ユーザー属性と要求]** で、サインアップ中にユーザーから収集して送信する要求と属性を選択します。 たとえば、 **[Show more]\(さらに表示\)** を選択し、 **[国/リージョン]** 、 **[表示名]** 、 **[郵便番号]** の属性と要求を選択します。 Click **OK**.

    ![属性と要求を選択する](./media/tutorial-create-user-flows/signup-signin-attributes.png)

1. **[作成]** をクリックして、ユーザー フローを追加します。 *B2C_1* というプレフィックスが自動的に名前に追加されます。

### <a name="test-the-user-flow"></a>ユーザー フローをテストする

1. 作成したユーザー フローを選択してその概要ページを開き、 **[ユーザー フローの実行]** を選択します。
1. **[アプリケーション]** で、以前に登録した *webapp1* という名前の Web アプリケーションを選択します。 **[応答 URL]** に `https://jwt.ms` と表示されます。
1. **[ユーザー フローを実行します]** をクリックしてから、 **[今すぐサインアップ]** を選択します。

    ![ユーザー フローを実行する](./media/tutorial-create-user-flows/signup-signin-run-now.PNG)

1. 有効なメール アドレスを入力し、 **[確認コードの送信]** をクリックします。受信した確認コードを入力し、 **[コードの確認]** を選択します。
1. 新しいパスワードを入力し、そのパスワードを確認します。
1. 国とリージョンを選択し、表示する名前を入力し、郵便番号を入力したら、 **[作成]** をクリックします。 トークンが `https://jwt.ms` に返され、表示されます。
1. これでユーザー フローをもう一度実行できるようになりました。作成したアカウントでサインインできる必要があります。 返されたトークンには、選択した国/リージョン、名前、および郵便番号の要求が含まれています。

## <a name="create-a-profile-editing-user-flow"></a>プロファイル編集ユーザー フローを作成する

アプリケーションでユーザーによるプロファイル編集を有効にする場合は、プロファイル編集ユーザー フローを使用します。

1. Azure AD B2C テナントの概要ページの左側にあるメニューで、 **[ユーザー フロー (ポリシー)]** を選択し、 **[新しいユーザー フロー]** を選択します。
1. [Recommended]\(推奨\) タブで **[プロファイル編集]** ユーザー フローを選択します。
1. ユーザー フローの **[名前]** を入力します。 たとえば、「*profileediting1*」と入力します。
1. **[ID プロバイダー]** で、 **[ローカル アカウント サインイン]** を選択します。
1. **[ユーザー属性]** で、ユーザーが自分のプロファイルで編集できる属性を選択します。 たとえば、 **[Show more]\(さらに表示\)** を選択し、 **[表示名]** と **[役職]** の属性と要求を選択します。 Click **OK**.
1. **[作成]** をクリックして、ユーザー フローを追加します。 *B2C_1* というプレフィックスが自動的に名前に追加されます。

### <a name="test-the-user-flow"></a>ユーザー フローをテストする

1. 作成したユーザー フローを選択してその概要ページを開き、 **[ユーザー フローの実行]** を選択します。
1. **[アプリケーション]** で、以前に登録した *webapp1* という名前の Web アプリケーションを選択します。 **[応答 URL]** に `https://jwt.ms` と表示されます。
1. **[ユーザー フローを実行します]** をクリックし、以前に作成したアカウントでサインインします。
1. これで、ユーザーの表示名と役職を変更できるようになりました。 **[続行]** をクリックします。 トークンが `https://jwt.ms` に返され、表示されます。

## <a name="create-a-password-reset-user-flow"></a>パスワードのリセット ユーザー フローを作成する

アプリケーションのユーザーが自分のパスワードをリセットできるようにするには、パスワード リセット ユーザー フローを使用します。

1. 左側のメニューで **[ユーザー フロー (ポリシー)]** を選択し、 **[新しいユーザー フロー]** を選択します。
1. [Recommended]\(推奨\) タブで **[パスワードのリセット]** ユーザー フローを選択します。
1. ユーザー フローの **[名前]** を入力します。 たとえば、「*passwordreset1*」と入力します。
1. **[ID プロバイダー]** で、 **[Reset password using email address]\(メール アドレスを使用してパスワードをリセットする\)** を有効にします。
1. [アプリケーション要求] で **[Show more]\(さらに表示\)** をクリックし、アプリケーションに戻される承認トークンで返される要求を選択します。 たとえば、 **[User's Object ID] (ユーザーのオブジェクト ID)** を選択します。
1. Click **OK**.
1. **[作成]** をクリックして、ユーザー フローを追加します。 *B2C_1* というプレフィックスが自動的に名前に追加されます。

### <a name="test-the-user-flow"></a>ユーザー フローをテストする

1. 作成したユーザー フローを選択してその概要ページを開き、 **[ユーザー フローの実行]** を選択します。
1. **[アプリケーション]** で、以前に登録した *webapp1* という名前の Web アプリケーションを選択します。 **[応答 URL]** に `https://jwt.ms` と表示されます。
1. **[ユーザー フローの実行]** をクリックし、前に作成したアカウントの電子メール アドレスを確認し、 **[続行]** を選択します。
1. これで、ユーザーのパスワードを変更できるようになりました。 パスワードを変更し、 **[続行]** を選択します。 トークンが `https://jwt.ms` に返され、表示されます。

## <a name="next-steps"></a>次の手順

この記事で学習した内容は次のとおりです。

> [!div class="checklist"]
> * サインアップとサインイン ユーザー フローを作成する
> * プロファイル編集ユーザー フローを作成する
> * パスワードのリセット ユーザー フローを作成する

次に、ユーザーが Azure AD、Amazon、Facebook、GitHub、LinkedIn、Microsoft、Twitter などのプロバイダーにサインインできるように、お使いのアプリケーションに ID プロバイダーを追加する手順について確認します。

> [!div class="nextstepaction"]
> [お使いのアプリケーションに ID プロバイダーを追加する >](tutorial-add-identity-providers.md)